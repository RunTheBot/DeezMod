"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[2416],{"/uRm":(e,t,n)=>{n.d(t,{F:()=>a});let a=function(e){return e.ONBOARDING="ON_BOARDING",e.ONBOARDING_LEGACY="ON_BOARDING_LEGACY",e.SELECT_PROFILE="SELECT_PROFILE",e.BRIDGED_WEBVIEW="BRIDGED_WEBVIEW",e.PLAYLIST_ASSISTANT="PLAYLIST_ASSISTANT",e}({})},"23mk":(e,t,n)=>{n.d(t,{A:()=>h});var a=n("Au7y"),i=n("Sb6s"),s=n("TRpf"),r=n("Fzox"),o=n("Nz/Y"),l=n("34sk"),c=n("yJX9"),d=n("vXsw"),u=n("xobL"),p=n("A2sV");const m=a.J1`
	fragment isArtistFavorite on Artist {
		isFavorite
	}
`,h=e=>{const t={artistId:e},n=(0,s.wA)(),a=(0,r.G)((({user:e})=>(0,u.UJ)(e))),h=(0,o.A)(),{data:y}=(0,i.I)({fragment:m,from:{__typename:"Artist",id:e},optimistic:!0}),[g]=(0,p.BXP)({variables:t,optimisticResponse:{__typename:"Mutation",addArtistToFavorite:{favoritedAt:Date.now(),artist:{id:e,isFavorite:!0,__typename:"Artist"},__typename:"ArtistMutationFavoriteAddOut"}},onCompleted:()=>{n((0,l.TD)(c.Z.favorites,{id:e,timestamp:Date.now()},"artist"))}}),[A]=(0,p.a40)({variables:t,onCompleted:()=>{n((0,l.E$)(c.Z.favorites,e,"artist"))},optimisticResponse:{__typename:"Mutation",removeArtistFromFavorite:{artist:{id:e,isFavorite:!1,__typename:"Artist"},__typename:"ArtistMutationFavoriteRemoveOut"}}}),E=(0,r.G)((t=>t.feedbacks.favorites.artist.feedbacks[e])),f=Boolean(E||(null==y?void 0:y.isFavorite));return{isFavorite:f,toggleFavorite:()=>{a?f?A():(h(),g()):d.g.goToConnection()}}}},"3JOg":(e,t,n)=>{n.d(t,{A:()=>s});var a=n("q1tI"),i=n("juqV");const s=({children:e})=>{var t;return a.cloneElement(e,{className:(0,i.A)(null===(t=e.props)||void 0===t?void 0:t.className,"animate-wobble")})}},"3gOz":(e,t,n)=>{n.d(t,{A:()=>c});var a=n("q1tI"),i=n("TRpf"),s=n("juqV"),r=n("kSUS");const o=23.26;class l extends a.Component{constructor(e){super(e),this._containerRef=null,this._containerWidth=0,this._wrapperRef=null,this._childrenRef=null,this._scrollOffset=0,this._scrollWidth=0,this._frameId=null,this._isLastLoop=!1,this._hasScrollingMarquee=!1,this._onResize=(0,r.A)(this._measureText.bind(this),100),this._onMouseEnter=(0,r.A)(this._start.bind(this),1e3),this.state={isTruncated:!1}}componentDidMount(){this._measureText(),window.addEventListener("resize",this._onResize,!1)}UNSAFE_componentWillReceiveProps(){this._measureText()}componentWillUnmount(){this._clear(),window.removeEventListener("resize",this._onResize)}render(){const{langDirection:e,isCentered:t}=this.props,{isTruncated:n}=this.state;let i={className:(0,s.A)("marquee-wrapper",{"is-centered":t&&!n}),ref:e=>this._wrapperRef=e};return n&&(i.onMouseEnter=()=>this._onMouseEnter(),i.onMouseLeave=()=>this._stop(),i.style=this._getWrapperStyle(0)),a.createElement("div",{className:"marquee",dir:e,ref:e=>this._containerRef=e},a.createElement("div",i,this._renderContent(),this._renderContent(!1)))}_renderContent(e=!0){const{children:t,langDirection:n}=this.props,{isTruncated:i}=this.state;if(!e&&!i)return null;if(e)return a.createElement("div",{className:"marquee-content",ref:e=>this._childrenRef=e},t);const s={paddingLeft:"ltr"===n?"24px":null,paddingRight:"rtl"===n?"24px":null};return a.createElement("div",{className:"marquee-content",style:s},t)}_measureText(){if(!this._childrenRef||!this._containerRef)return;const e=this._childrenRef.offsetWidth>this._containerRef.offsetWidth;this.state.isTruncated!==e&&this.setState({isTruncated:e},(()=>{this._clear()}))}_start(){const{onScrollStart:e}=this.props;this._isLastLoop&&(this._isLastLoop=!1),this._isScrolling()||(this._scrollWidth=this._childrenRef.offsetWidth,this._containerWidth=this._containerRef.offsetWidth,"function"==typeof e&&e(),this._frameId=window.requestAnimationFrame(this._move.bind(this)))}_stop(){this._onMouseEnter.cancel(),this._isScrolling()&&(this._isLastLoop=!0)}_move(){if(this._frameId=window.requestAnimationFrame(this._move.bind(this)),this._scrollOffset=Math.ceil(this._scrollOffset+.8),this._scrollOffset>this._scrollWidth+24&&(this._scrollOffset=0),this._moveTo(this._scrollOffset),0===this._scrollOffset&&this._isLastLoop){const{onScrollEnd:e}=this.props;"function"==typeof e&&e(),this._clear()}}_moveTo(e){if(!this._wrapperRef)return;if(!1===this.state.isTruncated)return void this._setStyle(this._containerRef,this._getGradientStyle());this._setStyle(this._wrapperRef,this._getWrapperStyle(this._getTranslateOffset(e)));const t=.23260000000000003*this._containerWidth;if(this._isScrolling()||0!==e){if(e<t&&!this._hasScrollingMarquee){const n=e*o/t;this._setStyle(this._containerRef,this._getGradientStyle(n))}else if(!this._isLastLoop&&e>t)this._hasScrollingMarquee=!0;else if(this._isLastLoop){const n=this._scrollWidth+24-e;if(this._isLastLoop&&n<t){const e=t?n*o/t:0;this._setStyle(this._containerRef,this._getGradientStyle(e))}}}else this._setStyle(this._containerRef,this._getGradientStyle(0))}_clear(){this._isScrolling()&&window.cancelAnimationFrame(this._frameId),this._moveTo(0),this._frameId=null,this._isLastLoop=!1,this._hasScrollingMarquee=!1,this._scrollOffset=0}_setStyle(e,t){e.style&&Object.assign(e.style,t)}_getWrapperStyle(e){return{transform:`translate3d(${e}px, 0px, 0px)`,willChange:"transform"}}_getGradientStyle(e){const{langDirection:t}=this.props;return void 0===e?{"-webkit-mask-image":"","mask-image":""}:0===e?{"-webkit-mask-image":`linear-gradient(\n\t\t\t\t\t${"ltr"===t?270:90}deg,\n\t\t\t\t\trgba(0 0 0 / 0%) 0%,\n\t\t\t\t\trgba(0 0 0 / 0%) 2.42%,\n\t\t\t\t\trgba(0 0 0 / 100%) 23.26%\n\t\t\t\t)`,"mask-image":`linear-gradient(\n\t\t\t\t\t${"ltr"===t?270:90}deg,\n\t\t\t\t\trgba(0 0 0 / 0%) 0%,\n\t\t\t\t\trgba(0 0 0 / 0%) 2.42%,\n\t\t\t\t\trgba(0 0 0 / 100%) 23.26%\n\t\t\t\t)`}:{"-webkit-mask-image":`linear-gradient(\n\t\t\t\t270deg,\n\t\t\t\ttransparent 2.42%,\n\t\t\t\trgba(0 0 0 / 100%) ${"rtl"===t?e:o}%,\n\t\t\t\trgba(0 0 0 / 100%) ${"ltr"===t?100-e:76.74}%,\n\t\t\t\ttransparent 97.58%\n\t\t\t)`,"mask-image":`linear-gradient(\n\t\t\t\t270deg,\n\t\t\t\ttransparent 2.42%,\n\t\t\t\trgba(0 0 0 / 100%) ${"rtl"===t?e:o}%,\n\t\t\t\trgba(0 0 0 / 100%) ${"ltr"===t?100-e:76.74}%,\n\t\t\t\ttransparent 97.58%\n\t\t\t)`}}_getTranslateOffset(e){const{langDirection:t}=this.props;return 0!==e&&"ltr"===t?e-2*e:e}_isScrolling(){return null!==this._frameId}}l.defaultProps={isCentered:!1,onScrollStart:()=>{},onScrollEnd:()=>{}};const c=(0,i.Ng)((({user:e})=>({langDirection:e.DIRECTION})))(l)},"4PKR":(e,t,n)=>{n.d(t,{Ay:()=>d,gA:()=>o,u4:()=>c,wZ:()=>l});var a=n("+9dH"),i=n("q1tI");const s=[[0,0],[1e3,90],[1e3,250],[970,90],[970,250],[728,90],[2160,1e3]],r=(0,i.createContext)({isScriptLoaded:!1,isSponsored:!1,setIsSponsored:()=>{},destroySlot1:()=>{},displayAdSlot:()=>{},isArchBanner:!1}),o=()=>(0,i.useContext)(r),l=({children:e})=>{const[t,n]=(0,i.useState)(!1),[a,o]=(0,i.useState)(!1),[l,c]=(0,i.useState)(""),[d,u]=(0,i.useState)(!1),p=e=>{e.size&&2160===e.size[0]?u(!0):u(!1)},m=e=>{const t=window.googletag;var n;return"function"==typeof t.pubads&&(t&&(null==t||null===(n=t.pubads())||void 0===n?void 0:n.getSlots())).some((t=>t.getSlotElementId()===e))};return(0,i.useEffect)((()=>{(e=>{const t=document.createElement("script");t.src="https://securepubads.g.doubleclick.net/tag/js/gpt.js",t.async=!0,document.body.appendChild(t),t.onload=()=>{window.googletag=window.googletag||{cmd:[]},n(!0)}})()}),[]),i.createElement(r.Provider,{value:{isScriptLoaded:t,setIsSponsored:o,isSponsored:a,displayAdSlot:e=>{const t=window.googletag;e&&c(e);const n=m("adslot1"),a=e||l;!n&&a&&t.cmd.push((()=>{var e;const n=null==t||null===(e=t.defineSlot(a,s,"adslot1"))||void 0===e?void 0:e.addService(t.pubads()).setTargeting("placement","web_adslot1");n&&t.pubads().addEventListener("impressionViewable",(e=>{const t=e.slot;setTimeout((()=>{googletag.pubads().refresh([t])}),3e4)})),n&&t.pubads().refresh([n])})),t.cmd.push((()=>{t.pubads().addEventListener("slotRenderEnded",p)}))},destroySlot1:()=>{const e=m("adslot1"),t=window.googletag;e&&t&&(null==t||t.destroySlots()),t.cmd.push((()=>{t.pubads().removeEventListener("slotRenderEnded",p)})),d&&u(!1)},isArchBanner:d}},e)},c=e=>t=>{const n=(0,i.useContext)(r);return i.createElement(e,(0,a.A)({},n,t))},d=r},"5pmF":(e,t,n)=>{n.d(t,{A:()=>b});var a=n("q1tI"),i=n("TRpf"),s=n("xobL"),r=(n("/eM8"),n("Vd8Q"));const o=r.default.get("host_website_ssl"),l=r.default.get("host_cookie"),c=`https://${r.default.get("host_common_assets_ssl")}/js/gdpr-appliance.js`,d=r.default.get("bot_crawler"),u=new RegExp(d,"i");var h=n("zKOv"),y=n("vGT4"),g=n("39Zz"),A=n("uHHB"),E=n("G04z"),f=n("ebSJ"),_=n("y7Wb");const v=({locale:e,darkMode:t,userId:n})=>{const{dispatch:s}=(0,y.b)(),r=(0,i.wA)();return(0,a.useEffect)((()=>{window.location.pathname.includes("register")&&(0,f.A)(g.J)&&((0,A.A)(g.J,"",0),(0,A.A)("euconsent-v2","",0)),window.onDzrGDPRReady=a=>{(async(e,t)=>{const{lang:n="en_US",darkMode:a=!1,onConsentUpdate:i,userID:s="0"}=t||{};window.consentScreenApi=await e({cookieDomain:l,darkMode:a,gatewayHost:o,isWebview:!1,lang:n,onConsentUpdate:i,userID:s})})(a,{lang:e,darkMode:t,userID:n,onConsentUpdate:e=>{var t;s((t=e,{type:h.X,value:t})),(0,E.u)().setConsent(e),r((0,_.j$)())}})},((e="dzr-gdpr-script")=>{if(u.test(navigator.userAgent))return;if(document.getElementById(e))return;const t=document.createElement("script");t.async=!0,t.crossOrigin="anonymous",t.defer=!0,t.id=e,t.src=c,document.head.appendChild(t)})("gdpr-web-script")}),[]),(0,a.useEffect)((()=>{var a;null===(a=window.consentScreenApi)||void 0===a||a.update({darkMode:t,userID:n,lang:e})}),[t,e,n]),null},b=()=>{const e=(0,i.d4)((e=>(0,s.JK)(e.user))),t=(0,i.d4)((e=>(0,s.NF)(e.user))),n=(0,i.d4)((e=>(0,s.F6)(e.user).toString()));return a.createElement(v,{darkMode:t,userId:n,locale:e})}},"5xmB":(e,t,n)=>{n.d(t,{B:()=>o,A:()=>l});var a=n("q1tI"),i=n("juqV"),s=n("Wp0Y");const r={img:"wPuzu",text:"sIMmz",nocontent:"k4rH3",private:"OXBI2",recommendation:"IMAtw"};let o=function(e){return e.NO_CONTENT="nocontent",e.PRIVATE="private",e.RECOMMENDATION="recommendation",e}({});const l=({img:e=o.NO_CONTENT,wording:t=(0,s.AP)("Aucun résultat."),className:n})=>a.createElement("div",{className:(0,i.A)(r.root,n)},a.createElement("div",{className:(0,i.A)(r.img,r[e])}),a.createElement("div",{className:r.text},t))},"7bA3":(e,t,n)=>{n.d(t,{A:()=>l});var a=n("q1tI"),i=n("F3Nm"),s=n("CrR0"),r=n("0JBE"),o=n("GjdC");const l=({id:e,type:t,displayForce:n,shouldPlayRadio:l=!1,onClick:c})=>{const{legacyContext:d}=(0,r.iQ)(),u=(0,o.A)();return a.createElement(s.U,{"aria-label":"",as:"div",displayForce:n,icon:a.createElement(i.A,{id:e,type:t,context:d,radio:l,onClick:e=>{null==c||c(),e||u("direct_play")}})})}},"9odk":(e,t,n)=>{n.d(t,{AP:()=>c,Ay:()=>o,kA:()=>l});var a=n("q1tI"),i=n("A2sV"),s=n("TRpf");const r=a.createContext({loading:!0}),o=(0,s.Ng)((({user:{id:e}})=>({legacyUserId:e})))((({legacyUserId:e,children:t})=>{const{data:n,loading:s,error:o,refetch:l}=(0,i.ONi)({});if(a.useEffect((()=>{var t;n&&e.toString()!==(null===(t=n.me)||void 0===t?void 0:t.user.id)&&l()}),[e,n,l]),o)throw o;if(!s&&void 0===n)throw new Error("Missing user data from pipe");const c=n&&null!==n&&null!==n.me?{isLogged:!0,data:n.me}:{isLogged:!1,data:null};return a.createElement(r.Provider,{value:s?{loading:!0}:{loading:s,...c,refetch:()=>{l({})}}},t)})),l=()=>{const e=a.useContext(r);if(!e)throw new Error("usePipeUserContext must be used whithin a PipeUserContext");return e},c=()=>{const e=l();if(!e.loading&&e.isLogged){const{__typename:t,...n}=e.data.onboarding;return n}return null}},Aw62:(e,t,n)=>{n.d(t,{J0:()=>w,Ay:()=>P,ZQ:()=>S}),n("/eM8"),n("gS5K");var a=n("q1tI"),i=n("nrKQ"),s=n("WKgy"),r=n("H/eQ"),o=n("tZCQ"),l=n("JsMx");const d=`https://${(n("Dk60"),n("Vd8Q")).default.get("host_img_url_ssl")}/misc/813a92a67ed0a543380451ce8b47bb15/540x540-000000-90-0-0.jpg`;let u=null;const p=window,m=()=>{u=null},h=()=>{return p.google&&p.google.ima?Promise.resolve(p.google.ima):u||(u=(e="https://imasdk.googleapis.com/js/sdkloader/ima3.js",new Promise(((t,n)=>{const a=document.createElement("script");a.async=!0,a.src=e,a.onload=()=>t(a),a.onerror=()=>n(new Error(`Failed to load script: ${e}`)),document.body.appendChild(a)}))).then((()=>{if(p.google&&p.google.ima)return p.google.ima;throw new Error("IMA SDK failed to load correctly.")})).finally(m),u);var e},y=async(e,t,n,a,i)=>{const s=document.createElement("div");s.id="mediaElement",Object.assign(s.style,{position:"fixed",top:"0",left:"0",width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(10px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"999"}),document.body.appendChild(s);const r=document.createElement("div");r.id="adContainer",Object.assign(r.style,{zIndex:"1000",cursor:"pointer",top:"0",left:"0",margin:"auto",position:"fixed",width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)"}),document.body.appendChild(r),r.focus();try{const o=await h(),l=new o.AdsRenderingSettings;l.uiElements=[o.UiElements.AD_ATTRIBUTION,o.UiElements.COUNTDOWN],o.settings.setFeatureFlags({audioPosterImageEnabled:!0,audioPosterImageDefaultUrl:d});const c=document.getElementById("mediaElement");if(!c)throw new Error("mediaElement not found or not a video element.");c.volume=1,c.muted=!1;const u=new o.AdDisplayContainer(r,c);u.initialize();const p=new o.AdsLoader(u),m=new o.AdsRequest;m.adsResponse=(e=>{const t=(new DOMParser).parseFromString(e,"application/xml"),n=t.getElementsByTagName("MediaFile");for(let e=0;e<n.length;e++){const t=n[e];"audio/mp3"===t.getAttribute("type")&&t.setAttribute("type","audio/mpeg")}const a=t.getElementsByTagName("Companion");let i=null;for(let e=0;e<a.length;e++){const t=a[e],n=t.getAttribute("width"),r=t.getAttribute("height"),o=t.getElementsByTagName("CompanionClickThrough");var s;if(o.length>0&&(i=(null===(s=o[0].textContent)||void 0===s?void 0:s.trim())||null),n&&r){const e=parseInt(n,10),a=parseInt(r,10);if(a>540){const n=e/a;t.setAttribute("height",540..toString()),t.setAttribute("width",(540*n).toFixed(0))}}}const r=t.getElementsByTagName("CompanionAds");for(let e=0;e<r.length;e++)r[e].removeAttribute("required");const o=t.getElementsByTagName("Linear");for(let e=0;e<o.length;e++){const n=o[e];let a=n.getElementsByTagName("VideoClicks")[0];if(a||(a=t.createElement("VideoClicks"),n.appendChild(a)),0===a.getElementsByTagName("ClickThrough").length&&i){a=t.createElement("VideoClicks");const e=t.createElement("ClickThrough");e.textContent=i,a.appendChild(e),n.appendChild(a)}}return(new XMLSerializer).serializeToString(t)})(e),m.linearAdSlotWidth=r.clientWidth,m.linearAdSlotHeight=r.clientHeight,m.nonLinearAdSlotWidth=r.clientWidth,m.nonLinearAdSlotHeight=r.clientHeight/3;let y=null;const g=new ResizeObserver((()=>{if(y){const e=r.clientWidth,t=r.clientHeight;y.resize(e,t,o.ViewMode.NORMAL)}}));g.observe(r);const A="audio"===a;p.addEventListener(o.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>{try{y=e.getAdsManager(c,l),y.addEventListener(o.AdEvent.Type.PAUSED,(()=>{A&&y.resume()})),y.addEventListener(o.AdEvent.Type.COMPLETE,(()=>{t(),b()})),y.addEventListener(o.AdEvent.Type.SKIPPED,(()=>{t(),b()})),y.addEventListener(o.AdErrorEvent.Type.AD_ERROR,(e=>{null==i||i(e.getError().toString()),t(),b()})),y.addEventListener(o.AdEvent.Type.CONTENT_RESUME_REQUESTED,(()=>{t(),b()})),document.addEventListener("visibilitychange",f),window.addEventListener("focus",_),window.addEventListener("blur",v),y.addEventListener(o.AdEvent.Type.ALL_ADS_COMPLETED,(()=>{document.removeEventListener("visibilitychange",f),window.removeEventListener("focus",_),window.removeEventListener("blur",v),g.disconnect(),b()}));try{const e=1600,t=900,n=Math.min(r.clientWidth,e),a=Math.min(r.clientHeight,t);y.init(n,a,o.ViewMode.NORMAL),y.start(),setTimeout((()=>{var e;null===(e=y)||void 0===e||e.resize(r.clientWidth,r.clientHeight,o.ViewMode.NORMAL)}),10)}catch(e){null==i||i("AdsManager initialization error: "+e),t(),b()}}catch(e){null==i||i("AdsManager Loaded Error: "+e),t(),b()}})),p.addEventListener(o.AdErrorEvent.Type.AD_ERROR,(e=>{null==i||i(e.getError().toString()),t(),b()})),p.requestAds(m),c.style.background="transparent";const E=()=>{A||y.pause()},f=()=>{document.hidden?(E(),n(!1)):(y.resume(),n(!0))},_=()=>{y.resume(),n(!0)},v=()=>{E(),n(!1)};document.addEventListener("visibilitychange",f),window.addEventListener("focus",_),window.addEventListener("blur",v);const b=()=>{document.removeEventListener("visibilitychange",f),window.removeEventListener("focus",_),window.removeEventListener("blur",v),s.parentNode&&s.parentNode.removeChild(s),r.parentNode&&r.parentNode.removeChild(r)}}catch(e){null==i||i("Error during ad display: "+e),t()}};var g=n("u7vQ"),A=n("AfN5");class E{constructor(e){this.trackCount=void 0,this.totalPlayTime=void 0,this.lastPlayTimestamp=void 0,this.hasCountedCurrentTrack=void 0,this.isResumingOrPlaying=void 0,this.trackCountCallback=void 0,this.adPlayCallback=void 0,this.adConfig=void 0,this.playCheckInterval=void 0,this.DEFAULT_TIME_BEFORE_COUNTING=void 0,this.FAST_TIME_BEFORE_COUNTING=void 0,this.getLimitTimeToCount=()=>this.adConfig.fastAds?this.FAST_TIME_BEFORE_COUNTING:this.DEFAULT_TIME_BEFORE_COUNTING,this.updateConfig=e=>{this.adConfig=e},this.onTrackCountChange=e=>{this.trackCountCallback=e},this.onAdPlayRequired=e=>{this.adPlayCallback=e},this.startListening=()=>{r.A.subscribe(r.A.player.play,this.onPlay),r.A.subscribe(r.A.player.resume,this.onResume),r.A.subscribe(r.A.player.paused,this.onPause),r.A.subscribe(r.A.player.seek,this.onSeek),r.A.subscribe(r.A.player.trackChange,this.onTrackEndOrSkipped),r.A.subscribe(r.A.player.trackSkipped,this.onTrackEndOrSkipped)},this.stopListening=()=>{r.A.unsubscribe(r.A.player.play,this.onPlay),r.A.unsubscribe(r.A.player.resume,this.onResume),r.A.unsubscribe(r.A.player.paused,this.onPause),r.A.unsubscribe(r.A.player.seek,this.onSeek),r.A.unsubscribe(r.A.player.trackChange,this.onTrackEndOrSkipped),this.clearPlayCheckInterval()},this.onPlay=()=>{this.resetPlayTime(),this.isResumingOrPlaying=!0,this.lastPlayTimestamp=Date.now(),this.startPlayCheckInterval()},this.onResume=()=>{this.isResumingOrPlaying=!0,this.lastPlayTimestamp=Date.now(),this.startPlayCheckInterval()},this.onPause=()=>{this.isResumingOrPlaying?this.isResumingOrPlaying=!1:g.Ay.isPlaying()&&(this.updateTotalPlayTime(),this.clearPlayCheckInterval())},this.onSeek=()=>{this.updateTotalPlayTime(),this.lastPlayTimestamp=Date.now(),this.isResumingOrPlaying=g.Ay.isPlaying()},this.onTrackEndOrSkipped=()=>{this.resetPlayTime(),this.clearPlayCheckInterval(),this.hasCountedCurrentTrack=!1,this.isResumingOrPlaying=!1},this.updateTotalPlayTime=()=>{if(g.Ay.isPlaying()){const e=(Date.now()-this.lastPlayTimestamp)/1e3;this.totalPlayTime+=e,this.lastPlayTimestamp=Date.now()}},this.getCurrentPlayTime=()=>(this.updateTotalPlayTime(),this.totalPlayTime),this.checkTrackCountTrigger=()=>{!this.hasCountedCurrentTrack&&this.getCurrentPlayTime()>=this.getLimitTimeToCount()&&(this.trackCount+=1,this.hasCountedCurrentTrack=!0,this.trackCountCallback&&this.trackCountCallback(this.trackCount),(this.trackCount===this.adConfig.start||this.trackCount>this.adConfig.start&&(this.trackCount-this.adConfig.start)%this.adConfig.interval==0)&&this.adPlayCallback&&this.adPlayCallback())},this.startPlayCheckInterval=()=>{this.clearPlayCheckInterval(),this.playCheckInterval=setInterval((()=>{this.getCurrentPlayTime()>=this.getLimitTimeToCount()&&(this.checkTrackCountTrigger(),this.clearPlayCheckInterval())}),500)},this.clearPlayCheckInterval=()=>{this.playCheckInterval&&(clearInterval(this.playCheckInterval),this.playCheckInterval=void 0)},this.resetPlayTime=()=>{this.totalPlayTime=0,this.lastPlayTimestamp=0,this.hasCountedCurrentTrack=!1},this.getTrackCount=()=>this.trackCount,this.trackCount=0,this.totalPlayTime=0,this.lastPlayTimestamp=0,this.hasCountedCurrentTrack=!1,this.isResumingOrPlaying=!1,this.adConfig=e,this.DEFAULT_TIME_BEFORE_COUNTING=30,this.FAST_TIME_BEFORE_COUNTING=5}}var f=n("LOQS"),_=n("Sw64"),v=n("Fzox");const b=new URLSearchParams(window.location.search).get("fastAds"),k={start:1,interval:3},T=()=>o.A.isAllowed("ad_audio_break_vast_audio")?"VAST_AD":"VIDEO_AD",C=(0,a.createContext)({audioBreakState:{},fetchAudioBreak:async e=>0,isAdsReady:!1}),S=()=>(0,a.useContext)(C),I={type:"",content:null,cta:{},tracking:{},smartad_mediation_parameters:{}},w=({children:e})=>{const[t,n]=(0,a.useState)(I),[c,d]=(0,a.useState)(!0),[u,p]=(0,a.useState)(!1),[m,h]=(0,a.useState)(0),{getAdsAudioFrequency:S,adsConfigReady:w}=(0,l.Y9)(),P=(0,v.G)((e=>e.user)),x={...S()||k,fastAds:"true"===b},N=(0,a.useRef)(null);(0,a.useEffect)((()=>(N.current||(N.current=new E(x),N.current.startListening(),N.current.onAdPlayRequired((()=>{R()}))),()=>{var e;null===(e=N.current)||void 0===e||e.stopListening()})),[]),(0,a.useEffect)((()=>{w&&0===x.start&&g.Ay.playerLoaded&&setTimeout((()=>{R(),h(1)}),100)}),[w,x.start,g.Ay.playerLoaded]),(0,a.useEffect)((()=>{var e;null===(e=N.current)||void 0===e||e.updateConfig(x)}),[x]);const R=(0,a.useCallback)((()=>{u||(r.A.subscribe(r.A.triton.audioEnd,O),r.A.subscribe(r.A.ads.callAudio,(()=>p(!0))),g.Ay.onAudioAdsReady())}),[u]),L=()=>{r.A.trigger(r.A.triton.audioEnd);const e=document.getElementById("mediaElement");null==e||e.remove();const t=document.getElementById("adContainer");null==t||t.remove()},O=()=>{r.A.unsubscribe(r.A.player.trackSkipped),r.A.unsubscribe(r.A.player.trackChange),r.A.unsubscribe(r.A.player.displayNextSong),r.A.unsubscribe(r.A.triton.audioEnd),r.A.unsubscribe(r.A.ads.callAudio,(()=>p(!0))),g.Ay.hasAudioAds=!1,g.Ay.eventAudio=!1,g.Ay.stopAudioAds(!1),p(!1)};return g.Ay.getPlayerType()!==A.Cc.ADS&&g.Ay.getPlayerType()!==A.Cc.TRITON_AD||location.pathname.includes("/game/")&&(r.A.trigger(r.A.triton.audioEnd),r.A.trigger(r.A.ads.adEnd)),a.createElement(C.Provider,{value:{audioBreakState:t,fetchAudioBreak:async e=>{const t=s.A.getState().player,a=i.A.call({method:"deezer.getAudiobreak",data:{consent_string:e||"",listening_context:"",track_list:t.music.list,player_track_id:t.music.track.SNG_ID,player_content_type:t.music.context.TYPE,player_content_id:t.music.context.ID,focus:c?1:0,preroll:m,vastFormat:"VAST_AD"===T()?1:0},success:e=>{const t={...I,...e};"string"==typeof t.cta.tracking_url&&(t.cta.tracking_url=""!==t.cta.tracking_url.trim()?[t.cta.tracking_url]:[]),o.A.isAllowed("ad_force_video")&&(t.type=T()),n(t),(e=>{const{type:t,content:n}=e;if(t!==T())return setTimeout((()=>r.A.trigger(r.A.triton.audioEnd)),100),void setTimeout((()=>r.A.trigger(r.A.ads.adEnd)),100);y(n.vast,L,d,n.vastFormatType,(e=>t=>{o.A.isAllowed("ad_collect_rec_logs")&&f.A.log((0,_.L)("ads.monitoring","2.0.0",{content:{user_profile:"regular",country:e.COUNTRY,session_id:e.SESSION_ID,request_source:"server",ad_count:1,event:{type:"call",status:"ok"},ad:{source:"triton",type:"audio",error:t}}}))})(P))})(t),h(0)},error:e=>{throw e}});return await a},isAdsReady:u}},e)},P=C},EBWn:(e,t,n)=>{n.d(t,{A:()=>l});var a=n("Oqsq"),i=n("lXQd"),s=n("nLzw"),r=n("1Pdy"),o=n("t08u");const l=(e,t,n,l)=>{const{triggerTracking:c}=(0,o.A)(n.TYPE),d={},u=t.toDisplay.map((e=>((0,a.A)(d,e.uuid,e.item.id),e.uuid)));return(t,n,a)=>{if("function"!=typeof l)return;const o=u.filter((e=>!t.includes(e)));let p=0;if(t.includes(n)){for(p=u.indexOf(n);t.includes(u[p])&&p>0;)p--;p>0&&(p+=1)}else p=o.indexOf(n),p+=a===r.Nz.TOP?0:1;var m;o.splice(p,0,...t),(0,s.A)(o,u)||(l({id:e,order:(m=o,m.map((e=>(0,i.A)(d,e))))}),c({action:"dragdrop",eventaction:t.length>1?"dragdrop-multi":"dragdrop-single"}))}}},FLei:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E}),n("/eM8");var a=n("q1tI"),i=n("u7vQ"),s=n("WKgy"),r=n("tZCQ"),o=n("eC9Z"),l=n("9odk"),c=n("RTUF"),d=n("JsMx"),u=n("Aw62"),p=n("4PKR");const m=({children:e})=>a.createElement(p.wZ,null,a.createElement(d.Ov,null,a.createElement(u.J0,null,e))),h=a.lazy((()=>Promise.all([n.e(4201),n.e(2033),n.e(8182),n.e(7285),n.e(5310),n.e(5016),n.e(8199),n.e(1668),n.e(4344),n.e(6005),n.e(8382),n.e(9173),n.e(3646),n.e(1421),n.e(737),n.e(555),n.e(5665),n.e(9842),n.e(3398),n.e(7681),n.e(3284),n.e(9394),n.e(2416)]).then(n.bind(n,"qMCD")))),y=a.lazy((()=>n.e(4569).then(n.bind(n,"tpKx")))),g=a.lazy((()=>n.e(3592).then(n.bind(n,"fUz9")))),A=a.lazy((()=>Promise.resolve().then(n.bind(n,"bbm1")))),E=e=>{const t=()=>0!==s.A.getState().user.USER.USER_ID&&s.A.getState().user.USER.OPTIONS.ads_display&&i.Ay.isAdvertisingAllowed()&&0!==s.A.getState().user.USER.USER_ID,n=t()?y:h,d=r.A.isAllowed("public_api_onboarding")?a.createElement(l.Ay,null,a.createElement(n,e)):a.createElement(n,e),u=a.createElement(g,{offline:r.A.isAllowed("public_api_album")},d),p=r.A.isAllowed("deeztools")&&(0,o.oz)()?a.createElement(A,null,u):u,E=t()?a.createElement(m,null,p):p;return a.createElement(a.Suspense,{fallback:null},a.createElement(c.m,null,E))}},FSqQ:(e,t,n)=>{n.d(t,{A:()=>r});var a,i=n("q1tI"),s=n("juqV");class r extends i.Component{render(){const{className:e}=this.props;let t=(0,s.A)("loader-container",e);return i.createElement("div",{className:t,"data-testid":"loader"},a||(a=i.createElement("div",{className:"loader animate-spin"})))}}},GkgI:(e,t,n)=>{n.d(t,{b:()=>o});var a=n("Wp0Y");let i={},s=!1;const r=()=>{i={full:{active:(0,a.AP)("successmessage_text_addedtoyourfavorites_web"),active_favorite_friend:(0,a.AP)("Suivi"),active_favorite_song:(0,a.AP)("successmessage_text_addedtoyourfavorites_web"),active_play:(0,a.AP)("À l'écoute"),active_play_artist:(0,a.AP)("Mix"),active_play_user:(0,a.AP)("FLOW"),active_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),add:(0,a.AP)("contextualmenu_text_addtomyfavorites_web"),add_favorite_friend:(0,a.AP)("Suivre"),add_favorite_song:(0,a.AP)("Ajouter aux Coups de cœur"),add_dislike_song:(0,a.AP)("bantrack_action_dontrecommendthistrack_web"),add_dislike_artist:(0,a.AP)("banartist_action_dontrecommendthisartist_web"),add_play:(0,a.AP)("Écouter"),add_play_artist:(0,a.AP)("Mix"),add_play_user:(0,a.AP)("FLOW"),add_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),default:(0,a.AP)("contextualmenu_text_addtomyfavorites_web"),default_favorite_friend:(0,a.AP)("Suivre"),default_favorite_song:(0,a.AP)("Ajouter aux Coups de cœur"),default_dislike_song:(0,a.AP)("bantrack_action_dontrecommendthistrack_web"),default_dislike_artist:(0,a.AP)("banartist_action_dontrecommendthisartist_web"),default_play:(0,a.AP)("Écouter"),default_play_artist:(0,a.AP)("Mix"),default_play_user:(0,a.AP)("FLOW"),default_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),hover:(0,a.AP)("contextualmenu_text_deletefrommyfavorites_web"),hover_favorite_app:(0,a.AP)("Retirer de ma bibliothèque"),hover_favorite_friend:(0,a.AP)("Ne plus suivre"),hover_favorite_song:(0,a.AP)("Retirer des Coups de cœur"),hover_dislike_song:(0,a.AP)("banartist_action_allowinmyrecommendations_web"),hover_dislike_artist:(0,a.AP)("banartist_action_allowinmyrecommendations_web"),hover_play:(0,a.AP)("Pause"),hover_play_artist:(0,a.AP)("Mix"),hover_play_user:(0,a.AP)("FLOW"),hover_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),paused_play:(0,a.AP)("Pause"),paused_play_artist:(0,a.AP)("Mix"),paused_play_user:(0,a.AP)("FLOW"),paused_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),resume_play:(0,a.AP)("Reprendre"),resume_play_artist:(0,a.AP)("Mix"),resume_play_user:(0,a.AP)("FLOW"),resume_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web")},standard:{active:(0,a.AP)("Ajouté"),add:(0,a.AP)("generic_action_add_web"),default:(0,a.AP)("generic_action_add_web"),default_play_small:(0,a.AP)("Écouter"),hover_play_small:(0,a.AP)("Pause"),paused_play_small:(0,a.AP)("Pause"),resume_play_small:(0,a.AP)("Reprendre"),active_play_small:(0,a.AP)("À l'écoute"),hover:(0,a.AP)("Retirer"),active_follow_user:(0,a.AP)("Suivi"),add_follow_user:(0,a.AP)("Suivre"),default_follow_user:(0,a.AP)("Suivre"),hover_follow_user:(0,a.AP)("Ne plus suivre"),default_download:(0,a.AP)("Télécharger"),active_download:(0,a.AP)("Téléchargé"),hover_download:(0,a.AP)("Retirer")}}};function o(e,t,n){!1===s&&(r(),s=!0);var a=n||e.wording;return"none"===a?"":i[a][t+"_"+e.action+"_"+e.type]?i[a][t+"_"+e.action+"_"+e.type]:i[a][t+"_"+e.action]?i[a][t+"_"+e.action]:i[a][t]}},I36q:(e,t,n)=>{n.d(t,{d:()=>a});let a=function(e){return e.Welcome="welcome",e.Improve="improve",e}({})},JsMx:(e,t,n)=>{n.d(t,{Ay:()=>h,Ov:()=>m,Y9:()=>p}),n("/eM8");var a=n("q1tI"),i=n("nrKQ"),s=n("7+7Q"),r=n("lXQd"),o=n("TRpf"),l=n("6yJ+"),c=n("vGT4"),d=n("Fzox");const u=(0,a.createContext)({adsConfigState:{},loadAdConfig:async()=>{},getAdsAudioFrequency:()=>({interval:2,start:0}),getProfileType:()=>"regular",getProfileReg:()=>"0",getProfileUs:()=>"0",getIsWhitelisted:()=>"0",getProfileOfferType:()=>"",getDzgroup:()=>[],hasDisplayAds:()=>!0,adsConfigReady:!1,isMidTierOffer:()=>!1}),p=()=>(0,a.useContext)(u),m=({children:e})=>{const[t,n]=(0,a.useState)({profile:{hasConsent:!0}}),[p,m]=(0,a.useState)(!1),{state:h}=(0,c.b)(),y=(0,d.G)((e=>e.user)),g=(0,o.wA)();let A=!1;(0,a.useEffect)((()=>{const e="GB"===y.COUNTRY?[1,2,3,4,5,6,7,8,9,10,11]:[1,2,3,4,7],t=null==h||!h.settings||h.settings.noIabVendors.includes(1),n=!(null==h||!h.settings)&&e.every((e=>{var t;const n=null===(t=h.settings)||void 0===t?void 0:t.purposes.find((t=>t.id===e));return!0===(null==n?void 0:n.value)}));E({profile:{hasConsent:t&&n}})}),[h]);const E=e=>{const a=(0,s.A)(t,e);n(a),g({type:l.J,data:a})},f=()=>(0,r.A)(t,"profile.name");return a.createElement(u.Provider,{value:{adsConfigState:t,loadAdConfig:async()=>{A||await(async()=>{A=!0;try{await i.A.call({method:"deezer.adConfig",success:e=>{E(e)}}),A=!1,m(!0)}catch(e){throw A=!1,e}})()},getProfileType:f,hasDisplayAds:()=>"starter"!==f(),getProfileReg:()=>{var e;return null===(e=(0,r.A)(t,"profile.reg"))||void 0===e?void 0:e.toString()},getDzgroup:()=>(0,r.A)(t,"targeting.smart.dzgroup"),getIsWhitelisted:()=>{var e;return null===(e=(0,r.A)(t,"targeting.smart.whitelisted_users"))||void 0===e?void 0:e.toString()},adsConfigReady:p,getProfileOfferType:()=>{var e;return null===(e=(0,r.A)(t,"profile.offer_type"))||void 0===e?void 0:e.toString()},isMidTierOffer:()=>(0,r.A)(t,"profile.offer_type")===l.u.DEEZER_NOW,getAdsAudioFrequency:()=>(0,r.A)(t,"config.audio")}},e)},h=u},LOxp:(e,t,n)=>{n.d(t,{$:()=>g,r:()=>y}),n("EV0h"),n("gS5K");var a=n("hYAH"),i=n("AY3M"),s=n("AfN5"),r=n("5G9X"),o=n("u7vQ"),l=n("H/eQ"),c=n("WmA5"),d=n("p/gB"),u=n("nxAS"),p=n("/uRm"),m=n("tZCQ");const h={"/":"/","/home":"/","/settings":"/account","/settings/app":"/account/settings","/settings/display_settings":"/account/display","/premiumtab":"/offers"},y=["/game","/story"];function g(e,{dispatch:t,lovedTracksId:n,userId:y}){if(!e.startsWith("deezer://"))return!1;const{pathname:g,searchParams:A}=new URL(e.replace("deezer://","https://"));if(h[g])return"/premiumtab"===g?(window.open(`${h[g]}?${A.toString()}`,"_blank"),!0):(c.A.push(h[g]),!0);if("/settings/audio"===g)return l.A.trigger(l.A.player.openAudioSettings),!0;if(g.startsWith("/album")||g.startsWith("/artist")||g.startsWith("/channels")||g.startsWith("/playlist")||g.startsWith("/profile")||g.startsWith("/track"))return c.A.push(g),"true"===A.get("autoplay")||A.get("autoplay"),!0;if(g.startsWith("/simplestory")){const[,,e]=g.split("/");return!!e&&(t((0,a.o)({id:e})),!0)}if("/user/me/flow"===g)return o.Ay.play({context:{ID:y,TYPE:(0,d.Pe)(r.Ay.Flow,i.pN)},id:y,radio:!0,type:s.Kk.USER}),!0;if("/user/me/tracks"===g)return o.Ay.play({context:{ID:n,TYPE:(0,d.Pe)(r.Ay.Playlist,i.x6)},id:n,type:r.Ay.Playlist}),!0;if(g.startsWith("/game"))return t((0,u.J2)({name:p.F.BRIDGED_WEBVIEW,data:{pathname:g,searchParams:A,hideLogo:!0,disableDisplayPadding:!0}})),!0;if(g.startsWith("/story")||g.startsWith("/genplaylist")&&m.A.isAllowed("employee_feature"))return t((0,u.J2)({name:p.F.BRIDGED_WEBVIEW,data:{pathname:g,fixedLogo:!0}})),!0;if(g.startsWith("/redirect")){const e=A.get("url");return!!e&&(window.open(e,"_blank"),!0)}if(g.startsWith("/smarttracklist")){const[,,e]=g.split("/");return c.A.push(g),"true"===A.get("autoplay")&&o.Ay.play({context:{ID:e,TYPE:"smarttracklist_page"},id:e,type:r.Ay.Smarttracklist}),!0}return!1}},Zah6:(e,t,n)=>{n.d(t,{A:()=>y});var a,i=n("+9dH"),s=n("q1tI"),r=n("TRpf"),o=n("TqF5"),l=n("L2Iu"),c=n("0sTk"),d=n("CLm1"),u=n("WKgy"),p=n("Qi9J");const m=e=>{switch(e){case"small":return"lg";case"medium":return"xl";default:return"3xl"}};class h extends s.Component{constructor(e){super(e),this._open=this._open.bind(this),this._close=this._close.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onOutsideMouseDown=this._onOutsideMouseDown.bind(this),this._contentRef=s.createRef()}componentDidMount(){document.addEventListener("keydown",this._onKeyDown),document.addEventListener("mousedown",this._onOutsideMouseDown),document.addEventListener("touchstart",this._onOutsideMouseDown)}componentWillUnmount(){document.removeEventListener("keydown",this._onKeyDown),document.removeEventListener("mousedown",this._onOutsideMouseDown),document.removeEventListener("touchstart",this._onOutsideMouseDown)}render(){const{isOpen:e,data:t,name:n,size:r,variant:o,testid:u}=this.props;if(!e)return null;const h=(0,p.C)(n);return h?s.createElement(l.aF,{isOpen:e,variant:null!=o?o:"foundation",size:m(r),isCentered:!0,onClose:this._close,closeOnOverlayClick:!this.props.disableClosingAction},a||(a=s.createElement(c.m,null)),s.createElement(d.$,{ref:this._contentRef,"data-testid":u},s.createElement(s.Suspense,{fallback:null},s.createElement(h,(0,i.A)({},t,{name:n}))))):null}_onKeyDown(e){const{isOpen:t,disableClosingAction:n}=this.props;t&&!n&&27===e.keyCode&&this._close()}_onOutsideMouseDown(e){const{isOpen:t,disableClosingAction:n}=this.props;t&&!n&&"HTML"!==e.target.tagName&&e.target.contains(this._contentRef.current)&&(e.stopPropagation(),this._close())}_close(){this.props.closeModal(!0)}_open(){this.props.openModal()}}h.defaultProps={size:"large",addRadius:!1},u.A.addReducers({modal:o.Ay});const y=(0,r.Ng)((({modal:e})=>({name:e.name,data:e.props,disableClosingAction:e.disableClosingAction,isOpen:""!==e.name,size:e.size,classNameClose:e.classNameClose,addRadius:e.addRadius,variant:e.variant,testid:e.testid})),{closeModal:o.Oo,openModal:o.qf})(h)},axbb:(e,t,n)=>{n.d(t,{s:()=>l});var a=n("Fzox"),i=n("xobL"),s=n("q1tI"),r=n("G04z"),o=n("nLzw");const l=()=>{const[e,t]=(0,s.useState)(!1),n=(0,a.G)((({user:e})=>{const t=(0,i.qo)(e);return{userId:(0,i.F6)(e).toString(),...t&&{email:t}}})),l=(0,r.u)(),c=(0,s.useRef)({userDetail:n}).current;return(0,s.useEffect)((()=>{l.init(),c.userDetail={},t(!0)}),[]),(0,s.useEffect)((()=>{const{userId:t,...a}=n;e&&t&&((0,o.A)(c.userDetail,n)||(l.identify({userId:t,...a}),c.userDetail=n))}),[e,n]),null}},bbm1:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p,useDeezToolsContext:()=>d,useDeezToolsDispatch:()=>u});var a=n("q1tI"),i=n("eC9Z"),s=n("pUfN");const r={[s.Wi.CONFIG]:{},[s.Wi.FEATURE]:{},[s.Wi.GATEKEEP]:{}},o=(e=r,t)=>{switch(t.type){case s.nh:var n;if(!t.item)throw new Error("An item to update has to be provided");return void 0!==(null===(n=e[t.item.category])||void 0===n?void 0:n[t.item.name])?(delete e[t.item.category][t.item.name],localStorage.removeItem((0,i.Fl)({itemType:t.item.category,itemName:t.item.name})),{...e}):{...e,[t.item.category]:{...e[t.item.category],[t.item.name]:t.item.value}};case s.u3:if(!t.item)throw new Error("An item to update has to be provided");return{...e,[t.item.category]:{...e[t.item.category],[t.item.name]:t.item.value}};case s.u5:return{...r};default:throw new Error(`Action type ${t.type} is not handled`)}},l=(0,a.createContext)(void 0),c=(0,a.createContext)(void 0),d=()=>{const e=(0,a.useContext)(l);if(void 0===e)throw new Error("useDeezToolsContext must be used within a DeezToolsProvider");return e},u=()=>{const e=(0,a.useContext)(c);if(void 0===e)throw new Error("useDeezToolsDispatch must be used within a DeezToolsProvider");return e},p=({children:e})=>{const[t,n]=(0,a.useReducer)(o,r);return a.createElement(l.Provider,{value:t},a.createElement(c.Provider,{value:n},e))}},gVf4:(e,t,n)=>{n.d(t,{A:()=>o});var a=n("q1tI"),i=n("Vd8Q"),s=n("u7vQ"),r=n("H/eQ");function o(e,t){const[n,o]=(0,a.useState)({isPaused:!1,isPlaying:!1}),l=(0,a.useCallback)((()=>{const n=s.Ay.getContext();if(!n)return;const a=i.default.get("log_contexts")[n.TYPE],r=String(n.ID);o(a===e&&r===t?{isPlaying:s.Ay.isPlaying(),isPaused:s.Ay.isPaused()}:{isPaused:!1,isPlaying:!1})}),[t,e]);return(0,a.useEffect)((()=>(r.A.subscribe(r.A.player.finish,l),r.A.subscribe(r.A.player.paused,l),r.A.subscribe(r.A.player.playing,l),l(),()=>{r.A.unsubscribe(r.A.player.finish,l),r.A.unsubscribe(r.A.player.paused,l),r.A.unsubscribe(r.A.player.playing,l)})),[l]),n}},hIIJ:(e,t,n)=>{n.d(t,{A:()=>u});var a=n("+9dH"),i=n("q1tI"),s=n("55Ip"),r=n("Wp0Y"),o=n("rxfZ"),l=n("waeH"),c=n("HmE0"),d=n("Z+z7");const u=({children:e,href:t,className:n,title:u,subtitle:p,onClick:m,ctaLabel:h=(0,r.AP)("Voir tout"),isExternalLink:y=!1,...g})=>i.createElement(o.a,(0,a.A)({flex:1,className:n},g),i.createElement(l.D,{variant:"heading.m","data-testid":"section_title"},u,t?y?i.createElement(c.$n,{as:"a",href:t,target:"_blank",variant:"outline",size:"small",ms:"spacing.s","data-testid":"section_title_cta"},h):i.createElement(s.N_,{to:t,onClick:()=>null==m?void 0:m()},i.createElement(c.$n,{variant:"outline",size:"small",ms:"spacing.s","data-testid":"section_title_cta"},h)):null,e),p?i.createElement(d.E,{variant:"body.s.default",mt:"spacing.xs",color:"text.neutral.secondary.default","data-testid":"section-title-subtitle"},p):null)},hYAH:(e,t,n)=>{n.d(t,{E:()=>i,o:()=>s});var a=n("6wwM");const i=()=>({type:a.R.CLOSE_STORY}),s=({id:e})=>({id:e,type:a.R.OPEN_STORY})},nQur:(e,t,n)=>{n.d(t,{A:()=>y});var a=n("Au7y"),i=n("Sb6s"),s=n("TRpf"),r=n("Fzox"),o=n("X6oL"),l=n("Nz/Y"),c=n("34sk"),d=n("yJX9"),u=n("vXsw"),p=n("xobL"),m=n("A2sV");const h=a.J1`
	fragment isAlbumFavorite on Album {
		isFavorite
	}
`,y=e=>{const t={albumId:e},n=(0,s.wA)(),a=(0,r.G)((({user:e})=>(0,p.UJ)(e))),y=(0,l.A)(),g=(0,o.z1)(),{data:A}=(0,i.I)({fragment:h,from:{__typename:"Album",id:e},optimistic:!0}),[E]=(0,m._At)({variables:t,optimisticResponse:{__typename:"Mutation",addAlbumToFavorite:{album:{id:e,isFavorite:!0,__typename:"Album"},__typename:"AlbumMutationFavoriteAddOut"}},onCompleted:()=>{n((0,c.TD)(d.Z.favorites,{id:e,timestamp:Date.now()},"album"));const t=g.getTrackingData(),{pagecategory:a,pagename:i,index:s}=t,r=a||i,o="album";r&&g.trackEvent({eventaction:`click-favorite-${r}_${o}`,event:"click",eventcategory:r,eventlabel:`favorite-${r}_${o}`,item:{id:e,type:o,rank:s||0}})}}),[f]=(0,m.I7O)({variables:t,onCompleted:()=>{n((0,c.E$)(d.Z.favorites,e,"album"))},optimisticResponse:{__typename:"Mutation",removeAlbumFromFavorite:{album:{id:e,isFavorite:!1,__typename:"Album"},__typename:"AlbumMutationFavoriteRemoveOut"}}}),_=(0,r.G)((t=>t.feedbacks.favorites.album.feedbacks[e])),v=Boolean(_||(null==A?void 0:A.isFavorite));return{isFavorite:v,toggleFavorite:()=>{a?v?f():(y(),E()):u.g.goToConnection()}}}},pIhH:(e,t,n)=>{n.d(t,{Ay:()=>p,y5:()=>d});var a=n("q1tI"),i=n("TRpf"),s=n("H/eQ"),r=n("WBQ7"),o=n("xobL");const l="wakeUpNotification-time",c="wakeUpNotification-cap";let d=function(e){return e.LTR="ltr",e.RTL="rtl",e}({});class u extends a.Component{constructor(...e){super(...e),this.createGenericNotification=e=>new Notification("Deezer",{body:"Why not listen again to some music?",dir:e,silent:!0}),this.createTrackNotification=(e,t,n)=>new Notification("Deezer",{body:`You last listened to ${e} by ${t.map((e=>e.ART_NAME)).join(", ")}. What will you listen to next?`,dir:n,silent:!0}),this.shouldLaunchTimer=()=>{if(!this.props.isPaused)return!1;const e=Number(r.default.get(l,"0")),t=(new Date).setDate((new Date).getDate()-1),n=Number(r.default.get(c,"0"));return e<t&&n<5},this._onBlur=()=>{this.shouldLaunchTimer()&&(this._timer=window.setTimeout(this._notify,this.props.delay))},this._onFocus=()=>{clearTimeout(this._timer)},this._onNotificationShown=()=>{r.default.set(l,Date.now())},this._notify=()=>{const{trackTitle:e,trackArtists:t,langDirection:n}=this.props;if(e&&t)return this._notification=this.createTrackNotification(e,t,n),void this._setNewCap();this._notification=this.createGenericNotification(n),this._setNewCap()},this._setNewCap=()=>{r.default.set(l,Date.now()),r.default.set(c,Number(r.default.get(c,0)+1))},this._notification=void 0,this._timer=void 0}componentDidMount(){window.addEventListener(s.A.ads.blur,this._onBlur),window.addEventListener(s.A.ads.focus,this._onFocus)}componentWillUnmount(){window.removeEventListener(s.A.ads.blur,this._onBlur),window.removeEventListener(s.A.ads.focus,this._onFocus)}render(){return null}}u.defaultProps={delay:72e5,trackTitle:void 0,trackArtists:[]};const p=(0,i.Ng)((e=>({langDirection:(0,o.iJ)(e.user),isPaused:!e.player.control.playing,trackTitle:e.player.music.trackTitle,trackArtists:e.player.music.trackArtists})))(u)},qMCD:(e,t,n)=>{n.r(t),n.d(t,{App:()=>py,default:()=>hy});var a=n("+9dH"),i=(n("/eM8"),n("q1tI")),s=n("TRpf"),r=n("juqV"),o=n("X6oL"),l=n("Qyje"),c=n.n(l),d=n("WmA5"),u=n("D+Zh"),p=n("ntT5"),m=n("WBQ7");const h="local",y="session",g=window.sessionStorage,A={getStorageKey:e=>`ALERT_DISMISSED_${e}`,markAsDismissed(e,t=h){const n=this.getStorageKey(e);t!==y?m.default.set(n,!0):g.setItem(n,!0)},isDismissed(e,t=h){const n=this.getStorageKey(e);return t===y?Boolean(g.getItem(n)):m.default.isset(n)}};var E=n("H/eQ"),f=n("tZCQ"),_=n("yyc2"),v=n("z+LD"),b=n("e2eG"),k=n("iooo"),T=n("xobL"),C=n("aHAS"),S=n("MeIc"),I=n("nxAS"),w=n("mUtM"),P=n("TqF5"),x=n("Qi9J"),N=n("Zah6"),R=n("L2Iu"),L=n("0sTk"),O=n("CLm1"),D=n("vUoE"),M=n("gN4M"),U=n("xM1r"),F=n("LSdk"),z=n("WKgy"),q=n("LjZa"),B=n("WfRu"),G=n("/uRm");const Q={[G.F.ONBOARDING_LEGACY]:i.lazy((()=>n.e(4822).then(n.bind(n,"Mg2f")))),[G.F.ONBOARDING]:i.lazy((()=>n.e(5986).then(n.bind(n,"5s/P")))),[G.F.SELECT_PROFILE]:i.lazy((()=>n.e(6224).then(n.bind(n,"IXQs")))),[G.F.BRIDGED_WEBVIEW]:i.lazy((()=>n.e(5528).then(n.bind(n,"nMxs")))),[G.F.PLAYLIST_ASSISTANT]:i.lazy((()=>n.e(5528).then(n.bind(n,"9kfl"))))};var V,W;class Y extends i.Component{constructor(...e){super(...e),this._containerRef=i.createRef(),this.renderModal=(e,t,n)=>i.createElement(R.aF,{isOpen:t,motionPreset:"none",size:"full",portalProps:{containerRef:this._containerRef},onClose:()=>{},trapFocus:!1},V||(V=i.createElement(L.m,null)),i.createElement(O.$,{mx:"0",py:"0",bg:"background.neutral.primary.default"},n?i.createElement(D.c,{bg:"background.neutral.primary.default",maxH:"100vh"},e):i.createElement(i.Fragment,null,e))),this.renderDrawer=(e,t,n)=>i.createElement(M._s,{isOpen:t,placement:"bottom",size:"full",portalProps:{containerRef:this._containerRef},onClose:()=>{},trapFocus:!1},W||(W=i.createElement(L.m,null)),i.createElement(U.z,null,n?i.createElement(D.c,{bg:"background.neutral.primary.default",overflow:"hidden",overflowY:"auto"},e):i.createElement(i.Fragment,null,e))),this._close=()=>{this.props.closeScreen()}}componentDidUpdate(e){!e.isOpen&&this.props.isOpen&&this.props.hidePopper()}render(){const{isOpen:e,data:t,name:n,withTransition:s}=this.props,r=!("hideLogo"in t)||!1===t.hideLogo,o="fixedLogo"in t&&!0===t.fixedLogo,l=!("disableDisplayPadding"in t)||!1===t.disableDisplayPadding,c=function(e){return Q[e]||!1}(n),d=e&&Boolean(c),u=i.createElement(i.Fragment,null,r?i.createElement("div",{className:"full-screen-logo-holder"},i.createElement(F.T,{h:"24px",mt:"20px",position:o?"fixed":void 0})):null,d&&c&&i.createElement(i.Suspense,{fallback:null},i.createElement(c,(0,a.A)({},t,{closeScreen:this._close}))));return i.createElement("div",{ref:this._containerRef},s?this.renderDrawer(u,d,l):this.renderModal(u,d,l))}}Y.defaultProps={closeScreen:q.A,withTransition:!1},z.A.addReducers({fullscreen:I.Ay});const j=(0,s.Ng)((({fullscreen:{name:e,data:t}})=>({name:e,data:t,isOpen:Boolean(e)})),{closeScreen:I.Fn,hidePopper:B.Lm})(Y);var K=n("k9rF"),$=n("VQs7"),J=n("vHlZ"),X=n("Wp0Y");const Z=e=>{const t={status:"info",message:(0,X.AP)("Votre ordinateur semble être hors ligne. Nous essayons de vous reconnecter."),...e};return i.createElement(J.A,t)};var ee=n("vbKs"),te=n("rxfZ");class ne extends i.PureComponent{constructor(...e){super(...e),this.alertComponents={[ee.ts]:Z,[ee.B6]:i.lazy((()=>n.e(1970).then(n.bind(n,"x38L")))),[ee.Iv]:i.lazy((()=>n.e(98).then(n.bind(n,"0vC3")))),[ee.AT]:i.lazy((()=>n.e(1169).then(n.bind(n,"/AoH")))),[ee.I6]:i.lazy((()=>n.e(846).then(n.bind(n,"eRco")))),[ee.mu]:i.lazy((()=>n.e(591).then(n.bind(n,"mYFn")))),[ee.v4]:i.lazy((()=>n.e(877).then(n.bind(n,"pSuW")))),[ee.KE]:i.lazy((()=>n.e(2344).then(n.bind(n,"jFpR")))),[ee.cn]:i.lazy((()=>n.e(6745).then(n.bind(n,"598w")))),[ee.aC]:i.lazy((()=>n.e(3918).then(n.bind(n,"2UWz")))),[ee.h5]:i.lazy((()=>n.e(1017).then(n.bind(n,"AhgF")))),[ee.IV]:i.lazy((()=>n.e(4333).then(n.bind(n,"y+nF")))),[ee.jE]:i.lazy((()=>n.e(3287).then(n.bind(n,"cueV"))))}}render(){const{alerts:e}=this.props;return i.createElement(te.a,{className:"page-alerts"},i.createElement(K.N,null,e.map((e=>{const t=this.alertComponents[e.id]||J.A;return i.createElement($.P.div,{key:e.id,initial:{opacity:0,transform:"translate3d(0, -8px, 0)"},animate:{opacity:1,transform:"translate3d(0, 0, 0)"},exit:{opacity:0,transform:"translate3d(0, -8px, 0)"}},i.createElement("div",{className:"alert-wrapper"},i.createElement(i.Suspense,{fallback:null},i.createElement(t,(0,a.A)({id:e.id},e.options)))))}))))}}const ae=(0,s.Ng)((({alerts:e})=>({alerts:e})))(ne);n("EV0h"),n("gS5K");var ie=n("VkUI"),se=n("WrS5");const re=[{name:"gift_result_premium",modal:se.b.LIGHTBOX_GIFT_RESULT,getProps:e=>{const t=new URL(e);return{email:decodeURIComponent(t.searchParams.get("email")||""),code:t.searchParams.get("code")}},size:"small"}],oe=()=>{const e=window.__DZR_MODAL_PATH__||{},t=(0,s.wA)();return(0,i.useEffect)((()=>{var n;if("string"==typeof(null==(n=e)?void 0:n.type)&&"string"==typeof(null==n?void 0:n.page)&&"modal"===e.type){const n=re.find((t=>e.page.includes(t.name)));var a;if(n)return void t((0,P.qf)({name:n.modal,props:n.getProps(e.page),size:null!==(a=n.size)&&void 0!==a?a:"small"}));ie.default.open(decodeURIComponent(e.page))}}),[e]),null};var le=n("ea/m"),ce=n("5pmF"),de=n("axbb"),ue=n("kSUS"),pe=n("Ty5D"),me=n("go2a"),he=n("Swh8"),ye=n("HmE0"),ge=n("XkdG"),Ae=n("wtnB"),Ee=n("7bxg"),fe=n("D2sd"),_e=n("4liH"),ve=n("Fzox"),be=n("xOQS"),ke=n("3o0m"),Te=n("d84/"),Ce=n("waeH"),Se=n("Qx5r"),Ie=n("KVgY"),we=n("A2sV"),Pe=n("p/gB"),xe=n("0O3b"),Ne=n("5G9X");function Re(e){switch(e){case"Track":case"Livestream":case"Artist":case"Playlist":case"Album":return Ne.Ay[e];case"Podcast":return Ne.Ay.Show;case"PodcastEpisode":return Ne.Ay.Episode;default:return""}}var Le=n("Weh+"),Oe=n("gXj/"),De=n("lhvF"),Me=n("FFW9"),Ue=n("A0BP"),Fe=n("lD5d"),ze=n("Z+z7"),qe=n("AfN5"),Be=n("u7vQ"),Ge=n("9OcB"),Qe=n("7bA3"),He=n("GkjM"),Ve=n("3gOz"),We=n("Hews");const Ye=({isFavorite:e,toggleFavorite:t,...n})=>i.createElement(ye.K0,(0,a.A)({icon:i.createElement(We.A,{isActive:e}),onClick:t,variant:"ghost","aria-label":e?(0,X.AP)("Retirer des Coups de cœur"):(0,X.AP)("Ajouter aux Coups de cœur")},n));var je=n("gczi"),Ke=n("gVf4"),$e=n("0JBE");const Je=({track:e,hovered:t})=>{var n,a;const{isFavorite:s,toggleFavorite:r}=(0,je.A)(e.id),{isPaused:o,isPlaying:l}=(0,Ke.A)(Ne.Ay.Track,e.id),{legacyContext:c}=(0,$e.iQ)();return i.createElement(Le.Q,null,i.createElement(Oe.h,null,i.createElement(Ge.A,{src:null===(n=e.album)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.small[0],isExplicitCover:Boolean(null===(a=e.album)||void 0===a||null===(a=a.cover)||void 0===a?void 0:a.explicitStatus),type:Ne.Ay.Track},i.createElement(De.Q,null,i.createElement(Qe.A,{type:Ne.Ay.Track,id:e.id,displayForce:t})))),i.createElement(Me.f,{flex:1,role:"button",onClick:()=>{l||o?Be.Ay.control.togglePause():Be.Ay.play({id:e.id,type:qe.Kk.TRACK_MIX,context:c,forceAsFirstTrack:!0})},textAlign:"left"},i.createElement(Ve.A,null,i.createElement(Ue.n,{"data-testid":"track_title"},e.title)),i.createElement(Ve.A,null,i.createElement(Fe.P,null,i.createElement(ze.E,{as:"span"},(0,X.AP)("generic_title_track_web"))," • ",e.contributors.edges.map(((t,n)=>i.createElement(i.Fragment,{key:`track_contributors_${t.node.id}`},i.createElement(He.A,{underlined:!0,to:`/artist/${t.node.id}`,onClick:e=>e.stopPropagation(),"data-testid":"track_subtitle_contributor"},t.node.name),n<e.contributors.edges.length-1&&", ")))))),i.createElement(Me.f,null,i.createElement(Ye,{isFavorite:s,toggleFavorite:r,size:"small"})))};var Xe=n("x4+n");const Ze=({episode:e,hovered:t})=>{var n,a;const{isPaused:s,isPlaying:r}=(0,Ke.A)(Ne.Ay.Episode,e.id),{legacyContext:o}=(0,$e.iQ)(),[l]=(0,ve.G)((e=>[(0,T.mI)({SERVER_TIMESTAMP:(0,T.mS)(e.user),clientTimestampDelta:(0,T.gE)(e.user)})]));return i.createElement(Le.Q,null,i.createElement(Oe.h,null,i.createElement(Ge.A,{src:null===(n=e.podcast.cover)||void 0===n?void 0:n.small[0],type:Ne.Ay.Episode,isExplicitCover:Boolean(null===(a=e.podcast.cover)||void 0===a?void 0:a.explicitStatus)},i.createElement(De.Q,null,i.createElement(Qe.A,{type:Ne.Ay.Episode,id:e.id,displayForce:t})))),i.createElement(Me.f,{flex:1,role:"button",onClick:()=>{r||s?Be.Ay.control.togglePause():Be.Ay.play({id:e.id,type:qe.Kk.EPISODE,context:o})},textAlign:"left"},i.createElement(Ve.A,null,i.createElement(Ue.n,{"data-testid":"episode_title"},e.title)),i.createElement(Ve.A,null,i.createElement(Fe.P,null,i.createElement(ze.E,{as:"span"},(0,X.AP)("generic_title_episode_web"))," • ",i.createElement(He.A,{underlined:!0,to:`/show/${e.podcast.id}`,onClick:e=>e.stopPropagation(),"data-testid":"episode_subtitle_podcastTitle"},e.podcast.displayTitle)," • ",i.createElement(ze.E,{as:"span","data-testid":"episode_subtitle_publicationDate"},(0,Xe.E)(e.publicationDate,l))))))},et=({liveStream:e,hovered:t})=>{var n,a;const{isPaused:s,isPlaying:r}=(0,Ke.A)(Ne.Ay.Livestream,e.id),{legacyContext:o}=(0,$e.iQ)();return i.createElement(Le.Q,null,i.createElement(Oe.h,null,i.createElement(Ge.A,{src:null===(n=e.cover)||void 0===n?void 0:n.small[0],type:Ne.Ay.Livestream,isExplicitCover:Boolean(null===(a=e.cover)||void 0===a?void 0:a.explicitStatus)},i.createElement(De.Q,null,i.createElement(Qe.A,{shouldPlayRadio:!0,type:Ne.Ay.Livestream,id:e.id,displayForce:t})))),i.createElement(Me.f,{flex:1,role:"button",onClick:()=>{r||s?Be.Ay.control.togglePause():Be.Ay.play({id:e.id,type:qe.Kk.LIVESTREAM,context:o})},textAlign:"left"},i.createElement(Ve.A,null,i.createElement(Ue.n,{"data-testid":"livestream_title"},e.name)),i.createElement(Fe.P,null,i.createElement(ze.E,{as:"span"},(0,X.AP)("generic_title_liveradioSingular_web")),e.isOnStream&&i.createElement(i.Fragment,null," • ",i.createElement(ze.E,{as:"span","data-testid":"livestream_subtitle_onStream"},(0,X.AP)("liveradio_title_onair_web"))))))};var tt=n("23Qi"),nt=n("23mk");const at=({artist:e,hovered:t})=>{var n;const{isFavorite:a,toggleFavorite:s}=(0,nt.A)(e.id);return i.createElement(Le.Q,null,i.createElement(Oe.h,null,i.createElement(Ge.A,{src:null===(n=e.picture)||void 0===n?void 0:n.small[0],type:Ne.Ay.Artist,borderRadius:"rounded"},i.createElement(De.Q,null,i.createElement(Qe.A,{shouldPlayRadio:!0,type:Ne.Ay.Artist,id:e.id,displayForce:t})))),i.createElement(Me.f,{as:He.A,flex:1,to:`/artist/${e.id}`},i.createElement(Ve.A,null,i.createElement(Ue.n,{_hover:{textDecoration:"underline"},width:"fit-content","data-testid":"artist_title"},e.name)),i.createElement(Fe.P,null,i.createElement(ze.E,{as:"span"},(0,X.AP)("generic_title_artist_web"))," • ",i.createElement(ze.E,{as:"span","data-testid":"artist_subtitle_fans"},(0,X.WI)("%s fan","%s fans",{count:e.fansCount,sprintf:[(0,tt.A)(e.fansCount)]})))),i.createElement(Me.f,null,i.createElement(Ye,{isFavorite:a,toggleFavorite:s,size:"small"})))};var it=n("syib");const st=({playlist:e,hovered:t})=>{var n,a,s,r;const{isFavorite:o,toggleFavorite:l}=(0,it.A)(e.id);return i.createElement(Le.Q,null,i.createElement(Oe.h,null,i.createElement(Ge.A,{src:null===(n=e.picture)||void 0===n?void 0:n.small[0],isExplicitCover:Boolean(null===(a=e.picture)||void 0===a?void 0:a.explicitStatus),type:Ne.Ay.Playlist},i.createElement(De.Q,null,i.createElement(Qe.A,{type:Ne.Ay.Playlist,id:e.id,displayForce:t})))),i.createElement(Me.f,{flex:1},i.createElement(Ve.A,null,i.createElement(Ue.n,{as:He.A,to:`/playlist/${e.id}`,"data-testid":"playlist_title"},i.createElement(ze.E,{as:"span",_hover:{textDecoration:"underline"}},e.title))),i.createElement(Ve.A,null,i.createElement(Fe.P,null,i.createElement(ze.E,{as:"span"},(0,X.AP)("generic_title_playlist_web"))," • ",i.createElement(He.A,{underlined:!0,to:`/profile/${null===(s=e.owner)||void 0===s?void 0:s.id}`,"data-testid":"playlist_subtitle_owner"},null===(r=e.owner)||void 0===r?void 0:r.name)))),i.createElement(Me.f,null,i.createElement(Ye,{isFavorite:o,toggleFavorite:l,size:"small"})))};var rt=n("nQur");const ot=({album:e,hovered:t})=>{var n,a;const{isFavorite:s,toggleFavorite:r}=(0,rt.A)(e.id);return i.createElement(Le.Q,null,i.createElement(Oe.h,null,i.createElement(Ge.A,{src:null===(n=e.cover)||void 0===n?void 0:n.small[0],isExplicitCover:Boolean(null===(a=e.cover)||void 0===a?void 0:a.explicitStatus),type:Ne.Ay.Album},i.createElement(De.Q,null,i.createElement(Qe.A,{type:Ne.Ay.Album,id:e.id,displayForce:t})))),i.createElement(Me.f,{flex:1},i.createElement(Ve.A,null,i.createElement(Ue.n,{as:He.A,to:`/album/${e.id}`,"data-testid":"album_title"},i.createElement(ze.E,{as:"span",_hover:{textDecoration:"underline"}},e.displayTitle))),i.createElement(Ve.A,null,i.createElement(Fe.P,null,i.createElement(ze.E,{as:"span"},(0,X.AP)("generic_title_album_web"))," • ",e.contributors.edges.map(((t,n)=>i.createElement(i.Fragment,{key:`search_history_${t.node.id}`},i.createElement(He.A,{underlined:!0,to:`/artist/${t.node.id}`,"data-testid":"album_subtitle_contributor"},t.node.name),n<e.contributors.edges.length-1&&", ")))))),i.createElement(Me.f,null,i.createElement(Ye,{isFavorite:s,toggleFavorite:r,size:"small"})))};n("aRRr");var lt=n("6rbY");const ct=({podcast:e,hovered:t})=>{var n,a;const{isFavorite:s,toggleFavorite:r}=(0,lt.A)(e.id);return i.createElement(Le.Q,null,i.createElement(Oe.h,null,i.createElement(Ge.A,{src:null===(n=e.cover)||void 0===n?void 0:n.small[0],isExplicitCover:Boolean(null===(a=e.cover)||void 0===a?void 0:a.explicitStatus),type:Ne.Ay.Show},i.createElement(De.Q,null,i.createElement(Qe.A,{type:Ne.Ay.Show,id:e.id,displayForce:t})))),i.createElement(Me.f,{flex:1},i.createElement(Ve.A,null,i.createElement(Ue.n,{as:He.A,to:`/show/${e.id}`,"data-testid":"podcast_title"},i.createElement(ze.E,{as:"span",_hover:{textDecoration:"underline"}},e.displayTitle))),i.createElement(Ve.A,null,i.createElement(Fe.P,null,i.createElement(ze.E,{as:"span"},(0,X.AP)("generic_title_podcast_web")),e.description&&i.createElement(i.Fragment,null," • ",i.createElement(ze.E,{as:"span","data-testid":"podcast_subtitle_description"},e.description))))),i.createElement(Me.f,null,i.createElement(Ye,{isFavorite:s,toggleFavorite:r,size:"small"})))};var dt,ut,pt=n("FSqQ");const mt=()=>{var e,t;const[n,a]=i.useState(null),r=i.useRef(null),{data:o,fetchMore:l}=(0,we.CwG)({fetchPolicy:"cache-only"}),[c]=(0,we.g1V)({update:(e,t)=>{var n;null!==(n=t.data)&&void 0!==n&&n.clearSearchSuccessResult.status&&e.updateQuery({query:we.epo},(e=>e&&e.me?{me:{...e.me,searchHistory:{...e.me.searchHistory,successResults:{...e.me.searchHistory.successResults,edges:[]}}}}:e))}}),d=(0,s.wA)(),u=(0,xe.A)(null==o||null===(e=o.me)||void 0===e||null===(e=e.searchHistory.successResults)||void 0===e?void 0:e.edges);return null!=o&&o.me&&0!==u.length?i.createElement(Te.s,{direction:"column",maxHeight:"385px"},i.createElement(Te.s,{direction:"row",ps:"spacing.l",pe:"spacing.m",py:"spacing.s",justify:"space-between",align:"center"},i.createElement(Ce.D,{variant:"heading.s","data-testid":"recent_search_title"},(0,X.AP)("searchsubsection_title_recentsearches_web")),i.createElement(ye.K0,{variant:"ghost","aria-label":(0,X.AP)("Effacer"),onClick:()=>{c(),d((0,B.Lm)())},size:"small","data-testid":"recent_search_clear_button"},dt||(dt=i.createElement(Se.u,null)))),i.createElement(te.a,{overflow:"auto",ref:r},i.createElement(Ie.A,{hasMore:null==o||null===(t=o.me)||void 0===t||null===(t=t.searchHistory.successResults)||void 0===t?void 0:t.pageInfo.hasNextPage,loadMore:()=>{var e;return l({variables:{cursor:null==o||null===(e=o.me)||void 0===e||null===(e=e.searchHistory.successResults)||void 0===e?void 0:e.pageInfo.endCursor}})},loader:ut||(ut=i.createElement(pt.A,{key:"loader"})),useWindow:!1,getScrollParent:()=>r.current},u.filter((e=>"Mix"!==e.__typename)).map(((e,t)=>i.createElement($e.OJ,{key:`${t}_${e.id}`,value:{legacyContext:{ID:e.id,TYPE:(0,Pe.TU)(Re(e.__typename))}}},i.createElement(te.a,{ps:"spacing.l",pe:u.length>6?0:"spacing.m",py:"spacing.s",onMouseEnter:()=>{a(`${t}_${e.id}`)},onMouseLeave:()=>a(null)},((e,t)=>{const a=n===t;switch(e.__typename){case"Track":return i.createElement(Je,{track:e,hovered:a});case"PodcastEpisode":return i.createElement(Ze,{episode:e,hovered:a});case"Livestream":return i.createElement(et,{liveStream:e,hovered:a});case"Artist":return i.createElement(at,{artist:e,hovered:a});case"Playlist":return i.createElement(st,{playlist:e,hovered:a});case"Album":return i.createElement(ot,{album:e,hovered:a});case"Podcast":return i.createElement(ct,{podcast:e,hovered:a});default:return null}})(e,`${t}_${e.id}`)))))))):null};var ht,yt=n("zDvJ");const gt=(0,be.A)((({hasRecentSearches:e})=>e?i.createElement(ke.A,{className:"popper-search",size:yt.W8,"data-testid":"search_popper"},i.createElement(Te.s,{flexDirection:"column",maxHeight:"440px",overflowY:"auto",onClick:e=>e.stopPropagation()},ht||(ht=i.createElement(mt,null)))):null));var At;const Et="topbar-search",ft=()=>{var e;const t=(0,pe.W6)(),n=(0,pe.zy)(),[o,{data:l}]=(0,we.SNU)({variables:{first:20,cursor:null},fetchPolicy:"network-only"}),c=i.useCallback((e=>{var t,a;const i=/^\/(?<type>search|tags)\/(?<query>.*?)(\/|$)/.exec((null==e?void 0:e.pathname)||n.pathname);if(!i)return"";const s=decodeURIComponent((null===(t=i.groups)||void 0===t?void 0:t.query)||"");return"tags"===(null===(a=i.groups)||void 0===a?void 0:a.type)?`#${s}`:"+"===s.charAt(0)&&s.length>1?s.substring(1):s}),[n.pathname]),[d,u]=i.useState(c()),m=(0,s.wA)(),[h,y]=(0,ve.G)((e=>[(0,B.Pu)(e.popper,Et),(0,T.UJ)(e.user)])),g=()=>m((0,B.Lm)()),A=i.useRef(null),f=i.useCallback((0,ue.A)((e=>{(e=>{e.trim()?(h&&g(),(0,p.Uw)(e,"",p.vg,_e.dZ,0,p.P$),t.push((e=>e.length>1&&0===e.lastIndexOf("#",0)?`/tags/${encodeURIComponent(e.replace(/#/g,""))}`:`/search/${encodeURIComponent(e)}`)(e))):_()})(e)}),300),[]),_=e=>{null==e||e.stopPropagation(),u(""),A&&A.current&&A.current.focus()},v=()=>{fe.A.sendLog()};i.useEffect((()=>{window.addEventListener("visibilitychange",v);const e=t.listen((e=>{e.pathname.includes("search")||v(),u(c(e))}));return()=>{e(),window.removeEventListener("visibilitychange",v)}}));const b=""!==d,k=(0,r.A)("topbar-search-form",{"topbar-search-active":b}),C=(0,r.A)("topbar-search-clear",{"is-active":b}),S={"aria-label":(0,X.AP)("Rechercher"),placeholder:(0,X.AP)("searchfielddescription_text_artiststrackspodcasts_web"),value:d,onChange:e=>{const t=e.target.value;fe.A.addQuery(t),u(t),f(t)},onKeyDown:h?e=>{if("Tab"===e.key&&h)g();else if("Enter"===e.key){const e=d.trim();f(e)}}:void 0,onFocus:()=>{""===d&&!h&&y&&o()},ref:A,autoComplete:"off"},I={popperId:Et,hasArrow:!1,closeOnClick:!1,isFullWidth:!0,data:{hasRecentSearches:Boolean(null==l||null===(e=l.me)||void 0===e||null===(e=e.searchHistory.successResults)||void 0===e?void 0:e.edges.length)}};return i.createElement("div",{className:"topbar-search"},i.createElement(gt,I,i.createElement(te.a,{className:k,"data-testid":"search_container"},i.createElement(me.M,null,At||(At=i.createElement(he.W,{pointerEvents:"auto"},i.createElement(ye.K0,{variant:"link",type:"submit","aria-label":"","aria-labelledby":"topbar-search",icon:i.createElement(Ae.o,{color:"icon.neutral.primary.default"}),pointerEvents:"none"}))),i.createElement(ge.p,(0,a.A)({id:"topbar-search",type:"search"},S,{"data-testid":"search_field"})),i.createElement(he.t,{className:C},i.createElement(ye.K0,{variant:"link",onClick:_,"aria-hidden":!b,"aria-label":(0,X.AP)("Effacer"),icon:i.createElement(Ee.w,{color:"icon.neutral.secondary.default",_hover:{color:"icon.neutral.secondary.hovered"}})}))))))};var _t=n("AtZM"),vt=n("M3gt"),bt=n("nrKQ"),kt=n("tZJO"),Tt=n("rXlm"),Ct=n("7E8A"),St=n("hz5U"),It=n("QOhT");class wt extends i.Component{constructor(e){super(e),this._markAsRead=this._markAsRead.bind(this),this.state={data:e.data}}shouldComponentUpdate(e,t){return t.data.NOTIFICATION_ID!==this.state.data.NOTIFICATION_ID||t.data.READ!==this.state.data.READ}render(){const{data:e}=this.state,t=!e.READ,n=(0,r.A)("notifications-item",{"is-unread":t}),a=t?this._markAsRead:void 0;return i.createElement("li",{className:n,onMouseOver:a},i.createElement("div",{className:"notifications-item-container"},i.createElement("div",{className:"notifications-item-content"},i.createElement("div",{className:"notifications-item-media"},i.createElement("div",{className:"notifications-item-media-picture"},this._renderPicture()),i.createElement("div",{className:"notifications-item-media-title"},i.createElement("div",{className:"heading-4"},i.createElement(He.A,{to:e.URL},e.TITLE)),i.createElement("div",{className:"heading-4-sub"},e.SUBTITLE))),i.createElement("div",null,i.createElement("div",{className:"notifications-item-info"},e.QUOTATION_TITLE),i.createElement("div",{className:"notifications-item-comment"},e.QUOTATION_MESSAGE)),i.createElement("div",{className:"notifications-item-date"},e.FOOTER))))}_renderPicture(){const{data:e}=this.state,t=St.A.getImageSrc(e.COVER_TYPE,e.PICTURE,56,56,null,100);return i.createElement(It.A,{type:e.MEDIA_TYPE,height:56,width:56,imgSrc:t,context:`menu_panel_notification_${e.MEDIA_TYPE}`,pageContext:Ct[`CONTEXT_TOPBAR_POPPER_${e.MEDIA_TYPE.toUpperCase()}`],id:e.MEDIA_ID,redirectUrl:e.URL})}_markAsRead(){let e={...this.state.data};e.READ||(e.READ=1,this.setState({data:e},(()=>{b.A.markNotificationAsRead(e.NOTIFICATION_ID)})))}}const Pt=(0,s.Ng)((({user:e})=>({serverTimestamp:e.SERVER_TIMESTAMP,clientTimestampDelta:e.clientTimestampDelta})))(wt);var xt,Nt,Rt=n("fSLK"),Lt=n("I36q");class Ot extends i.Component{constructor(e){super(e),this._fetchNext=()=>{this.state.isNextPageLoading||this.state.rows&&this.state.rows.length===this.props.totalNotifs||this.setState({isNextPageLoading:!0},(()=>{setTimeout((()=>{this._fetchNotificationsPage=bt.A.call({method:"notification.list",data:{USER_ID:this.props.userId,LAST_NOTIFICATION_ID:this.state.lastNotifId,NB:20},success:e=>{if(e.data&&e.data.length>0){const t=e.data.map((e=>kt.A.getNormalizedData(e)));this.setState({rows:[...this.state.rows].concat(t),lastNotifId:t[t.length-1].NOTIFICATION_ID,isNextPageLoading:!1})}}})}),2500)}))},this.state={rows:e.data,lastNotifId:e.data&&e.data.length>0?e.data[e.data.length-1].NOTIFICATION_ID:0,isNextPageLoading:!1}}componentWillUnmount(){bt.A.cancel(this._fetchNotificationsPage)}render(){const{data:e,isLoading:t}=this.props;return t?this._renderLoading():e.length>0?this._renderList():this._renderPlaceholder()}_renderList(){const e=this.state.rows,t=({index:t,style:n})=>e[t]?i.createElement("div",{style:n},i.createElement(Pt,{key:`notification_${e[t].NOTIFICATION_ID}`,data:e[t],index:t})):null,n=t=>{const n=e[t];return n?125+(n.QUOTATION_MESSAGE?30*Math.ceil(n.QUOTATION_MESSAGE.length/80):0)+(n.QUOTATION_TITLE?20*Math.ceil(n.QUOTATION_TITLE.length/100):0):0};return i.createElement(vt.A,{isItemLoaded:()=>!1,itemCount:this.props.totalNotifs,loadMoreItems:this._fetchNext},(({onItemsRendered:a,ref:s})=>i.createElement(Rt._m,{itemCount:e?e.length:0,onItemsRendered:a,ref:s,height:450,itemSize:n,width:"100%"},t)))}_renderLoading(){return i.createElement("div",{className:"popper-body"},i.createElement("div",{className:"notifications-placeholder"},xt||(xt=i.createElement("div",{className:"notifications-placeholder-image notifications-placeholder-loader animate-spin"})),i.createElement("div",{className:"notifications-placeholder-title"},(0,X.AP)("Chargement en cours"))))}_renderPlaceholder(){return i.createElement(Tt.A,{className:"popper-body"},i.createElement("div",{className:"notifications-placeholder"},Nt||(Nt=i.createElement("div",{className:"notifications-placeholder-image notifications-placeholder-friends"})),i.createElement("div",{className:"notifications-placeholder-title"},(0,X.AP)("Ne restez pas dans votre coin.")),i.createElement(ye.$n,{onClick:this.props.openOnboardingScreen},(0,X.AP)("onboardingartistpicker_title_addartists_web"))))}}Ot.defaultProps={isLoading:!1};const Dt=(0,s.Ng)((({user:e})=>({userId:e.USER.USER_ID})),(e=>({openOnboardingScreen:()=>e((0,I.J2)({name:f.A.isAllowed("public_api_onboarding")?G.F.ONBOARDING:G.F.ONBOARDING_LEGACY,data:{showCloseButton:!0,context:Lt.d.Improve,callbackLink:"/profile/me"}}))})))(Ot);var Mt=n("hIIJ");class Ut extends i.Component{constructor(e){super(e),this._currentList=[],this._nbDisplay=20,this._updateNotifications=this._updateNotifications.bind(this),this.state={data:[...b.A.data.NOTIFICATIONS],notificationCount:b.A.getNotificationCount(),nbDisplay:this._nbDisplay}}componentDidMount(){E.A.subscribe(E.A.live.notificationNew,this._updateNotifications,"popper_notifications"),E.A.subscribe(E.A.live.notificationRead,this._updateNotifications,"popper_notifications")}shouldComponentUpdate(e,t){return e.selected!==this.props.selected||t.notificationCount!==this.state.notificationCount||t.data.length!==this.state.data.length||t.nbDisplay!==this.state.nbDisplay}componentWillUnmount(){E.A.unsubscribeAll("popper_notifications")}render(){const{nbDisplay:e}=this.state,t=this.state.data.slice(0,e),n=b.A.data.TOTAL_NOTIFICATIONS;return i.createElement(ke.A,{className:"popper-notifications",size:"lg"},i.createElement("div",{className:"popper-headings"},f.A.isAllowed("revamp2023")?i.createElement(Mt.A,{title:(0,X.AP)("Notifications")}):i.createElement("h2",{className:"heading-2"})),i.createElement(Dt,{data:t,totalNotifs:n,key:"notifications-list"}))}_updateNotifications(){this.setState({notificationCount:b.A.getNotificationCount(),data:[...b.A.data.NOTIFICATIONS]})}}Ut.defaultProps={selected:null};const Ft=(0,be.A)(Ut);var zt,qt=n("brAN");class Bt extends i.Component{constructor(e){super(e),this._updateUnseenNotifications=this._updateUnseenNotifications.bind(this),this.state={unseenNotificationCount:0}}componentDidMount(){E.A.subscribe(E.A.live.notificationNew,this._updateUnseenNotifications),E.A.subscribe(E.A.live.notificationRead,this._updateUnseenNotifications),E.A.ready(E.A.user.userReady,this._updateUnseenNotifications)}componentWillUnmount(){E.A.unsubscribe(E.A.live.notificationNew,this._updateUnseenNotifications),E.A.unsubscribe(E.A.live.notificationRead,this._updateUnseenNotifications)}render(){const e={popperId:"topbar-notification",trigger:[yt.uW],delay:500,isDisabled:!1};return i.createElement(Ft,(0,a.A)({className:"topbar-action"},e),i.createElement(ye.K0,{"aria-label":(0,X.AP)("Notifications"),variant:"ghost",size:"small",icon:i.createElement(i.Fragment,null,zt||(zt=i.createElement(qt.$,null)),i.createElement(_t.x,{count:this.state.unseenNotificationCount,fontSize:"10px",top:"5px",right:"5px","aria-label":"topbar-notification-counter"}))}))}_updateUnseenNotifications(){this.setState({unseenNotificationCount:b.A.getNotificationCount()})}}var Gt=n("2qhg"),Qt=n("r2u9"),Ht=n("04sm");const Wt=()=>{document.body.classList.add("no-transitions"),document.documentElement.removeAttribute("data-theme"),window.requestAnimationFrame((()=>{document.body.classList.remove("no-transitions")}))};var Yt,jt,Kt,$t,Jt,Xt,Zt=n("3JOg"),en=n("rYh+"),tn=n("R5X+"),nn=n("zzll"),an=n("w/ZN"),sn=n("70bL"),rn=n("P1K6");const on=["GB","FR","DE","BE","BR","US"];let ln=(0,o.Ay)()(Yt=class extends i.Component{constructor(...e){super(...e),this._onClose=(e,t=null)=>{void 0!==e.key&&"Enter"!==e.key||"function"==typeof t&&t()}}render(){return i.createElement(ke.A,{className:"popper-account",size:"lg"},this._renderHeader(),this._renderContent())}_renderHeader(){const{userId:e,userPicture:t,displayName:n}=this.props;return i.createElement(i.Fragment,null,i.createElement(Zt.A,null,i.createElement(He.A,{className:"account-header animate-wobble",to:`/profile/${e}`},i.createElement(tn.e,{size:"size.l",variant:"neutral",name:n,src:t?(0,rn.AE)(Ne.Ay.User,t,100,100):""}),i.createElement("div",{className:"account-heading ellipsis"},i.createElement("span",{className:"account-name"},this.props.displayName)),jt||(jt=i.createElement(en.A,null)))),this._renderEntryPoint())}_renderContent(){return i.createElement("ul",{className:"account-menu",role:"navigation"},this._getLinks().map((e=>this._renderElement(e))))}_renderElement(e){if(e.isDisabled)return null;const t=(0,r.A)("account-item",{"is-divider":e.isDivider});return i.createElement("li",{className:t,key:e.id,"data-testid":e.id},e.isCheckbox?this._renderCheckbox(e):this._renderLink(e))}_renderLink(e){const t={className:(0,r.A)("account-link",{"is-main":e.isMain}),to:e.to||"",onClick:t=>this._onClose(t,e.onClick),target:e.isExternal?"_blank":void 0};return e.to||Object.assign(t,{role:"button",tabIndex:0,onKeyPress:t=>this._onClose(t,e.onClick)}),e.isAnimated?i.createElement(Zt.A,null,i.createElement(He.A,t,i.createElement("span",{className:"account-link-label"},e.label),"multiAccount"===e.id?this._renderWarning():null,Kt||(Kt=i.createElement(en.A,null)))):i.createElement(He.A,t,e.label)}_renderEntryPoint(){const{entryPoints:e}=this.props;return void 0!==e.SUBSCRIBE_FROM_SETTINGS&&""!==e.SUBSCRIBE_FROM_SETTINGS.action&&""!==e.SUBSCRIBE_FROM_SETTINGS.label&&""!==e.SUBSCRIBE_FROM_SETTINGS.description?i.createElement(Zt.A,null,i.createElement(He.A,{className:"account-header",to:e.SUBSCRIBE_FROM_SETTINGS.action,target:"_blank"},i.createElement("div",{className:"account-entrypoint"},i.createElement("span",{className:"account-link-label account-entrypoint-label"},e.SUBSCRIBE_FROM_SETTINGS.label),$t||($t=i.createElement("br",null)),i.createElement("span",{className:"account-link-label account-entrypoint-description"},e.SUBSCRIBE_FROM_SETTINGS.description)),Jt||(Jt=i.createElement(en.A,null)))):null}_renderWarning(){return this.props.remainingAccountsCount<0?Xt||(Xt=i.createElement(an.i,{className:"multi-account-warning"})):null}_renderCheckbox(e){const t=(0,r.A)("account-input-label",{"is-main":e.isMain});return i.createElement("div",{className:"account-input"},i.createElement("div",{className:t},e.label),i.createElement(nn.d,{isChecked:e.isChecked,onChange:e.onClick}))}_setDarkModeOption(e){Ht.A.set({global:{dark_mode:f.A.isAllowed("dark_mode")&&e}}),this.props.tracking&&this.props.tracking.trackEvent({eventaction:"click-darkmode-toggle",event:"click",eventlabel:`darkmode-${e}`}),bt.A.call({method:"log_central.log",data:{BATCH:[{channel:"feature_activation",params:{ts:Math.floor(Date.now()/1e3),state:e,feature:"darkmode-toggle",os_based:!1}}]}})}_manageMyAccount(){this.props.tracking&&this.props.tracking.trackEvent({eventaction:"manage-subscription-button",event:"click",eventcategory:"account"}),open("/account/subscription")}_trackGiftCard(){this.props.tracking&&this.props.tracking.trackEvent({eventaction:"get-voucher",event:"click",eventcategory:"account"})}_getLinks(){var e,t,a,i;const{darkModeOption:s,userLang:r}=this.props;return[{id:"multiAccount",label:(0,X.AP)("settingspage_title_members_web"),isDisabled:this.props.isSubAccount||!this.props.isOnline||!(this.props.hasMultiAccountEnabled||this.props.hasChildAccounts),isMain:!0,isAnimated:!0,onClick:()=>this.props.openScreen({name:G.F.SELECT_PROFILE,data:{}})},{id:"account",label:(0,X.AP)("accountsettingspage_title_accountsettings_web"),to:"/account",isMain:!0,isAnimated:!0},{id:"subscription",label:(0,X.AP)("Gérer mon abonnement"),onClick:()=>this._manageMyAccount(),isMain:!0,isAnimated:!0,isDisabled:this.props.isSubAccount||this.props.hasParent},{id:"partners",label:null===(e=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===e?void 0:e.label,to:null===(t=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===t?void 0:t.action,isMain:!0,isAnimated:!0,isDisabled:void 0===this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS||""===(null===(a=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===a?void 0:a.action)||""===(null===(i=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===i?void 0:i.label)},{id:"exclusions",label:(0,X.AP)("banfeatures_action_managemyexclusions_web"),to:`/${r}/exclusions`,isMain:!0,isAnimated:!0},{id:"getGiftCard",label:(0,X.AP)("planspage_action_getagiftcard_web"),to:"/payment/go.php?id=1&gift=1&origin=gift-account-menu-desktop",onClick:()=>this._trackGiftCard(),isMain:!0,isAnimated:!0,isExternal:!0,isDisabled:!on.includes(this.props.country)},{id:"gift",label:(0,X.AP)("Activer un code"),to:"/gift",isMain:!0,isAnimated:!0,isExternal:!0,isDisabled:this.props.hasParent||this.props.userHasOffer},{id:"logout",label:(0,X.AP)("Déconnexion"),isMain:!0,onClick:async()=>{if(Qt.Ay){const{default:e}=await Promise.resolve().then(n.bind(n,"7sx+"));await e.logout();const{default:t}=await Promise.resolve().then(n.bind(n,"WBQ7"));t.set("selectedChildAccount",!1,!0),Qt.Ay.deleteLoginInfo()}else Gt.default.logout()}},{id:"kid",label:(0,X.AP)("Activer Deezer Kids"),onClick:()=>Gt.default.setKidStatus(),isMain:!0,isDivider:!0,isCheckbox:!0,isChecked:this.props.isKid,isDisabled:!this.props.hasParent||this.props.isSubAccount||this.props.isKid},{id:"darkmode",label:(0,X.AP)("accountmenu_title_darkmode_web"),isMain:!0,isDivider:!0,isCheckbox:!0,isChecked:"off"!==s,isDisabled:!(window&&window.CSS&&window.CSS.supports("color","var(--primary)")&&f.A.isAllowed("dark_mode")),onClick:()=>this._setDarkModeOption("off"===s?"on":"off")},{id:"support",label:(0,X.AP)("generic_title_support_web"),to:"https://support.deezer.com/",isAnimated:!0,isDivider:!0,isExternal:!0},{id:"community",label:(0,X.AP)("generic_title_communityandfeedback_web"),to:"/support",isAnimated:!0,isDivider:!1,isExternal:!0},{id:"features",label:(0,X.AP)("Fonctionnalités"),to:(0,k.Tn)(r),isAnimated:!0,isExternal:!0},{id:"offers",label:(0,X.AP)("Offres"),to:"/offers",isAnimated:!0,isExternal:!0,isDisabled:this.props.userHasOffer},{id:"report_content",label:(0,X.AP)("settingspage_title_DSAreportcontent_web"),to:"https://support.deezer.com/hc/requests/new?ticket_form_id=18694766502813",isAnimated:!0,isExternal:!0},{id:"company",label:(0,X.AP)("À propos"),to:"/company",isAnimated:!0,isExternal:!0},{id:"jobs",label:(0,X.AP)("Jobs"),to:"https://www.deezerjobs.com/",isAnimated:!0,isExternal:!0},{id:"legal",label:(0,X.AP)("Légal"),to:"/legal/cgu",isAnimated:!0,isExternal:!0}]}})||Yt;const cn=(0,be.A)((0,s.Ng)((e=>({userId:(0,T.F6)(e.user),userPicture:(0,T.jg)(e.user),userHasOffer:(0,T.jQ)(e.user),userLang:(0,T.Z0)(e.user),displayName:(0,T.Mn)(e.user),langDirection:(0,T.iJ)(e.user),darkModeOption:(0,T.HZ)(e.user),hasChildAccounts:(0,T.bU)(e.user),hasMultiAccountEnabled:(0,T.mE)(e.user),hasParent:(0,T.p7)(e.user),isSubAccount:(0,T.m0)(e.user),isKid:(0,T.zI)(e.user),isOnline:(0,sn.sc)(e),childs:(0,T.TW)(e.user),remainingAccountsCount:(0,T.KU)(e.user),country:(0,T.JJ)(e.user),entryPoints:(0,T.WL)(e.user)})),{openScreen:I.J2,openModal:P.qf})(ln));class dn extends i.Component{render(){const{userPicture:e,userName:t}=this.props,n={popperId:"topbar-profile",trigger:[yt.uW],delay:500,isDisabled:!1};return i.createElement(cn,(0,a.A)({className:"topbar-action"},n),i.createElement(tn.e,{as:"button","data-testid":"topbar-profile",size:"size.m",variant:"neutral",name:t,src:e?(0,rn.AE)(Ne.Ay.User,e,100,100):"",isHoverEnabled:!0}))}}const un=(0,s.Ng)((({user:e})=>({userPicture:e.USER.USER_PICTURE,userName:(0,T.Mn)(e)})))(dn);var pn,mn=n("17x9"),hn=n.n(mn),yn=n("LvjZ"),gn=n("XBvc");function An(e){return e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}pn=document.head&&document.head.dataset?{set:function(e,t,n){e.dataset[t]=n},get:function(e,t){return e.dataset[t]},del:function(e,t){delete e.dataset[t]},getAll:function(e){return e.dataset}}:{set:function(e,t,n){return e.setAttribute("data-"+An(t),n),n},get:function(e,t){var n=e.getAttribute("data-"+An(t));return null===n?void 0:n},del:function(e,t){return e.removeAttribute("data-"+An(t)),!0},getAll:function(e){for(var t,n,a={},i=0;i<e.attributes.length;i++)"data-"===(t=e.attributes[i].name).substr(0,5)&&(a[(n=t.substr(5),n.toLowerCase().replace(/-(.)/g,(function(e,t){return t.toUpperCase()})))]=e.attributes[i].value);return a}};const En_dataset=function(e,t,n){var a={set:function(t,n){return pn.set(e,t,n),a},get:function(t){return pn.get(e,t)},del:function(t){return pn.del(e,t),a}};return 3===arguments.length?a.set(t,n):2===arguments.length?a.get(t):pn.getAll(e)};class fn extends i.Component{render(){const{CONVERSION_BANNER_FREE_MYMENU:e,CONVERSION_BANNER_TRIAL_MYMENU:t}=this.props.conversionEntrypoints,n=e||t;return n?i.createElement(ke.A,{className:"popper-entrypoints",size:yt.Dn},i.createElement("p",null,n.description)):null}}const _n=(0,be.A)((0,s.Ng)((({user:e})=>({conversionEntrypoints:e.USER.ENTRYPOINTS})))(fn));var vn,bn=n("nzlo");function kn(e){return i.createElement(bn.A,(0,a.A)({name:"add"},e),vn||(vn=i.createElement("path",{fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M6 1.5v9M1.5 6h9"})))}var Tn,Cn=n("6Va4");class Sn extends i.Component{constructor(e){super(e),this._onLinkClick=this._onLinkClick.bind(this)}render(){const{conversionEntrypoints:e}=this.props;if(0===Object.keys(e).length)return null;const{CONVERSION_BANNER_FREE:t,CONVERSION_BANNER_TRIAL:n,CONVERSION_BANNER_FREE_MYMENU:a,CONVERSION_BANNER_TRIAL_MYMENU:s,MYMENU:r}=e;if(t||n)return null;const o=a||s||r;if(!o)return null;const l={className:"topbar-entrypoints",popperId:"topbar-entrypoints",trigger:[yt.mH],delay:0,isDisabled:!o.description},c={as:"a",colorScheme:"primary",leftIcon:r?Tn||(Tn=i.createElement(kn,null)):void 0,href:(0,Cn.hY)(o.action),onClick:this._onLinkClick,target:"_blank","data-type":"offers_subscribe"};return i.createElement(_n,l,i.createElement(ye.$n,c,o.label))}_onLinkClick(e){this.tracking("menu_click",e.currentTarget)}}const In=(0,s.Ng)((({user:e})=>({conversionEntrypoints:e.USER.ENTRYPOINTS})))((e=>{var t;const n=Object.assign({},e.contextTypes||{},{getTrackingParams:hn().func}),a=((t=class extends e{constructor(...e){super(...e),this.tags={player_click:["type"],context_menu_click:["type","instance"],panel_click:["panel","type","id","index","instance"],menu_click:["type"],lyrics:["ts","action","container","sng","type"],artist_page_click:["type"],discography_click:["type","position","sort","view"],adblock_banner:["group","link","close"],pushbox:["action","box"]},this.platform={lyrics:"deezer_log",pushbox:"deezer_log"}}tracking(e,t){if("object"!=typeof this.tags[e])return!1;let n="function"==typeof this.getTrackingParams?this.getTrackingParams():{};"function"==typeof this.context.getTrackingParams&&Object.assign(n,this.context.getTrackingParams());let a={};"object"==typeof t&&(a=En_dataset(t));for(let t=0;t<this.tags[e].length;t++){let i=this.tags[e][t];"ts"!==i?void 0!==a[i]&&null!==a[i]&&(n[i]=a[i]):n[i]=(0,T.mI)({SERVER_TIMESTAMP:this.props.serverTimestamp,clientTimestampDelta:this.props.clientTimestampDelta})}let i="";return"string"==typeof a.trackingCallback&&(i=this[a.trackingCallback]||""),"string"==typeof this.platform[e]&&"deezer_log"===this.platform[e]?((0,gn.isLogCentralWhitelisted)(e)||v.A.warn(`log_central is deprecated. "${e}" is not a whitelisted event.`),bt.A.call({method:"log_central.log",data:{BATCH:[{channel:e,params:n}]}}),!0):(i(),!0)}}).displayName=`TrackingComponentHOC(${(0,yn.A)(e)})`,t.contextTypes=n,t);return(0,s.Ng)((({user:e})=>({serverTimestamp:e.SERVER_TIMESTAMP,clientTimestampDelta:e.clientTimestampDelta})),null,null,{forwardRef:!0})(a)})(Sn));var wn,Pn=n("okj2"),xn=n("vti/"),Nn=n("yiM3");class Rn extends i.Component{render(){return i.createElement(i.Fragment,null,wn||(wn=i.createElement(ft,null)),i.createElement(Pn.z,{ms:"8",spacing:"4"},i.createElement(xn.N,{fontWeight:"bold",fontSize:"md",href:(0,k.jd)("/offers"),onClick:this._onTrackingClick.bind(this,"plans-button")},(0,X.AP)("Offres")),i.createElement(ye.$n,{as:"a",size:"small",id:"topbar-login-button",href:(0,Nn.t)({route:"login",comeback:!0}),variant:"outline",onClick:this._onTrackingClick.bind(this,"login-button")},(0,X.AP)("Connexion")),i.createElement(ye.$n,{as:"a",size:"small",id:"topbar-register-button",href:(0,Nn.t)({route:"register",comeback:!0}),onClick:this._onTrackingClick.bind(this,"signup-button")},(0,X.AP)("Inscription"))))}_onTrackingClick(e){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"click",eventcategory:"header",eventaction:e})}}const Ln=(0,pe.y)(Rn);var On=n("X5lq"),Dn=n("eC9Z"),Mn=n("QSbk"),Un=n("LOQS"),Fn=n("bbm1");const Gn=()=>{const[e,t]=(0,i.useState)(!1),a=(0,Fn.useDeezToolsContext)(),s=(0,Fn.useDeezToolsDispatch)();(0,i.useEffect)((()=>{t((0,Dn.sg)(a))}),[a]);const r=()=>{Un.A.flush(),(0,Mn.ri)(),n("r2u9").Ay.reloadApp()};return i.createElement("div",{className:"bv4i9"},i.createElement(ye.$n,{onClick:()=>{(0,Dn.N1)({dispatch:s}),r()}},"Reset all"),e?i.createElement("span",{className:"k2wQ5"},"You have unsaved changes"):null,i.createElement(ye.$n,{className:"iAuIU",onClick:()=>{(0,Dn.ct)({contextState:a,dispatch:s}),r()}},"Apply"))},Yn="Mty7y",Kn=({items:e,activeTab:t})=>{const n=e.map((e=>{var n;const a=(0,r.A)("xzwen",{vk6fm:t===e.id}),s=t===e.id||null===(n=e.action)||void 0===n?void 0:n.bind(null,e);return i.createElement("li",{key:e.id,className:"X80It"},i.createElement("a",{className:a,onClick:s,role:"tab",tabIndex:0,"aria-selected":t===e.id,onKeyDown:s},e.label))}));return i.createElement("ul",{className:"EwBfV",role:"tablist"},n)};var $n=n("5xmB");const Xn=({children:e})=>e?i.createElement(Tt.A,{className:"qJuZF"},i.createElement("ul",null,e)):null;var Zn=n("wGgI");const aa="xsx1k",sa="nMT_c",ra="Jykpc",oa="M5BqM",la="bO138",ca=({name:e,label:t,items:n,currentValue:a,originalValue:s,onChange:o})=>{const[l,c]=(0,i.useState)(null!==a?a:s),[d,u]=(0,i.useState)(0),[p,m]=(0,i.useState)(l!==s),h=(0,i.useCallback)((t=>{c(t),null==o||o(e,t)}),[e,o]);(0,i.useEffect)((()=>{m(l!==s),u(n.findIndex((e=>e.value===l)))}),[l,n,s]);const y=n.map((e=>{const t=(0,r.A)({[ra]:l===e.value});return i.createElement(Zn.Ay.Item,{key:e.label,label:e.label},i.createElement("a",{className:t,onClick:h.bind(null,e.value),role:"button"},e.value))})),g=(0,r.A)(sa,{[ra]:p});return i.createElement("li",{className:(0,r.A)(aa)},i.createElement("span",{className:g},t||e),p?i.createElement("span",{className:la},"Modified"):null,i.createElement(Zn.Ay,{className:oa,align:Zn.VX,selected:d},y))},da=({className:e,children:t})=>t?i.createElement("div",{className:(0,r.A)("SKrtC",e)},t):null;var ua=n("pUfN");const pa=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=(0,s.d4)((({user:e})=>(0,T.zJ)(e))),a=(0,Dn.CN)({itemType:ua.Wi.CONFIG,itemName:"media-service",context:t});return i.createElement(da,null,i.createElement(ca,{key:"media-service",name:"media-service",label:"Media Service host",items:[{label:"dev",value:"https://dev-media.deez.re"},{label:"local",value:"https://localhost:1443"},{label:"qa",value:"https://qa-media.deezer.com"},{label:"prod",value:"https://media.deezer.com"}],currentValue:a,originalValue:n,onChange:e}))};var ma=n("Vd8Q");const ha=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=ma.default.get("host_pipe"),a=(0,Dn.CN)({itemType:ua.Wi.CONFIG,itemName:"pipe",context:t});return i.createElement(da,null,i.createElement(ca,{key:"pipe",name:"pipe",label:"Pipe host",items:[{label:"dev",value:"dev-pipe.deezerdev.com"},{label:"dirty",value:"pipe-dirty.preview-kube.deez.re"},{label:"prod",value:"pipe.deezer.com"}],currentValue:a,originalValue:n,onChange:e}))},ya=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=ma.default.get("host_messaging"),a=(0,Dn.CN)({itemType:ua.Wi.CONFIG,itemName:"messaging",context:t});return i.createElement(da,null,i.createElement(ca,{name:"messaging",label:"Messaging host",items:[{label:"dev",value:"messaging.deezerdev.com"},{label:"prod",value:"messaging.deezer.com"}],currentValue:a,originalValue:n,onChange:e}))};var ga=n("D/zM"),Aa=n("+pY+");const Ea=class{constructor(e){this._counter=void 0,this._counter=new ga.A({id:Aa.Ps.DEEZTOOLS,tags:{userId:String((0,T.F6)(z.A.getState().user)),...e}})}log(){this._counter.increment(),this._counter.send()}},va=({currentValue:e,label:t,name:n,onChange:a,originalValue:s,prefix:o})=>{const[l,c]=(0,i.useState)(void 0!==e?e:s),[d,u]=(0,i.useState)(l!==s),p=(0,i.useCallback)((()=>{""===l&&c(s);const e=l!==s;u(e),a&&e&&a(n,l)}),[l,n,a,s]),m=(0,r.A)(sa,{[ra]:l});return i.createElement("li",{className:aa},i.createElement("span",{className:m},t||n,i.createElement("span",{className:"cV2PF",title:d?"Modified":" "},d?"*":" ")),o?i.createElement("span",{className:la},o):null,i.createElement("input",{className:(0,r.A)(oa,"r8YPI"),onBlur:p,onChange:e=>c(e.target.value),onKeyUp:e=>{"Enter"===e.key&&p()},type:"text",value:String(l)}))},ba=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=(0,Dn.CN)({itemType:ua.Wi.CONFIG,itemName:"standalone",context:t})||"";return i.createElement(da,null,i.createElement(va,{currentValue:n,label:"Standalone",name:"standalone",onChange:(t,n)=>e(t,n),originalValue:"",prefix:"https://"}))},ka=()=>{const e=(0,Fn.useDeezToolsDispatch)(),t=(t,n)=>{e({type:ua.u3,item:{category:ua.Wi.CONFIG,name:t,value:n}}),new Ea({type:"config",name:t}).log()};return i.createElement(Xn,null,i.createElement(pa,{key:"media-service",onChange:t}),i.createElement(ha,{key:"pipe",onChange:t}),i.createElement(ya,{key:"messaging",onChange:t}),i.createElement(ba,{key:"standalone",onChange:t}))};var Ta,Ca,Sa=n("LOxp");const Ia=()=>{const e=(0,s.wA)(),t=(0,s.d4)((({user:e})=>(0,T.G8)(e))),n=(0,s.d4)((({user:e})=>(0,T.F6)(e))),a=(0,i.useCallback)(((a,i)=>(0,Sa.$)(`deezer://www.deezer.com/${i}`,{dispatch:e,lovedTracksId:t,userId:n})),[e,t,n]);return i.createElement(da,null,i.createElement(va,{currentValue:"",label:"Deeplink",name:"deeplink",onChange:a,originalValue:"",prefix:"deezer://www.deezer.com/"}),i.createElement("p",{className:"gIOHD"},"Press ",Ta||(Ta=i.createElement("strong",null,"enter"))," to open the deeplink (",Ca||(Ca=i.createElement("strong",null,"DO NOT"))," use the “Apply” button as it will reload the page)"))},wa=({name:e,label:t=e,onClick:n})=>i.createElement("li",{className:aa},i.createElement("span",{className:sa},e),i.createElement(ye.$n,{className:oa,variant:"outline",size:"sm",onClick:n},t));n("WpbS");var Pa=n("2oWs"),xa=n("UfUf"),Na=n("lWgj"),Ra=n("KBFD"),La=n("SLMx"),Oa=n("Sw64");const Da=new class{constructor(e,t){this._logCenter=void 0,this._userContext=void 0,this._logCenter=e,this._userContext=t}log(){const e=Object.entries(this._getPayload()).filter((([,e])=>void 0!==e)).reduce(((e,[t,n])=>Object.assign(e,{[t]:n})),{});this._logCenter.log((0,Oa.L)("playback.stream","1.0.0",e))}_getPayload(){const e=La.A.get(),{offer_id:t,user_id:n}=this._userContext.get();return{user_id:n,client_ip:e,offer_id:t,device_network:{type:Ra.T.LAN},media:{media_id:"1245679",encoding:Na.rv.name,media_type:xa.zu.SONG},created_at:Math.round(Date.now()/1e3),stream_context:{context_id:"2366228282",context_type:"playlist_page"},is_restricted:!1,is_synchronized:!0,listening_duration:280,listen_type:xa.lD.MOD,linked_devices:[{type:"input",device_type:"waze",name:"waze"},{type:"output",device_type:"bluetooth",name:"My_Radio"}],player:{player_version:"a_cool_player",seek_count:1,pause_count:0,previous:!1,next:!1,repeat_type:"repeat_all",is_shuffle:!1},linked_incident:"a_bloody_incident",stream_id:"5f107527-65b9-4be5-af2e-69268eb630e2",stream_session_id:"MyStreamSession"}}}(Un.A,Pa.It),Ma=()=>i.createElement(da,null,i.createElement(wa,{name:"Playlogs",label:"Create fake log",onClick:()=>Da.log()}),i.createElement(wa,{name:"Playlogs",label:"Create fake log and send to REC now",onClick:()=>{Da.log(),Un.A.flush()}}),i.createElement(wa,{name:"Playlogs",label:"media.format -> 'unknown'",onClick:()=>Be.Ay.setLogQuality("Unknown")}));var Ua=n("7ZZW"),Fa=n("4tze");const za=({name:e,label:t,currentValue:n,originalValue:a,onChange:s})=>{const[o,l]=(0,i.useState)(null!==n?n:a),[c,d]=(0,i.useState)(!1),u=(0,i.useCallback)((()=>{l(!o),s&&s(e,!o)}),[o,e,s]);(0,i.useEffect)((()=>{d(o!==a)}),[o,a]);const p=(0,r.A)(sa,{[ra]:o});return i.createElement("li",{className:aa},i.createElement(Ua.MJ,{onChange:u,display:"flex"},i.createElement(Fa.l,{className:p,htmlFor:t,mb:0},t),i.createElement(Te.s,null,c?i.createElement("span",{className:la},"Modified"):null,i.createElement(nn.d,{id:t,className:oa,isChecked:Boolean(o),size:"sm"}))))},qa=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=(0,Dn.CN)({itemType:ua.Wi.FEATURE,itemName:"ForceDecryptionError",context:t});return i.createElement(da,null,i.createElement(za,{key:"ForceDecryptionError",name:"ForceDecryptionError",label:"Force decryption error",currentValue:n,originalValue:!1,onChange:e}))},Ba=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=(0,Dn.CN)({itemType:ua.Wi.FEATURE,itemName:"ForceExplicit",context:t});return i.createElement(da,null,i.createElement(za,{key:"ForceExplicit",name:"ForceExplicit",label:"Force explicit covers",currentValue:n,originalValue:!1,onChange:e}))},Ga=()=>i.createElement(da,null,i.createElement(wa,{name:"Force send to REC",label:"Send to REC now",onClick:Un.A.flush})),Qa=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=(0,Dn.CN)({itemType:ua.Wi.FEATURE,itemName:"offline",context:t});return i.createElement(da,null,i.createElement(za,{key:"offline",name:"offline",label:"Electron mode",currentValue:n,originalValue:!0,onChange:e}))},Ha=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=(0,Dn.CN)({itemType:ua.Wi.FEATURE,itemName:"player-logger",context:t});return i.createElement(da,null,i.createElement(za,{key:"player-logger",name:"player-logger",label:"Player logger",currentValue:n,originalValue:!1,onChange:e}))},Va=({onChange:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=(0,Dn.CN)({itemType:ua.Wi.FEATURE,itemName:"rtl",context:t});return i.createElement(da,null,i.createElement(za,{key:"rtl",name:"rtl",label:"Right To Left mode",currentValue:n,originalValue:!0,onChange:(t,n)=>{e(t,n),document.querySelectorAll("link[rel=stylesheet]").forEach((e=>{e.href=n?e.href.replace(".css",".rtl.css"):e.href.replace(".rtl.css",".css"),document.body.classList.replace(n?"dir-ltr":"dir-rtl",n?"dir-rtl":"dir-ltr"),n?document.body.setAttribute("dir","rtl"):document.body.removeAttribute("dir")}))}}))};var Wa=n("pGqU");const Ya={action:"play",media_type:"song",media_id:"1",media_container:"deeztools",media_format:"FLAC",player_init:"0",drm_call:"0",track_fetch:"0",buffer:"0",total:"0",offer_id:"1",user_id:"1234"},ja=()=>i.createElement(da,null,i.createElement(wa,{name:"TTP",label:"Create fake TTP error log and send to REC now",onClick:()=>{new Wa.A(Ya).log(),Un.A.flush()}}));var Ka,$a,Ja,Xa;const Za=({updateUser:e})=>{const t=(0,Fn.useDeezToolsContext)(),n=(0,Fn.useDeezToolsDispatch)(),a=(e,t)=>{n({type:ua.nh,item:{category:ua.Wi.FEATURE,name:e,value:t}}),new Ea({type:"feature",name:e}).log()};return i.createElement(Xn,null,Ka||(Ka=i.createElement(Ia,null)),i.createElement(qa,{key:"forceDecryptionError",onChange:a}),i.createElement(Ba,{key:"forceExplicit",onChange:a}),$a||($a=i.createElement(Ga,{key:"ForceSendToREC"})),i.createElement(Qa,{key:"offline",onChange:a}),i.createElement(Va,{key:"rtl",onChange:(t,n)=>{a(t,n),e({DIRECTION:n?"rtl":"ltr"})}}),f.A.isAllowed("gapless_playback")||(0,Dn.CN)({itemType:ua.Wi.GATEKEEP,itemName:"gapless_playback",context:t})?i.createElement(Ha,{key:"player-logger",onChange:a}):null,Ja||(Ja=i.createElement(Ma,{key:"playlogs"})),Xa||(Xa=i.createElement(ja,{key:"timeToPlayError"})))},ei=JSON.parse('["activate_segment","ad_audio_break_vast_audio","ad_check_flag_show_is_advertising_allowed","ad_collect_rec_logs","ad_display_hubvisor","ad_force_video","adblock_bait_file","artist_page_albums_sorted_by_rank","artist_page_favorite_content","cdn_metrics","concerts_hub","contextual_menu_blindtest","curator_feature","curator_local","curator_partner","dark_mode","deeztools","disable_change_email","disable_change_password","dynamic_pages_sponsored_items","employee_feature","feature_2025_algo_settings","gapless_playback","gcast_force_beta","gender_nonbinary","kmp_queue_synchronizer","lyrics_report_problem","metric.api","metric.dynamic_content.item_clicked","metric.dynamic_content.play_clicked","metric.dynamic_content.screen_view","metric.dynamic_content.view_all_clicked","metric.dynamic_page_loading","metric.memoryusage","metric.playback_attempts","metric.remote_control","metric.timetoplay","playlist_assistant_end_of_tracklist","privacy_and_transfer_data_needed","public_api_album","public_api_onboarding","queue_synchronizer","reactivation_desktop_notification","remote_control","revamp2023","revamp_best_results","search_refacto_2024","sentry","talk","triforce_queuelist_messages","triforce_queuelist_ui","unlimited_favorite_tracks","unlimited_favorite_tracks_parallel_fetch","use_media_service","use_url_generation","volume_normalization"]'),ti=()=>{const e=(0,s.d4)((e=>e.user.__DZR_GATEKEEPS__)),t=(0,Fn.useDeezToolsDispatch)(),n=(0,Fn.useDeezToolsContext)(),a=(e,n)=>{t({type:ua.nh,item:{category:ua.Wi.GATEKEEP,name:e,value:n}}),new Ea({type:"gatekeep",name:e}).log()},r=(o=e,ei.reduce(((e,t)=>{var n;return{...e,[t]:null!==(n=o[t])&&void 0!==n&&n}}),{}));var o;const l=Object.keys(r).filter((e=>"deeztools"!==e)).map((e=>{const t=(0,Dn.CN)({itemType:ua.Wi.GATEKEEP,itemName:e,context:n});return i.createElement(za,{key:e,name:e,label:e,currentValue:t,originalValue:r[e],onChange:a})}));return i.createElement(Xn,null,l)},ni=()=>{const e={fastAds:!1,forceAdBlocker:!1},t=(e,t)=>{const n=new URLSearchParams(location.search);t?n.set(e,t.toString()):n.delete(e),d.A.push({pathname:location.pathname,search:n.toString()})},n=Object.keys(e).map((n=>{const a="true"===new URLSearchParams(location.search).get(n);return i.createElement(za,{key:n,name:n,label:n,currentValue:a,originalValue:e[n],onChange:t})}));return i.createElement(Xn,null,n)};let ai=function(e){return e.GATEKEEPS="gatekeeps",e.FEATURES="features",e.CONFIG="config",e.ADS="ads",e}({});var ii,si,ri;const oi=({tabId:e,updateUser:t})=>{switch(e){case ai.CONFIG:return i.createElement("div",{className:Yn},ii||(ii=i.createElement(ka,null)));case ai.GATEKEEPS:return i.createElement("div",{className:Yn},si||(si=i.createElement(ti,null)));case ai.FEATURES:return i.createElement("div",{className:Yn},i.createElement(Za,{updateUser:t}));case ai.ADS:return i.createElement("div",{className:Yn},ri||(ri=i.createElement(ni,null)));default:return i.createElement("div",{className:Yn},i.createElement($n.A,{className:"_wVkB",wording:"No content for the moment. Feel free to contribute!"}))}};var li,ci;const di=(0,be.A)((({updateUser:e})=>{const[t,n]=(0,i.useState)(ai.GATEKEEPS),a=e=>n(e.id),s=[{id:ai.GATEKEEPS,label:"Gatekeeps",action:a},{id:ai.FEATURES,label:"Features",action:a},{id:ai.CONFIG,label:"Config",action:a},{id:ai.ADS,label:"Ads",action:a}];return i.createElement(ke.A,{size:"lg"},i.createElement("div",{className:"popper-headings"},li||(li=i.createElement(Ce.D,{variant:"heading.m"},"DeezTools")),i.createElement("h5",{className:"heading-5-sub"},"Internal dev tools for Deezer",i.createElement("a",{href:"https://deezer.jira.com/l/c/2G1ZV1ha",target:"_blank",rel:"noreferrer"},i.createElement(On.u,{marginStart:"5px",display:"inline-block",boxSize:"14px",_hover:{color:"icon.neutral.secondary.hovered"}})))),i.createElement(Kn,{items:s,activeTab:t}),i.createElement(oi,{tabId:t,updateUser:e}),ci||(ci=i.createElement(Gn,null)))}));var ui=n("eTJY"),pi=n("5Loq");const mi={root:"slTcE",active:"sD9cd",pending:"riiP7"};var hi,yi;let gi=function(e){return e.IDLE="idle",e.PENDING="pending",e.ACTIVE="active",e}({});const Ai=({className:e})=>{const t=(0,Fn.useDeezToolsContext)(),[n,a]=(0,i.useState)(gi.IDLE);if((0,i.useEffect)((()=>{(0,Dn.zV)()&&!(0,Dn.sg)(t)?a(gi.ACTIVE):(0,Dn.sg)(t)?a(gi.PENDING):a(gi.IDLE)}),[t]),n===gi.IDLE)return null;const s=(0,r.A)(mi.root,mi[n],e);return i.createElement("span",{className:s,"aria-hidden":!0},n===gi.ACTIVE?hi||(hi=i.createElement(ui.S,{boxSize:"8px"})):yi||(yi=i.createElement(pi.j,{boxSize:"8px"})))};var Ei,fi=n("45ic");const _i=({updateUser:e})=>{if(!f.A.isAllowed("deeztools")||!(0,Dn.oz)())return null;const t={popperId:"topbar-deeztools",trigger:[yt.uW],delay:500,isDisabled:!1,className:"topbar-action",params:{updateUser:e}};return i.createElement(di,t,i.createElement(ye.K0,{className:"cBjIG","aria-label":"DeezTools",onClick:()=>{new Ea({type:"display"}).log()},size:"sm",variant:"ghost",icon:i.createElement(i.Fragment,null,Ei||(Ei=i.createElement(fi.Z,null)),i.createElement(Ai,{className:"JZsLk"}))}))};var vi,bi=n("CtJd"),ki=n("PN+J");const Ti=()=>f.A.isAllowed("employee_feature")?i.createElement(ki.m,{label:"Report a Bug","aria-label":"Report a Bug"},i.createElement(ye.K0,{"aria-label":"Report a bug",variant:"ghost",size:"small",icon:vi||(vi=i.createElement(bi.E,{boxSize:8})),onClick:()=>open("https://deezer.jira.com/servicedesk/customer/portal/7/create/128","_blank")})):null;var Ci,Si,Ii,wi,Pi,xi;const Ni=(0,s.Ng)((({user:e})=>({isUserConnected:(0,T.UJ)(e),user:e})),(e=>({updateUser:t=>e((0,C.b6)(t))})))((({isUserConnected:e,user:t,updateUser:n})=>i.createElement("div",{className:"page-topbar",id:"page_topbar"},e?i.createElement(i.Fragment,null,Ci||(Ci=i.createElement(ft,null)),Si||(Si=i.createElement(Ti,null)),i.createElement(_i,{updateUser:e=>n({...t,...e})}),Ii||(Ii=i.createElement(In,null)),wi||(wi=i.createElement(Bt,null)),Pi||(Pi=i.createElement(un,null))):xi||(xi=i.createElement(Ln,null)))));var Ri,Li;const Oi=i.lazy((()=>Promise.all([n.e(1154),n.e(5745)]).then(n.bind(n,"Fs/P")))),Di=i.lazy((()=>Promise.all([n.e(1154),n.e(7696)]).then(n.bind(n,"lj5y")))),Mi=()=>(0,s.d4)((e=>null==e?void 0:e.user.id))>0?Ri||(Ri=i.createElement(Di,null)):Li||(Li=i.createElement(Oi,null));var Ui=n("y7Wb"),Fi=n("HvqQ"),zi=n("fkXJ"),qi=n("UAd1");let Bi;function Gi(e){document.body.offsetHeight<window.innerHeight?document.body.classList.remove("has-scrollbar-disabled"):(e||(Bi=window.pageYOffset),document.body.classList.toggle("has-scrollbar-disabled",!e),e&&window.scrollTo(0,Bi))}var Qi,Hi=n("yCtO"),Vi=n("hsEi"),Wi=n("7Gye"),Yi=n("W1Rt"),ji=n("1lpQ"),Ki=n("xvdY"),$i=n("iuq8"),Ji=n("I7+f"),Xi=n("ATrE"),Zi=n("a9NY"),es=n("1Uwb"),ts=n("lXQd"),ns=n("CxZw"),as=n("o+h5"),is=n("1Pdy"),ss=n("xCFc"),rs=n("pQlO"),os=n("r4LN");const ls=({ariaLabel:e,isDisabled:t=!1,onClick:n})=>i.createElement(ye.K0,{"aria-label":e,icon:Qi||(Qi=i.createElement(Ee.w,null)),isDisabled:t,onClick:n,size:"sm",variant:"link"});var cs=n("pWdF"),ds=n("STEc");const us={TITLE:{SIZE:ds.uq.Full},ARTIST:{SIZE:ds.uq.PercentXs},DURATION:{SIZE:ds.uq.sm},REMOVE:{SIZE:ds.uq.sm}};var ps,ms,hs=n("tgyz"),ys=n("SehT");const As=i.memo((({data:e,index:t,style:n})=>{const a=e.toDisplay[t],{context:s,container:r,isOrderable:o,loadingStatus:l,options:c,shouldExplicitBeHidden:d}=i.useContext(ss.Gt),{play:u,playerStatus:p,playQueuelistAtIndex:m,isItemLoadedInPlayer:h,removeTrack:y}=(0,hs.A)({...s,ID:a.item.id},r,l.isFullyFetched,!0),g=a.item.hasExplicitLyrics&&d,A=(e,t)=>{m(e,t)},E=(0,i.useCallback)((t=>{u({notify:!1,playIndex:t,playItems:e.toPlay,playLyrics:!0})}),[e.toPlay,u]);return i.createElement(es.A.Row,{style:n,uuid:a.uuid,id:a.item.id,index:t,isActive:h(a.item)&&p.isSameContext,isOrderable:o,isReadable:a.item.right===ns.A.READABLE,isRestrictedByExplicit:g,type:a.item.type,isDraggable:!0},i.createElement(cs.A,{size:us.TITLE.SIZE},i.createElement(cs.A.Play,{ariaLabel:(0,X.AP)("generic_action_playsongXbyartistX_web",{sprintf:[a.item.title,(0,ts.A)(a,"item.artists[0].name","")]}),hasExplicitCover:a.item.parent.hasExplicitCover,onPlayItems:A,pictureUrl:a.item.cover(as.r4).url}),ps||(ps=i.createElement(cs.A.Download,null)),i.createElement(cs.A.PlayableLabel,{hasExplicitLyrics:a.item.hasExplicitLyrics,label:a.item.title,onPlayItems:A,tooltipText:(0,ys.Y)(a.item,d)}),i.createElement(es.A.IconGroup,null,i.createElement(cs.A.ShowLyrics,{item:a.item,lyricsId:a.item.lyricsId,onPlayLyrics:E}),ms||(ms=i.createElement(cs.A.AddToFavorite,null)),i.createElement(cs.A.OpenContextMenu,{item:a.item}))),i.createElement(es.A.CellBody,{size:us.ARTIST.SIZE},i.createElement(os.A,{links:a.item.artists.map((e=>({...e,type:Ne.Ay.Artist})))})),i.createElement(es.A.CellBody,{size:us.DURATION.SIZE},i.createElement(rs.A,{duration:a.item.duration})),c.includes(is.Rj.Remove)&&i.createElement(es.A.CellBody,{size:us.REMOVE.SIZE},i.createElement(ls,{ariaLabel:(0,X.AP)("Retirer de la file d'attente"),isDisabled:0===t&&1===e.toDisplay.length,onClick:()=>y(t)})))}),Rt.t7);var Es=n("ftFY"),fs=n("EBWn"),_s=n("ijnh");const vs=({indexToScrollTo:e,height:t=0,items:n,options:a=[],onUpdateTracklistOrder:s,scrollAlignment:r,shouldExplicitBeHidden:o})=>{const l={id:"0",type:_s.k},c={ID:l.id,TYPE:l.type},{manageItems:d,tableItems:u}=(0,Es.A)("0",n,c,{generateId:e=>`${e.id}-${(0,ts.A)(e,"legacy.TRACK_NUMBER","")}`}),{playerStatus:p}=(0,hs.A)(c,l,!0,!0),m=(0,fs.A)("0",u,c,s),h=i.useRef(null),y=i.useRef(null),g=(0,ss.Ay)({container:l,context:c,hasBackground:!1,options:a,manageItems:d,order:m,playerStatus:p,shouldExplicitBeHidden:o,shouldPlayerNeverBeHid:!0});return(0,i.useEffect)((()=>{var t;h&&(null===(t=h.current)||void 0===t||t.scrollToItem(e,r))}),[]),i.createElement(ss.ru,{value:g},i.createElement(es.A,{tableRef:y,rowCount:u.toDisplay.length},i.createElement(es.A.Body,null,i.createElement(Rt.Y1,{height:t,itemCount:u.toDisplay.length,itemData:u,itemSize:is.F4.md,ref:h,width:"100%"},As))))},bs={TITLE:{SIZE:ds.uq.Full},DURATION:{SIZE:ds.uq.sm},REMOVE:{SIZE:ds.uq.sm}};var ks;const Cs=i.memo((({data:e,index:t,style:n})=>{const a=e.toDisplay[t],{context:s,container:r,loadingStatus:o,isOrderable:l,shouldExplicitBeHidden:c}=i.useContext(ss.Gt),{playerStatus:d,playQueuelistAtIndex:u,isItemLoadedInPlayer:p,removeTrack:m}=(0,hs.A)({...s,ID:a.item.id},r,o.isFullyFetched,!0),h=a.item.hasExplicitLyrics&&c,y=(e,t)=>{u(e,t)};return i.createElement(es.A.Row,{style:n,uuid:a.uuid,id:a.item.id,index:a.index,isActive:p(a.item)&&d.isSameContext,isOrderable:l,isReadable:a.item.right===ns.A.READABLE,isRestrictedByExplicit:h,type:a.item.type},i.createElement(cs.A,{size:bs.TITLE.SIZE},i.createElement(cs.A.Play,{ariaLabel:(0,X.AP)("generic_action_playsongXbyartistX_web",{sprintf:[a.item.title,a.item.parent.name]}),hasExplicitCover:a.item.parent.hasExplicitCover,onPlayItems:y,pictureUrl:a.item.cover(as.r8).url}),ks||(ks=i.createElement(cs.A.Download,null)),i.createElement(cs.A.PlayableLabel,{description:a.item.description,hasExplicitLyrics:a.item.hasExplicitLyrics,label:a.item.title,onPlayItems:y,tooltipText:(0,ys.Y)(a.item,c)}),i.createElement(es.A.IconGroup,null,i.createElement(cs.A.OpenContextMenu,{item:a.item}))),i.createElement(es.A.CellBody,{size:bs.DURATION.SIZE},i.createElement(rs.A,{duration:a.item.duration})),i.createElement(es.A.CellBody,{size:bs.REMOVE.SIZE},i.createElement(ls,{ariaLabel:(0,X.AP)("Retirer de la file d'attente"),isDisabled:0===t&&1===e.toDisplay.length,onClick:()=>m(t)})))}),Rt.t7),Ss=({height:e=0,indexToScrollTo:t,items:n,options:a=[],onUpdateTracklistOrder:s,scrollAlignment:r,shouldExplicitBeHidden:o})=>{const l={id:"0",type:_s.k},c={ID:l.id,TYPE:l.type},{manageItems:d,tableItems:u}=(0,Es.A)("0",n,c),{playerStatus:p}=(0,hs.A)(c,l,!0,!0),m=is.F4.lg,h=(0,fs.A)("0",u,c,s),y=i.useRef(null),g=i.useRef(null),A=(0,ss.Ay)({container:l,context:c,hasBackground:!1,options:a,manageItems:d,order:h,playerStatus:p,rowHeight:m,shouldExplicitBeHidden:o,shouldPlayerNeverBeHid:!0});return(0,i.useEffect)((()=>{var e;y&&(null===(e=y.current)||void 0===e||e.scrollToItem(t,r))}),[]),i.createElement(ss.ru,{value:A},i.createElement(es.A,{tableRef:g,rowCount:u.toDisplay.length},i.createElement(es.A.Body,null,i.createElement(Rt.Y1,{height:e,itemCount:u.toDisplay.length,itemData:u,itemSize:m,ref:y,width:"100%"},Cs))))},Is=({indexToScrollTo:e,items:t,itemsType:n,options:a=[],onUpdateTracklistOrder:s,scrollAlignment:r="end",shouldExplicitBeHidden:o})=>{const{height:l}=(0,Zi.A)(),c=(l||0)-216;return n===Ne.Ay.Episode?i.createElement(Ss,{height:c,indexToScrollTo:e,items:t,options:a,onUpdateTracklistOrder:s,scrollAlignment:r,shouldExplicitBeHidden:o}):i.createElement(vs,{indexToScrollTo:e,height:c,items:t,options:a,onUpdateTracklistOrder:s,scrollAlignment:r,shouldExplicitBeHidden:o})};var ws=n("sAMA");class Ps extends i.Component{constructor(e){super(e),this._updateTracklistOrder=this._updateTracklistOrder.bind(this),this._getNbTracksToDisplay=this._getNbTracksToDisplay.bind(this),this.state={nbDisplayTracks:1e4}}render(){const{index:e,isRadio:t,maxPlayedIndex:n,shouldExplicitBeHidden:a,uiType:s}=this.props,r=[is.Rj.Reorder];return t||r.push(is.Rj.Remove),i.createElement("div",{className:"queuelist-tracklist-inner"},i.createElement(Is,{indexToScrollTo:t?n+1:e,items:this._getListToRender(),itemsType:s===Ne.Ay.Podcast||s===Ne.Ay.Show?Ne.Ay.Episode:Ne.Ay.Song,onUpdateTracklistOrder:this._updateTracklistOrder,options:r,ref:this._tracklistRef,shouldExplicitBeHidden:a,scrollAlignment:t?"end":"start"}))}_getNbTracksToDisplay(){const{isRadio:e,maxPlayedIndex:t}=this.props,{nbDisplayTracks:n}=this.state;return e?t+1:n}_getListToRender(){const{list:e}=this.props;return e.slice(0,this._getNbTracksToDisplay())}_updateTracklistOrder(e){const{list:t}=this.props;if(!e||!e.order||!Array.isArray(e.order))return;const n=t.slice(this._getNbTracksToDisplay()-1,t.length-1);Be.Ay.orderTracks([...e.order,...n])}}const xs={dispatchHidePopper:B.Lm},Ns=(0,s.Ng)((e=>({userID:e.user.id,shouldExplicitBeHidden:(0,T.Uw)(e.user)===ws.g,list:e.player.music.list,index:e.player.music.index,maxPlayedIndex:e.player.music.maxPlayedIndex,isRadio:e.player.config.isRadio,playerUI:(0,Xi.Cu)(e),uiType:(0,Xi.ip)(e)})),xs)(Ps);class Rs extends i.Component{constructor(e){super(e),this._onUpNextToggle=this._onUpNextToggle.bind(this)}shouldComponentUpdate(e){return this.props.isUpnext!==e.isUpnext||this.props.hasUpNext!==e.hasUpNext}render(){const{isAuth:e,isUpnext:t,playerUI:n,hasUpNext:a}=this.props;return e&&(n.upnext||t)?i.createElement("div",{className:"queuelist-upnext-heading"},i.createElement("span",{className:"queuelist-title"},(0,X.AP)("Recommandations automatiques")),i.createElement(nn.d,{isChecked:a,onChange:this._onUpNextToggle,ms:2,"data-testid":"automatic_reco_switch_"+(a?"on":"off")})):null}_onUpNextToggle(e){const t=e.currentTarget.checked;this.props.updateSettings({global:{has_up_next:t}})}}const Ls=(0,s.Ng)((e=>({isAuth:e.user.isAuth,hasUpNext:e.user.hasUpNext,isUpnext:e.player.config.isUpnext,playerUI:(0,Xi.Cu)(e)})),{updateSettings:C.Xx})(Rs);var Os=n("BL4K"),Ds=n("SY8E"),Ms=n("phrf"),Us=n("YxJ6"),Fs=n("2pes"),zs=n("7fl8"),qs=n("00Ii"),Bs=n("+Sva");const Gs=({children:e,onClick:t})=>i.createElement(Te.s,{alignItems:"center",onClick:t,borderRadius:"s",color:"text.neutral.secondary.default",fontSize:"body.m",height:"40px",lineHeight:"40px",paddingX:"spacing.m",width:"100%",transition:"background-color 0.15s, color 0.15s",_hover:{backgroundColor:"background.neutral.tertiary.hovered",color:"text.neutral.primary.default",cursor:"pointer"}},e),Qs=({children:e})=>i.createElement(ze.E,{noOfLines:1,display:"flex",flex:1},e);var Hs=n("UDcE"),Vs=n("gtRZ");const Ws=({children:e})=>i.createElement(te.a,{as:"span",marginEnd:"spacing.s"},e);var Ys,js;const Ks=({onClick:e,tuner:t})=>{const n=(0,i.useCallback)((()=>{const n="default"!==t?"default":"discovery",a=Be.Ay.getContext(),i=ma.default.get("log_contexts")[a.TYPE]===Ne.Ay.Flow;Be.Ay.play({type:i?qe.Kk.USER:qe.Kk.MULTI_FLOW,id:a.ID,radio:!0,tuner:n,context:a}),null==e||e()}),[e,t]),a={default:{icon:Ys||(Ys=i.createElement(Hs.A,{size:"medium"})),text:(0,X.AP)("flowsettings_text_iwantmorediscoveries_web")},discovery:{icon:js||(js=i.createElement(Vs.M,{size:"medium"})),text:(0,X.AP)("flowsettings_text_iwantmorefavorites_web")}},s=e=>(0,ts.A)(a,`[${t}].[${e}]`);return i.createElement(Gs,{onClick:n},i.createElement(Ws,null,s("icon")),i.createElement(Qs,null,s("text")))};var $s,Js=n("WN1e");const Xs=({onClick:e})=>{const[t]=(0,s.d4)((e=>[(0,T.F6)(e.user)])),n=Be.Ay.getContext(),a=(0,i.useCallback)((()=>{Be.Ay.play({type:qe.Kk.USER,id:t,radio:!0,context:n}),e&&e()}),[e,t,n]);return i.createElement(Gs,{onClick:a},$s||($s=i.createElement(Ws,null,i.createElement(Js.R,{size:"medium"}))),i.createElement(Qs,null,(0,X.AP)("flowsettings_action_changestyle_web")))};var Zs,er,tr=n("SF1U"),nr=n("elFM"),ar=n("olBe");const ir=({context:e,id:t,onClick:n})=>{const{isBannedFromRecommendation:a,toggleDislike:s}=(0,ar.A)(t,e),r=(0,i.useCallback)((()=>{s(),null==n||n()}),[n,s]),o=a?Zs||(Zs=i.createElement(tr.e,null)):er||(er=i.createElement(nr.z,null)),l=a?(0,X.AP)("banartist_action_allowinmyrecommendations_web"):(0,X.AP)("bantrack_action_dontrecommendthistrack_web");return i.createElement(Gs,{onClick:r},i.createElement(Ws,null,o),i.createElement(Qs,null,l))};var sr,rr,or=n("03m0"),lr=n("lb8X"),cr=n("BCMr");const dr=({onClick:e})=>{const{isBannedFromRecommendation:t,toggleDislike:n}=(0,cr.A)(),a=(0,i.useCallback)((()=>{n(),null==e||e()}),[e,n]),s=t?sr||(sr=i.createElement(or.x,null)):rr||(rr=i.createElement(lr.G,null)),r=t?(0,X.AP)("banartist_action_allowinmyrecommendations_web"):(0,X.AP)("banartist_action_dontrecommendthisartist_web");return i.createElement(Gs,{onClick:a},i.createElement(Ws,null,s),i.createElement(Qs,null,r))};var ur,pr;const mr={[we.B1A.DEFAULT]:"default",[we.B1A.DISCOVERY]:"discovery"},hr=({artistId:e,context:t,onClose:n,trackId:a})=>{var r;const o=(0,s.d4)((({user:e})=>(0,T.H3)(e))),l=(0,s.wA)(),{data:c}=(0,we.UJq)({skip:Boolean(o)});(0,i.useEffect)((()=>{var e;if(!o&&null!=c&&null!==(e=c.me)&&void 0!==e&&null!==(e=e.flowTuner)&&void 0!==e&&e.discoveryTuner){const e=mr[c.me.flowTuner.discoveryTuner];l((0,C.mZ)("tuner",e))}}),[null==c||null===(r=c.me)||void 0===r||null===(r=r.flowTuner)||void 0===r?void 0:r.discoveryTuner,l,o]);const d=ma.default.get("log_contexts")[t.TYPE]===Ne.Ay.Flow,u=ma.default.get("log_contexts")[t.TYPE]===Ne.Ay.MultiFlow,p=d||u,m=o&&p;return i.createElement(i.Fragment,null,i.createElement(qs.D,null,i.createElement(ze.E,{fontSize:"body.m"},p?(0,X.AP)("flowsettings_title_notsatisfiedwithyourflow_web"):(0,X.AP)("banfeatures_title_nothappywithyourmix_web"))),i.createElement(Bs.T,{spacing:"spacing.s",marginTop:"spacing.s"},m&&i.createElement(Ks,{tuner:o,onClick:n}),d&&i.createElement(Xs,{onClick:n}),i.createElement(ir,{context:t,id:a,onClick:n}),"0"!==e&&i.createElement($e.OJ,{key:e,value:{item:Ne.Ay.Artist,itemId:e,legacyContext:t}},i.createElement(dr,{onClick:n})),!d&&i.createElement(Zt.A,null,i.createElement(He.A,{to:"/channels/mixes",width:"100%"},i.createElement(Gs,{onClick:n},i.createElement(Qs,null,(0,X.AP)("banfeatures_title_changemood_web")),ur||(ur=i.createElement(en.A,null))))),i.createElement(Zt.A,null,i.createElement(He.A,{to:"/exclusions",width:"100%"},i.createElement(Gs,{onClick:n},i.createElement(Qs,null,(0,X.AP)("banfeatures_action_managemyexclusions_web")),pr||(pr=i.createElement(en.A,null)))))))};var yr,gr;const Ar=({artistId:e,trackId:t,placement:n="top"})=>{const[a,s]=(0,i.useState)(!1),r=()=>s(!1),{context:o,isRadio:l,playerUI:c}=(0,ve.G)((e=>({context:e.player.music.context,isRadio:e.player.config.isRadio,playerUI:(0,Xi.Cu)(e)})));if(!c.userFeedback||!o.TYPE||!l&&ma.default.get("log_contexts")[o.TYPE]!==Ne.Ay.Smarttracklist)return null;const d=ma.default.get("log_contexts")[o.TYPE]===Ne.Ay.Flow||ma.default.get("log_contexts")[o.TYPE]===Ne.Ay.MultiFlow?(0,X.AP)("flowsettings_title_notsatisfiedwithyourflow_web"):(0,X.AP)("banfeatures_title_nothappywithyourmix_web"),u={artistId:e,context:o,trackId:t,onClose:r};return i.createElement(Ds.A,{isLazy:!0,isOpen:a,onOpen:()=>s(!0),onClose:r,placement:n},i.createElement(Ms.W,null,i.createElement(te.a,null,i.createElement(ki.m,{isDisabled:a,label:d},i.createElement(ye.K0,{"data-testid":"angry_face_button",variant:"ghost",isActive:a,_active:{color:"icon.accent.primary.default",bg:"transparent"},"aria-label":d,size:"small",icon:yr||(yr=i.createElement(Os.V,null))})))),i.createElement(Us.h,{maxWidth:"400px",width:"auto"},gr||(gr=i.createElement(Fs.R,null)),i.createElement(i.Suspense,{fallback:null},i.createElement(zs.e,{p:"spacing.m"},i.createElement(hr,u)))))};var Er=n("Vsul"),fr=n("CyAC"),_r=n("VwKc"),vr=n("Vzbh");const br=({playerUI:{title:e},track:t})=>e&&e.url&&e.id&&Number(t[e.id])&&t.RIGHTS&&Object.entries(t.RIGHTS).length>0?e.url+t[e.id]:null,kr=({playerUI:{subTitle:e}},{ART_ID:t=0})=>e&&e.url&&Number(t)?e.url+t:null;var Tr,Cr,Sr,Ir,wr,Pr,xr,Nr,Rr,Lr=n("Qmjy");class Or extends i.Component{constructor(e){super(e),this._onPlayerClose=this._onPlayerClose.bind(this),this._onLyricsClick=this._onLyricsClick.bind(this)}render(){return i.createElement("div",{className:"player-wrapper player-queuelist"},this._renderHeader(),this._renderContainer())}_renderHeader(){return i.createElement("div",{className:"player-header"},i.createElement("div",{className:"player-close"},i.createElement(ki.m,{label:(0,X.AP)("Fermer"),position:"bottom"},i.createElement("button",{className:"svg-icon-group-btn",type:"button",onClick:this._onPlayerClose,"aria-label":(0,X.AP)("generic_action_closepanel_web")},Tr||(Tr=i.createElement(Hi.e,null))))))}_renderContainer(){return i.createElement("div",{className:"player-container"},this._renderCover(),this._renderContent())}_renderCover(){return i.createElement("div",{className:"queuelist-cover"},this._renderCoverPicture(),this._renderCoverActions(),this._renderCoverTitle(),this._renderCoverSubTitle(),this._renderLabel())}_renderCoverPicture(){const{cover:e,isExplicitCover:t,trackTitle:n}=this.props;return i.createElement(te.a,{position:"relative",width:"100%"},i.createElement(Ge.A,{src:e,alt:n,isExplicitCover:t}),this._renderCoverExplicit(),this._renderCoverSticker())}_renderLabel(){const{isFlow:e,isUpnext:t,playerUI:n,uiType:a}=this.props;if(!n.label)return null;let s=(0,X.AP)("MIX");return a===Ji.U.AD||a===Ji.U.TRITON_AD?s=(0,X.AP)("PUBLICITÉ"):a===Ji.U.LIVESTREAM?s=(0,X.AP)("EN DIRECT"):t?s=(0,X.AP)("RECOMMANDÉ"):e&&(s=(0,X.AP)("FLOW")),i.createElement("span",{className:"queuelist-cover-label"},i.createElement("span",{className:"label"},s))}_renderCoverTitle(){const{trackTitle:e,uiType:t}=this.props;let n=e;if(t===Ji.U.AD){const e=window.sasAudioConfig||{},t=e.text,a=decodeURIComponent(e.url),s=e=>{e.preventDefault(),e.stopPropagation(),/^http/.test(a)&&(0,Er.A)(a)};n=i.createElement("a",{className:"queuelist-cover-link",href:a,onClick:s},t)}else null!==br(this.props)&&(n=i.createElement(He.A,{className:"queuelist-cover-link",to:br(this.props)},e));return i.createElement("div",{className:"queuelist-cover-title"},this._renderExplicit(),n)}_renderCoverSubTitle(){const{trackArtists:e,uiType:t}=this.props;return t===Ji.U.AD?null:i.createElement("div",{className:"queuelist-cover-subtitle"},e.map(((e,t)=>[t>0?", ":"",null===kr(this.props,e)?e.ART_NAME:i.createElement(He.A,{className:"queuelist-cover-link",key:e.ART_ID,to:kr(this.props,e)},e.ART_NAME)])))}_renderExplicit(){return this.props.isExplicit?Cr||(Cr=i.createElement(ji.A,{size:"small",me:"spacing.s"})):null}_renderCoverExplicit(){const{shouldHideCoverForUser:e}=this.props;return e?null:this.props.isExplicit?Sr||(Sr=i.createElement("div",{className:"explicit-container"},i.createElement(ji.A,null))):null}_renderCoverSticker(){const{audioQuality:e}=this.props;let t;switch(e){case vr.en.LOSSLESS:t=(0,X.AP)("HiFi");break;case vr.en.HIGH:t="HQ";break;default:return null}return i.createElement("span",{className:"queuelist-cover-sticker sticker"},t)}_renderCoverActions(){return i.createElement("div",{className:"queuelist-cover-actions"},i.createElement("ul",{className:"svg-icon-group"},this._renderActionLyrics(),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionContextMenu("addToPlaylist")),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionLike()),this._renderActionUserFeedback(),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionContextMenu())))}_renderActionLyrics(){const{playerUI:e,isOnline:t}=this.props;if(!e.lyrics||!this.props.hasLyrics||!t)return null;const n=(0,X.AP)("Afficher les paroles");return i.createElement("li",{className:"svg-icon-group-item"},i.createElement(ki.m,{label:n},i.createElement("button",{className:"svg-icon-group-btn",type:"button",onClick:this._onLyricsClick,"aria-label":n},Ir||(Ir=i.createElement(Vi.c,null)))))}_renderActionLike(){const{playerUI:e,id:t,track:n}=this.props;if(!e.like)return null;const a=String(n.SNG_ID_ORIGIN||t);return i.createElement(Ki.A,{className:"svg-icon-group-btn",type:"song",context:{ID:a,TYPE:"player",CONTEXT_ID:n.SPONSORED?"sponsored=true":void 0},tooltip:!0,id:a})}_renderActionContextMenu(e){const{track:t,index:n,id:a,context:s,playerUI:r,userId:o}=this.props;if(!r.contextMenu)return null;const l="addToPlaylist"===e,c={anchor:i.createElement("button",{className:"svg-icon-group-btn",type:"button"},l?wr||(wr=i.createElement(Wi.c,null)):Pr||(Pr=i.createElement(pi.j,null))),context:{ID:o,TYPE:"queuelist"},data:{INDEX:n,SONG:t,PLAYLIST_ID:s.ID},forceShowPlaylists:l,id:a,placement:"right"};return i.createElement($i.A,c)}_renderActionUserFeedback(){const{id:e,track:t,trackArtists:n}=this.props,s={artistId:n.length>0?n[0].ART_ID:"0",trackId:String(t.SNG_ID_ORIGIN||e)};return i.createElement(Ar,(0,a.A)({placement:"right"},s))}_renderContent(){return i.createElement("div",{className:"queuelist-content"},i.createElement("div",{className:"queuelist-header"},i.createElement("div",{className:"queuelist-heading"},this._renderTitle(),this._renderSubTitle()),xr||(xr=i.createElement(Ls,null)),this._renderSaveAsPlaylist()),Nr||(Nr=i.createElement(Ns,null)))}_renderTitle(){const{isRadio:e,isFlow:t,isUpnext:n}=this.props;let a=(0,X.AP)("File d'attente");return e&&!n&&(a=t?(0,X.AP)("Derniers titres écoutés sur Flow"):(0,X.AP)("Derniers titres écoutés dans le mix")),i.createElement("span",{className:"queuelist-title"},a)}_renderSubTitle(){const{list:e,isRadio:t,tracklistDuration:n}=this.props;if(t)return null;const a=(0,X.WI)("%s titre","%s titres",{sprintf:[(0,tt.A)(e.length)],count:e.length});return i.createElement("span",{className:"queuelist-subtitle"}," ","· ",a," · ",(0,Lr.A)(n))}_renderSaveAsPlaylist(){const{saveAsPlaylist:e}=this.props.playerUI,{list:t,userId:n}=this.props;if(!e)return null;const a=this._getTrack(),s=1===a.length?{SONG:t[0]}:{},r={anchor:i.createElement(ye.K0,{"aria-label":(0,X.AP)("Ajouter à une playlist"),size:"sm",icon:Rr||(Rr=i.createElement(Yi.G,null))}),context:{ID:n,TYPE:"queuelist"},data:s,forceShowPlaylists:!0,id:a};return i.createElement($i.A,r)}_onPlayerClose(){this.props.setPlayerFull(!1)}_onLyricsClick(){this.props.playerLyrics?this.props.setPlayerFull(!1):this.props.setPlayerLyrics(!0),Be.Ay.isPaused()||Be.Ay.isPlaying()||Be.Ay.control.play()}_getTrack(){const{isUpnext:e,isRadio:t,list:n,maxPlayedIndex:a}=this.props;let i=n;return(t||e)&&(i=i.slice(0,a+1)),[...new Set(i.map((e=>e.SNG_ID||e.UPLOAD_ID)))]}}const Dr=(0,s.Ng)((e=>({id:e.player.music.id,track:e.player.music.track,list:e.player.music.list,index:e.player.music.index,context:e.player.music.context,isExplicit:e.player.music.isExplicit,isExplicitCover:(0,fr.cV)(e.player.music.track),maxPlayedIndex:e.player.music.maxPlayedIndex,tracklistDuration:e.player.music.tracklistDuration,trackTitle:e.player.music.trackTitle,trackArtists:e.player.music.trackArtists,shouldHideCoverForUser:(0,fr.vp)(e.user,e.player.music.track),cover:e.player.music.cover,isRadio:e.player.config.isRadio,isFlow:e.player.config.isFlow,isUpnext:e.player.config.isUpnext,playerLyrics:e.player.config.playerLyrics,userId:e.user.id,isOnline:e.app.online,hasLyrics:(0,_r.jk)(e),playerUI:(0,Xi.Cu)(e),uiType:(0,Xi.ip)(e),audioQuality:(0,_r.iQ)(e)})),{setPlayerFull:qi.no,setPlayerLyrics:qi.IG})(Or),Mr=({player:e})=>({backgroundColor:e.ui.backgroundColor,isLightMode:e.ui.isLightMode}),Ur=e=>{const t=(0,s.d4)((e=>(0,T.mS)(e.user))),n=(0,s.d4)((e=>(0,T.gE)(e.user)));return(0,i.useCallback)((a=>{const i="lyrics";(0,gn.isLogCentralWhitelisted)(i)||v.A.warn(`log_central is deprecated. "${i}" is not a whitelisted event.`);const s={...a,sng:e,container:"panel",ts:(0,T.mI)({SERVER_TIMESTAMP:t,clientTimestampDelta:n})};return bt.A.call({method:"log_central.log",data:{BATCH:[{channel:i,params:s}]}}),!0}),[n,t,e])};let Fr=function(e){return e.SYNCHRO="synchro",e.FULL_TEXT="full_text",e}({}),zr=function(e){return e.PANEL="panel",e.PAGE_TRACK="page_track",e}({}),qr=function(e){return e.DISPLAY="display",e.DISPLAY_NEXT="display_next",e.CLICK_TRANSLATE="click_translate",e.CLICK_UNTRANSLATE="click_untranslate",e.CLICK_SHARE="click_share",e.CLICK_CLOSE="click_close",e.CLICK_REPORT_PROBLEM="click_report_problem",e.CLICK_CONFIRM_PROBLEM="click_confirm_problem",e}({}),Br=function(e){return e.PROBLEM_SYNCHRONIZATION="problem_synchronization",e.PROBLEM_MATCHING="problem_matching",e.PROBLEM_LANGUAGE="problem_language",e.PROBLEM_TYPO="problem_typo",e.PROBLEM_TRANSLATION="problem_translation",e}({}),Gr=function(e){return e.NO_LYRICS="no_lyrics",e.ERROR="error",e}({});const Qr={trackId:"",lyricsWordByWord:[],lyricsLineByLine:[],lyricsUnsynchronized:[],lyricsTranslated:[],backgroundColor:"background.neutral.primary.default",isLightMode:!0,isLoading:!1,hasError:!1,hasLyrics:!1,hasSync:!1,hasTranslation:!1,timeToFirstLyric:0,copyright:"",writers:"",showTranslation:!1,toggleTranslation:()=>{},showLyricsInHeader:!1,setShowLyricsInHeader:()=>{},currentIndexLine:0,setCurrentIndexLine:()=>{},currentLineRef:i.createRef(),setCurrentLineRef:()=>{},isUserScrolling:!1,setIsUserScrolling:()=>{}},Hr=(0,i.createContext)(Qr),Vr=()=>(0,i.useContext)(Hr),Wr=({children:e})=>{const{trackId:t,backgroundColor:n,isLightMode:a}=(0,ve.G)((e=>({...Mr(e),trackId:e.player.music.id}))),[s,r]=(0,i.useReducer)(((e,t)=>{switch(t.type){case"SET_IS_USER_SCROLLING":return{...e,isUserScrolling:t.payload};case"SET_SHOW_LYRICS_IN_HEADER":return{...e,showLyricsInHeader:t.payload};case"SET_CURRENT_INDEX_LINE":return{...e,currentIndexLine:t.payload};case"SET_CURRENT_LINE_REF":return{...e,currentLineRef:t.payload};default:return e}}),{isUserScrolling:!1,showLyricsInHeader:!1,currentIndexLine:0,currentLineRef:i.createRef()}),o=e=>{r({type:"SET_IS_USER_SCROLLING",payload:e})},l=e=>{r({type:"SET_SHOW_LYRICS_IN_HEADER",payload:e})},c=e=>{r({type:"SET_CURRENT_INDEX_LINE",payload:e})},d=e=>{r({type:"SET_CURRENT_LINE_REF",payload:e})},[u,p]=(0,i.useState)(Qr.showTranslation),m=()=>{p(!u)},h=(0,i.useRef)(!0),y=Ur(t),{loading:g,data:A,error:E}=(0,we.Ypw)({variables:{trackId:t},onCompleted:e=>{var t,n;y(e?{action:{type:h.current?qr.DISPLAY:qr.DISPLAY_NEXT},type:null!==(t=e.track)&&void 0!==t&&null!==(t=t.lyrics)&&void 0!==t&&t.synchronizedLines||null!==(n=e.track)&&void 0!==n&&null!==(n=n.lyrics)&&void 0!==n&&n.synchronizedWordByWordLines?Fr.SYNCHRO:Fr.FULL_TEXT}:{action:{type:h.current?qr.DISPLAY:qr.DISPLAY_NEXT,context:Gr.NO_LYRICS}}),h.current=!1},onError:()=>{y({action:{type:h.current?qr.DISPLAY:qr.DISPLAY_NEXT,context:Gr.ERROR}}),h.current=!1}}),f=(0,i.useMemo)((()=>{var e,i,r,p,h,y,f,_;const v=(null==A||null===(e=A.track)||void 0===e||null===(e=e.lyrics)||void 0===e?void 0:e.synchronizedWordByWordLines)||void 0,b=(null==A||null===(i=A.track)||void 0===i||null===(i=i.lyrics)||void 0===i?void 0:i.synchronizedLines)||void 0,k=(null==A||null===(r=A.track)||void 0===r||null===(r=r.lyrics)||void 0===r?void 0:r.text.split(/(?:\r?\n)+/))||void 0,T=(null==A||null===(p=A.track)||void 0===p||null===(p=p.lyrics)||void 0===p||null===(p=p.synchronizedLines)||void 0===p?void 0:p.map((e=>e.lineTranslated)))||void 0;return{...s,trackId:t,lyricsWordByWord:v,lyricsLineByLine:b,lyricsUnsynchronized:k,lyricsTranslated:T,backgroundColor:n,isLightMode:a,isLoading:g,hasError:!!E,timeToFirstLyric:null!==(h=null==A||null===(y=A.track)||void 0===y||null===(y=y.lyrics)||void 0===y||null===(y=y.synchronizedLines)||void 0===y?void 0:y[0].milliseconds)&&void 0!==h?h:0,copyright:(null==A||null===(f=A.track)||void 0===f||null===(f=f.lyrics)||void 0===f?void 0:f.copyright)||"",writers:(null==A||null===(_=A.track)||void 0===_||null===(_=_.lyrics)||void 0===_?void 0:_.writers)||"",hasLyrics:!!b||!!v||!!k,hasSync:!!b||!!v,hasTranslation:!(null==T||!T.filter((e=>!!e)).length),showTranslation:u,toggleTranslation:m,setIsUserScrolling:o,setShowLyricsInHeader:l,setCurrentIndexLine:c,setCurrentLineRef:d}}),[t,n,a,A,g,u,s]);return i.createElement(Hr.Provider,{value:f},e)};var Yr=n("hDNs"),jr=n("9yOc");const Kr_Header=({children:e,...t})=>i.createElement(te.a,(0,a.A)({gridArea:"header",paddingTop:"spacing.2xl",px:"spacing.2xl",width:"100%",zIndex:2,sx:{"-webkit-app-region":jr.A.is("windows")?"no-drag":"drag"}},t),e),Kr_Body=({children:e,...t})=>i.createElement(te.a,(0,a.A)({gridArea:"body",overflow:"auto",p:{base:"spacing.l",sm:"spacing.2xl"}},t),e),Kr_Main=({children:e,...t})=>i.createElement(te.a,(0,a.A)({display:"grid",height:"100vh",gridTemplateColumns:"1fr",gridTemplateRows:"auto 1fr auto",gridTemplateAreas:"'header' 'body' 'footer'",position:"relative",overflow:"hidden"},t),e),$r=new class{constructor(e){this._logCenter=void 0,this._logCenter=e}logReportClick(e,t,n){this.log({trackId:e,isSynchro:t,container:zr.PANEL,action:{type:qr.CLICK_REPORT_PROBLEM},country:n})}logProblem(e,t,n,a){this.log({trackId:e,isSynchro:t,container:zr.PANEL,action:{type:qr.CLICK_CONFIRM_PROBLEM,context:n},country:a})}log({trackId:e,isSynchro:t,container:n,action:a,country:i}){this._logCenter.log((0,Oa.L)("lyrics.lyrics_action","1.0.0",{sng:Number(e),lyrics_type:t?Fr.SYNCHRO:Fr.FULL_TEXT,container:n,action:a,client_ip:La.A.get(),country:i}))}}(Un.A);var Jr,Xr,Zr=n("arQ9"),eo=n("KIES"),to=n("YnMw"),no=n("dPP5"),ao=n("dLkS"),io=n("U5dO");const so=()=>{const{isOpen:e,onOpen:t,onClose:n}=(0,Zr.j)(),[a,s]=(0,i.useState)(),{country:r,trackId:o,isAppInDarkMode:l}=(0,ve.G)((e=>({country:e.user.COUNTRY,trackId:e.player.music.id,isAppInDarkMode:(0,T.NF)(e.user)}))),{hasSync:c,hasTranslation:d}=Vr(),u=(0,i.useMemo)((()=>[c&&{value:Br.PROBLEM_SYNCHRONIZATION,label:(0,X.AP)("lyricstranslation_text_errorinlyricssyncronization_web")},{value:Br.PROBLEM_TYPO,label:(0,X.AP)("lyricstranslation_text_typoinlyrics_web")},{value:Br.PROBLEM_MATCHING,label:(0,X.AP)("lyricstranslation_text_lyricsdonotmatchtrack_web")},{value:Br.PROBLEM_LANGUAGE,label:(0,X.AP)("lyricstranslation_text_languageisincorrect_web")},d&&{value:Br.PROBLEM_TRANSLATION,label:(0,X.AP)("lyricstranslation_text_translationisincorrect_web")}].filter(Boolean)),[c,d]),p=(0,i.useCallback)((({children:e})=>l?i.createElement(Yr.QQ,null,e):i.createElement(Yr.K2,null,e)),[l]);return i.createElement(i.Fragment,null,i.createElement(ye.K0,{onClick:()=>{$r.logReportClick(o,c,r),t()},"aria-label":(0,X.AP)("lyricstranslation_title_reportaproblem_web"),icon:Jr||(Jr=i.createElement(io.Z,null)),variant:"ghost",sx:{"-webkit-app-region":"no-drag"}}),i.createElement(p,null,i.createElement(R.aF,{isOpen:e,onClose:n,isCentered:!0},Xr||(Xr=i.createElement(L.m,null)),i.createElement(O.$,null,i.createElement(eo.r,{textAlign:"center"},(0,X.AP)("lyricstranslation_title_reportaproblem_web")),i.createElement(D.c,null,i.createElement(to.z,{onChange:e=>{s(e)},value:a},i.createElement(no.B,{direction:"column",spacing:4,textAlign:"left"},u.map((({value:e,label:t})=>i.createElement(ao.s,{key:e,value:e,spacing:{base:6,sm:8,md:4}},t)))))),i.createElement(R.jl,null,i.createElement(ye.$n,{variant:"outline",onClick:n},(0,X.AP)("generic_action_cancel_web")),i.createElement(ye.$n,{onClick:()=>{a&&($r.logProblem(o,c,a,r),s(void 0),n())},disabled:!a},(0,X.AP)("Valider")))))))};var ro,oo;const lo=()=>{const{trackId:e,hasError:t,hasLyrics:n,hasSync:a,lyricsLineByLine:r,lyricsWordByWord:o,showLyricsInHeader:l,currentIndexLine:c,currentLineRef:d}=Vr(),{playerQueuelist:u,playerType:p}=(0,ve.G)((e=>({playerQueuelist:e.player.config.playerQueuelist,playerType:e.player.config.playerType}))),m=(0,s.wA)(),h=Ur(e),y=()=>{m(u?(0,qi.IG)(!1):(0,qi.no)(!1)),h(!n||t?{action:{type:qr.CLICK_CLOSE,context:n?Gr.ERROR:Gr.NO_LYRICS}}:{action:{type:qr.CLICK_CLOSE},type:a?Fr.SYNCHRO:Fr.FULL_TEXT})};return(0,i.useEffect)((()=>{p===qe.Cc.ADS&&y()}),[p]),i.createElement(Te.s,{alignItems:"center",height:"100%",justifyContent:"space-between",py:"spacing.xs"},i.createElement(ye.K0,{onClick:y,"aria-label":(0,X.AP)("generic_action_closepanel_web"),icon:ro||(ro=i.createElement(Ee.w,null)),variant:"ghost",sx:{"-webkit-app-region":"no-drag"}}),i.createElement(Te.s,{alignItems:"center",justifyContent:"flex-end",flex:{base:1,md:.6},gap:"spacing.m"},l&&i.createElement(te.a,{borderRadius:"lg",bg:"rgba(255, 255, 255, 0.2)",transition:"background-color 0.15s",padding:"spacing.s",cursor:"pointer",_hover:{backgroundColor:"rgba(255, 255, 255, 0.4)"},onClick:()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"})},w:"100%",sx:{"-webkit-app-region":"no-drag"}},i.createElement(ze.E,{textAlign:"center",noOfLines:1,fontWeight:"bold",color:"text.neutral.primary.default"},o?o[c].words.reduce(((e,t)=>`${e} ${t.word}`),""):r?r[c].line:void 0)),f.A.isAllowed("lyrics_report_problem")&&n&&(oo||(oo=i.createElement(so,null)))))};var co=n("SsV2"),uo=n("sZev");const po={trackId:"",isPlaying:!1,isPaused:!1,timeToFirstLyric:0,position:0,play:()=>{},pause:()=>{},seek:()=>{}},mo=(0,i.createContext)(po),ho=()=>(0,i.useContext)(mo),yo=({children:e})=>{const[t,n]=(0,i.useState)(0),{trackId:a,isPlaying:s,isPaused:r,trackDuration:o}=(0,ve.G)((e=>({trackId:e.player.music.id,isPlaying:e.player.control.playing,isPaused:e.player.control.paused,trackDuration:e.player.music.trackDuration}))),l={...po,trackId:a,isPlaying:s,isPaused:r,position:t,play:Be.Ay.control.play,pause:Be.Ay.control.pause,seek:e=>{Be.Ay.control.seek(e/1e3/o)}};return(0,i.useEffect)((()=>{const e=(e,t)=>{n(Math.floor(1e3*t))};return E.A.subscribe(E.A.player.position,e),()=>{E.A.unsubscribe(E.A.player.position,e)}}),[]),i.createElement(mo.Provider,{value:l},e)};var go;const Ao=()=>{const{timeToFirstLyric:e}=Vr(),{position:t}=ho();return i.createElement(te.a,{height:"100px",width:"100px"},i.createElement(co.P,{color:"text.neutral.primary.default",max:e,min:0,size:"100%",thickness:"4px",trackColor:"background.accent.onContent.disabled",value:t},go||(go=i.createElement(uo.n,{width:"fit-content"},i.createElement(Vi.c,{size:"medium",color:"text.neutral.primary.default"})))))},Eo=()=>{const{copyright:e,writers:t}=Vr();return i.createElement(te.a,{role:"complementary",color:"text.neutral.primary.default",fontSize:"12px",textAlign:"center"},i.createElement(ze.E,{variant:"body.xs.default"},(0,X.AP)("Licence et autorisation données par LyricFind")),i.createElement(ze.E,{variant:"body.xs.default",itemType:"https://schema.org/Organization",itemProp:"copyrightHolder",itemScope:!0},"© ",i.createElement("span",{itemProp:"legalName"},e)),i.createElement(ze.E,{itemType:"https://schema.org/Person",itemProp:"lyricist",itemScope:!0},i.createElement("span",{itemProp:"name"},t)))};var fo=n("pkJ8");const _o=[{opacity:0,percentage:0},{opacity:1,percentage:18}],vo=[{opacity:1,percentage:75},{opacity:0,percentage:88}],bo=(0,fo.A)((e=>{const t=e.getClientHeight(),n=e.getScrollHeight(),a=e.getScrollTop(),i=a+t,s=a-20,r=t/5;let o=_o.map((e=>({...e,percentage:0})));s>0&&(o=s<=r?_o.map((e=>({...e,percentage:Math.ceil(s/r*e.percentage)}))):_o);let l=vo;return i>n-r&&(l=vo.map((e=>({...e,percentage:Math.round(100-(n-i)/r*(100-e.percentage))})))),[...o,...l]}),100),ko=i.forwardRef((({children:e},t)=>{const[n,a]=(0,i.useState)([..._o,...vo]);(0,i.useImperativeHandle)(t,(()=>({setMaskGradient:e=>{const t=bo(e);t&&n.some(((e,n)=>e.percentage!==t[n].percentage))&&a(t)}})));const s=n.map((e=>`rgb(0 0 0 / ${100*e.opacity}%) ${e.percentage}%`)).join(",");return i.createElement(te.a,{height:"100%",width:"100%",sx:{maskImage:`linear-gradient(to bottom, ${s})`,WebkitMaskImage:`linear-gradient(to bottom, ${s})`}},e)}));ko.displayName="LyricsMask";const To=ko;var Co,So;const Io=({children:e})=>{const{hasSync:t,setIsUserScrolling:n,isUserScrolling:a}=Vr(),s=(0,i.useRef)(null),r=(0,i.useCallback)((()=>{a||n(!0),s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{n(!1)}),5e3)}),[a,n,n]);return i.createElement(To,null,i.createElement(te.a,{onWheel:t?r:void 0,height:"full",overflowY:"scroll",sx:{"::-webkit-scrollbar":{display:"none"},"-ms-overflow-style":"none","scrollbar-width":"none"}},i.createElement(Te.s,{flexDirection:"column",alignItems:"center",paddingTop:"size.3xl",paddingBottom:"size.3xl",paddingStart:{base:"size.m",md:"size.2xl"},paddingEnd:{base:"size.m",md:"size.2xl"}},t&&(Co||(Co=i.createElement(te.a,{marginTop:"size.m",marginBottom:"size.l",marginX:"auto"},i.createElement(Ao,null)))),i.createElement(Te.s,{flexDirection:"column",alignItems:"center",textAlign:"center",gap:"spacing.3xl",marginBottom:"spacing.3xl"},e),So||(So=i.createElement(te.a,{marginTop:"spacing.3xl",marginBottom:"spacing.xl"},i.createElement(Eo,null))))))},wo_Wrapper=({isActive:e,children:t})=>i.createElement(te.a,{paddingY:"spacing.s",lineHeight:"48px",role:"group",_hover:{cursor:"pointer",opacity:1},opacity:e?1:.5},t),wo_Default=({children:e})=>i.createElement(ze.E,{variant:"body.2xl",color:"text.neutral.primary.default",fontSize:"40px"},e),wo_Translated=({isActive:e=!1,children:t})=>i.createElement(ze.E,{paddingY:"spacing.s",variant:"body.xl.default",color:"text.neutral.primary.default",opacity:e?1:.5,_groupHover:{opacity:1},fontSize:"22px",fontStyle:"italic",fontWeight:400,lineHeight:"40px"},t),Po=()=>{var e,t;const{trackId:n}=(0,ve.G)((e=>({trackId:e.player.music.id}))),{loading:a,data:s}=(0,we.kqj)({variables:{trackId:n}});return a?null:i.createElement(te.a,{width:"28vw",minWidth:"300px",sx:{"@media screen and (min-aspect-ratio: 5/3)":{width:"46.7vh"}}},i.createElement(Ge.A,{src:(null==s||null===(e=s.track)||void 0===e||null===(e=e.album)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.large[0])||"",isExplicitCover:null==s||null===(t=s.track)||void 0===t||null===(t=t.album)||void 0===t||null===(t=t.cover)||void 0===t?void 0:t.explicitStatus,borderRadius:"l",border:"none",style:{boxShadow:"0px 30px 80px 0px rgba(0 0 0 / 40%)"}}))},xo=({line:e,lineTranslated:t,milliseconds:n,duration:a,index:s})=>{const r=(0,i.useRef)(null),{position:o,seek:l}=ho(),{showTranslation:c,isUserScrolling:d,setShowLyricsInHeader:u,setCurrentIndexLine:p,setCurrentLineRef:m}=Vr(),h=null!=n?n:0,y=o>h-200,g=o>h-200&&null!==a&&o<h+a;return(0,i.useEffect)((()=>{const e=r.current;y&&e&&!d&&e.scrollIntoView({behavior:"smooth",block:"center"})}),[y,d]),(0,i.useEffect)((()=>{const e=r.current;if(e&&g){const t=new IntersectionObserver((([t])=>{u(!t.isIntersecting),p(s),m({current:e})}));return t.observe(e),()=>{e&&t.unobserve(e)}}}),[g,u,p]),i.createElement(te.a,{onClick:()=>l(h),ref:r},i.createElement(wo_Wrapper,{isActive:y},i.createElement(wo_Default,null,e),c&&t&&i.createElement(wo_Translated,null,t)))},No=({start:e,word:t})=>{const{position:n}=ho(),a=n>e-200;return i.createElement(ze.E,{as:"span",color:"'text.neutral.primary.default'",opacity:a?1:.5,transition:"color 0.2s ease",_groupHover:{opacity:1}},t," ")},Ro=({start:e,end:t,words:n,index:s})=>{const r=(0,i.useRef)(null),{position:o,seek:l}=ho(),{lyricsTranslated:c,showTranslation:d,setCurrentIndexLine:u,setCurrentLineRef:p,setShowLyricsInHeader:m,isUserScrolling:h}=Vr(),y=o>e-200,g=o<t,A=y&&g;return(0,i.useEffect)((()=>{const e=r.current;y&&g&&e&&!h&&e.scrollIntoView({behavior:"smooth",block:"center"})}),[y,g,d,h]),(0,i.useEffect)((()=>{const e=r.current;if(e&&A){const t=new IntersectionObserver((([t])=>{m(!t.isIntersecting),u(s),p({current:e})}));return t.observe(e),()=>{e&&t.unobserve(e)}}}),[A,m]),i.createElement(te.a,{onClick:()=>l(e),ref:r},i.createElement(wo_Wrapper,{isActive:y},i.createElement(wo_Default,null,n.map(((e,t)=>i.createElement(No,(0,a.A)({key:t},e))))),d&&(null==c?void 0:c[s])&&i.createElement(wo_Translated,null,c[s])))};var Lo,Oo;const Do=()=>{const{trackId:e,hasLyrics:t,hasSync:n,hasTranslation:s,lyricsWordByWord:r,lyricsLineByLine:o,lyricsUnsynchronized:l,backgroundColor:c,isLightMode:d,showTranslation:u,toggleTranslation:p}=Vr(),m=Ur(e),h=(0,i.useMemo)((()=>{const e=({children:e})=>d?i.createElement(Yr.K2,null,e):i.createElement(Yr.QQ,null,e);return e.displayName="ColorMode",e}),[d]);return i.createElement(h,null,i.createElement(Kr_Main,{height:"full",backgroundColor:c},Lo||(Lo=i.createElement(Kr_Header,null,i.createElement(lo,null))),i.createElement(Kr_Body,null,i.createElement(Te.s,{height:"full",flexDirection:"row",alignItems:"center"},i.createElement(Te.s,{alignItems:"center",justifyContent:"center",flex:t?.4:1,height:"full",display:{base:"none",md:"flex"}},Oo||(Oo=i.createElement(Po,null))),t&&i.createElement(Te.s,{flex:{base:1,md:.6},height:"full",position:"relative"},i.createElement(yo,null,i.createElement(Io,null,r?r.map(((e,t)=>i.createElement(Ro,(0,a.A)({key:t,index:t},e)))):o?o.map(((e,t)=>i.createElement(xo,(0,a.A)({key:t,index:t},e)))):l?i.createElement(i.Fragment,null,i.createElement(ze.E,{color:"text.neutral.primary.default",variant:"body.xs.default",padding:"18px 0"},(0,X.AP)("sharelyricserrormessage_text_lyricsnotsyncedwithtrackyet_web")),l.map(((e,t)=>i.createElement(wo_Default,{key:t},e)))):void 0)),s&&i.createElement(te.a,{position:"absolute",bottom:"spacing.xl",left:0,right:0,textAlign:"center"},i.createElement(ye.$n,{onClick:()=>{m({action:{type:u?qr.CLICK_UNTRANSLATE:qr.CLICK_TRANSLATE},type:n?Fr.SYNCHRO:Fr.FULL_TEXT}),p()},"aria-label":u?(0,X.AP)("lyrics_action_withouttranslation_web"):(0,X.AP)("lyrics_action_withtranslation_web"),variant:"onContent",borderColor:"transparent",_hover:{borderColor:"transparent"}},u?(0,X.AP)("lyrics_action_withouttranslation_web"):(0,X.AP)("lyrics_action_withtranslation_web"))))))))};var Mo;const Uo=()=>Mo||(Mo=i.createElement(Wr,null,i.createElement(Do,null)));var Fo,zo;class qo extends i.Component{constructor(e){super(e),this._onClose=this._onClose.bind(this),this._onBackToQueuelist=this._onBackToQueuelist.bind(this),this._onKeyUp=this._onKeyUp.bind(this)}componentDidMount(){window.addEventListener("keyup",this._onKeyUp)}componentDidUpdate(e){this.props.location!==e.location&&this._onClose()}componentWillUnmount(){window.removeEventListener("keyup",this._onKeyUp)}render(){const{playerFull:e,playerQueuelist:t,playerLyrics:n}=this.props;return t||n?i.createElement(K.N,null,e&&i.createElement($.P.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{ease:"easeInOut",duration:.4},onAnimationStart:({y:e})=>{"100%"===e&&Gi(!0)},onAnimationComplete:({y:e})=>{0===e?Gi(!1):(this.props.setPlayerQueuelist(!1),this.props.setPlayerLyrics(!1))},className:(0,r.A)("player-lyrics-full",{"player-full":t})},t&&!n&&(Fo||(Fo=i.createElement(Dr,null))),n&&(zo||(zo=i.createElement(Uo,null))))):null}_onBackToQueuelist(){this.props.setPlayerLyrics(!1)}_onClose(){this.props.setPlayerFull(!1)}_onKeyUp(e){"Escape"===e.key&&(this.props.playerLyrics&&this.props.playerQueuelist?this.props.setPlayerLyrics(!1):this.props.setPlayerFull(!1))}}const Bo=(0,pe.y)((0,s.Ng)((({player:e})=>({playerFull:e.config.playerFull,playerQueuelist:e.config.playerQueuelist,playerLyrics:e.config.playerLyrics})),{setPlayerFull:qi.no,setPlayerQueuelist:qi.PV,setPlayerLyrics:qi.IG})(qo));var Go,Qo=n("aQSR"),Ho=n("RvOg");const Vo=()=>{const e=(0,s.d4)((e=>e.player.music.trackDuration));return i.createElement(ye.K0,{variant:"ghost","aria-label":(0,X.AP)("Retour rapide de 30 secondes"),onClick:()=>{const t=(Be.Ay.getPosition()-30)/e;Be.Ay.control.seek(t)},icon:Go||(Go=i.createElement(Ho.I,null)),size:"small","data-testid":"backward_30"})};var Wo,Yo=n("0BT7");const jo=()=>{const e=(0,s.d4)((e=>e.player.music.trackDuration));return i.createElement(ye.K0,{variant:"ghost","aria-label":(0,X.AP)("Avance rapide de 30 secondes"),"data-testid":"forward_30",onClick:()=>{const t=(Be.Ay.getPosition()+30)/e;t>=1?Be.Ay.control.nextSong():Be.Ay.control.seek(t)},icon:Wo||(Wo=i.createElement(Yo.Y,null)),size:"small"})};var Ko=n("79CY");const $o=({trackId:e})=>(0,ve.G)(Xi.Cu).like?i.createElement("div",{className:"preview-action"},i.createElement("ul",{className:"svg-icon-group"},i.createElement("li",{className:"svg-icon-group-item"},i.createElement(Ki.A,{className:"svg-icon-group-btn",context:{ID:e,TYPE:"player"},id:e,tooltip:!0,type:Ne.Ay.Song})))):null,Jo=e=>e.player.music.mediaType,Xo=({track:e})=>{const t=(0,ve.G)(Jo);return i.createElement("div",{className:"preview-thumbnail","data-testid":"content_preview_item_cover"},i.createElement(It.A,{type:t===qe.zu.EPISODE?Ne.Ay.Episode:Ne.Ay.Album,height:40,width:40,data:e,coverLink:!1}))},Zo=({track:e,trackArtists:t,trackTitle:n})=>{const a=(0,ve.G)(Xi.Cu),s=br({playerUI:a,track:e});return i.createElement("div",{className:"preview-heading","data-testid":"content_preview_item_title"},i.createElement(Ve.A,null,s?i.createElement(He.A,{className:"preview-link",to:s},n):n," · ",t.map(((e,t)=>{const n=kr({playerUI:a},e);return[t>0?", ":"",null===n?e.ART_NAME:i.createElement(He.A,{className:"preview-link",key:e.ART_ID,to:n},e.ART_NAME)]}))))},el=({type:e})=>{const t=(0,ve.G)((t=>"prev"===e?(e=>e.player.music.trackPrev)(t):(e=>e.player.music.trackNext)(t))),n=(0,ve.G)((t=>"prev"===e?(0,_r.hN)(t):(0,_r.VX)(t))),a=(0,ve.G)((t=>"prev"===e?(0,_r.$7)(t):(0,_r.b3)(t))),s=String(t.SNG_ID_ORIGIN||t[Be.Ay.getMediaId(t)]);return i.createElement("div",{className:"player-overlay-preview","data-testid":"content_preview_tooltip"},i.createElement(Xo,{track:t}),i.createElement(Zo,{track:t,trackArtists:n,trackTitle:a}),i.createElement($o,{trackId:s}))};var tl,nl,al=n("BcXB");const il=()=>{const e=(0,s.d4)(al.m5),t=(0,s.d4)(al.kQ),n=(0,s.d4)((e=>(0,Xi.Cu)(e))),a=Be.Ay.getPrevSong()&&!Be.Ay.isRadio()&&t!==qe.EV.SINGLE,r=i.createElement(ye.K0,{icon:tl||(tl=i.createElement(Ko.w,null)),isDisabled:!e||!n.prev,onClick:()=>{Be.Ay.control.prevSong()},variant:"ghost","aria-label":(0,X.AP)("Précédent"),size:"small","data-testid":"previous_track_button"});return a?i.createElement("div",null,i.createElement(Ds.A,{openDelay:500,trigger:"hover",isLazy:!0},i.createElement(Ms.W,null,r),nl||(nl=i.createElement(Us.h,{w:"auto"},i.createElement(Fs.R,null),i.createElement(zs.e,{p:0},i.createElement(el,{type:"prev"})))))):r};var sl,rl,ol,ll,cl=n("slbf"),dl=n("dShs"),ul=n("X/L1"),pl=n("tew7");const ml=({isPaused:e})=>{const{playerUI:t,loading:n,isChromecastCasting:a}=(0,s.d4)((e=>({playerUI:(0,Xi.Cu)(e),loading:e.player.control.loading,isChromecastCasting:e.player.chromecast.casting})));return a&&n?sl||(sl=i.createElement(cl.A,{className:"animate-spin",size:"auto"})):e?rl||(rl=i.createElement(dl.S,null)):t.stop?ol||(ol=i.createElement(ul.w,null)):ll||(ll=i.createElement(pl.I,null))};var hl=n("Vynx"),yl=n("bDF2");const gl=()=>{const{paused:e,playing:t,playerUI:n,loading:a,isConnected:r,canPlay:l,canPause:c}=(0,s.d4)((e=>({paused:e.player.control.paused,playing:e.player.control.playing,loading:e.player.control.loading,playerUI:(0,Xi.Cu)(e),isChromecastCasting:e.player.chromecast.casting,isConnected:(0,T.UJ)(e.user),canPlay:(0,al.v_)(e),canPause:(0,al.J2)(e)}))),{trackEvent:d}=(0,o.z1)(),u=e&&!t||!e&&!t,p=n.stop?(0,X.AP)("Stop"):(0,X.AP)("Pause"),m=u?(0,X.AP)("Play"):p;return i.createElement(ye.K0,{icon:i.createElement(ml,{isPaused:u}),onClick:()=>{if(u?Be.Ay.control.play():n.pause?Be.Ay.control.pause():Be.Ay.control.stop(),hl.A.intent(u?hl.A.TIME_TO_PLAY:hl.A.TIME_TO_PAUSE),!r&&u){const e=(0,yl.bg)();d({eventaction:`click-play-${e}_${Be.Ay.getMediaType()}`,event:"click",eventcategory:e,eventlabel:"deezer-player"})}},disabled:!c||!l||a,"aria-label":m,size:"small","data-testid":"play_button_"+(u?"play":n.stop?"stop":"pause")})};var Al,El,fl=n("M9Yy");const _l=()=>{const e=(0,s.d4)(al.m$),t=(0,s.d4)(al.kQ),n=(0,s.d4)((e=>(0,Xi.Cu)(e))),a=Be.Ay.getNextSong()&&!Be.Ay.isRadio()&&t!==qe.EV.SINGLE,r=i.createElement(ye.K0,{icon:Al||(Al=i.createElement(fl.E,null)),isDisabled:!e||!n.next,onClick:()=>{Be.Ay.control.nextSong()},variant:"ghost","aria-label":(0,X.AP)("Suivant"),size:"small","data-testid":"next_track_button"});return a?i.createElement("div",null,i.createElement(Ds.A,{openDelay:500,trigger:"hover",isLazy:!0},i.createElement(Ms.W,null,r),El||(El=i.createElement(Us.h,{w:"auto"},i.createElement(Fs.R,null),i.createElement(zs.e,{p:0},i.createElement(el,{type:"next"})))))):r},vl=()=>{const{playerUI:e,shuffle:t}=(0,s.d4)((e=>({playerUI:(0,Xi.Cu)(e),shuffle:e.player.control.shuffle})));let n="";e.shuffle&&(n=t?(0,X.AP)("Désactiver le mode aléatoire"):(0,X.AP)("Activer le mode aléatoire"));const a=e.chromecastActive||!e.shuffle,r=t&&e.shuffle?"icon.accent.primary.default":"icon.neutral.primary.default",o=i.createElement(ye.K0,{disabled:a,"aria-label":n,onClick:()=>{Be.Ay.control.setShuffle(!t)},icon:i.createElement(Js.R,{color:r}),variant:"ghost",size:"small","data-testid":"shuffle_play_button_"+(t?"on":"off")});return a?o:i.createElement(ki.m,{label:n},o)};var bl=n("cx5i"),kl=n("AfR/");const Tl=()=>{const{playerUI:e,repeat:t}=(0,s.d4)((e=>({playerUI:(0,Xi.Cu)(e),repeat:e.player.control.repeat})));let n="";if(e.repeat)switch(n=(0,X.AP)("Répéter"),t){case qe.EV.OFF:n=(0,X.AP)("Réécouter tous les titres");break;case qe.EV.ALL:n=(0,X.AP)("Réécouter ce titre");break;case qe.EV.SINGLE:n=(0,X.AP)("Désactiver la fonction Répéter")}const a=!e.repeat,r=t>0&&e.repeat?"icon.accent.primary.default":"icon.neutral.primary.default",o=i.createElement(ye.K0,{isDisabled:a,"aria-label":n,onClick:()=>{Be.Ay.control.setRepeat(t===qe.EV.SINGLE?qe.EV.OFF:t+1)},variant:"ghost",size:"small",icon:t===qe.EV.SINGLE?i.createElement(bl.Z,{color:r}):i.createElement(kl.H,{color:r}),"data-testid":"repeat_button_"+(t===qe.EV.OFF?"off":t===qe.EV.ALL?"all":"single")});return a?o:i.createElement(ki.m,{label:n},o)},Cl=e=>i.cloneElement(e.children,{className:(0,r.A)(e.children.props.className,"mousetrap")});Cl.propType={children:hn().element.isRequired};const Sl=Cl;var Il;class wl extends i.Component{constructor(e){super(e),this._onKeyUp=this._onKeyUp.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onChange=this._onChange.bind(this),this._showTooltip=this._showTooltip.bind(this),this._hideTooltip=this._hideTooltip.bind(this),this.isDragging=!1,this.state={position:!1,isActive:!1,tooltipOffset:null,tooltipValue:0},this._sliderTrackRef=i.createRef()}shouldComponentUpdate(e,t){return e.value!==this.props.value||!1!==t.position||t.isActive!==this.state.isActive||t.tooltipOffset!==this.state.tooltipOffset||t.tooltipValue!==this.state.tooltipValue}render(){const{max:e,min:t,value:n,step:s,disabled:o,tooltip:l,autoHide:c,testId:d,counter:u}=this.props,{position:p,isActive:m}=this.state,h=Number(this.isDragging&&!1!==p?p:n),y=100*(h-t)/(e-t)||0,g={className:(0,r.A)("slider",{"slider-autohide":c,"is-active":m,"has-counter":u}),onMouseEnter:c?()=>this._setActive(!0):null,onMouseLeave:c?()=>this._setActive(!1):null,onFocus:c?()=>this._setActive(!0):null,onBlur:c?()=>this._setActive(!1):null},A=this._getSliderTrackStyle(y);return i.createElement(te.a,(0,a.A)({},g,{py:"spacing.2xs",height:"auto"}),this._renderCurrentValue(h),i.createElement("div",{className:"slider-track",ref:this._sliderTrackRef},Il||(Il=i.createElement("div",{className:"slider-track-default"})),i.createElement("div",{className:"slider-track-active",style:A}),i.createElement(Sl,null,i.createElement("input",{className:"slider-track-input",type:"range",step:s,min:t,max:e,value:h,disabled:o,"aria-valuemin":t,"aria-valuemax":e,"aria-valuenow":h,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onKeyUp:this._onKeyUp,onChange:this._onChange,onMouseMove:l?this._showTooltip:null,onMouseOut:l?this._hideTooltip:null,"data-testid":d})),this._renderTooltip()),this._renderMaxValue())}_renderCurrentValue(e){const{counter:t}=this.props;if(!1===t)return null;const n=this._formatValue(e);return i.createElement(te.a,{pr:"spacing.l"},i.createElement(ze.E,{variant:"body.2xs.default",color:"text.neutral.primary.default","data-testid":"elapsed_time"},n))}_renderMaxValue(){const{counter:e,max:t}=this.props;if(!1===e)return null;const n=this._formatValue(t);return i.createElement(te.a,{pl:"spacing.l",position:"absolute",right:"0"},i.createElement(ze.E,{variant:"body.2xs.default",color:"text.neutral.primary.default","data-testid":"remaining_time"},n))}_renderTooltip(){const{tooltipOffset:e,tooltipValue:t}=this.state;if(null===e)return null;const n=this._formatValue(t),a=this._getTooltipStyle(e);return i.createElement("div",{className:"slider-tooltip",style:a},i.createElement(ze.E,{variant:"body.2xs.default"},n))}_onMouseDown(){this.isDragging=!0}_onMouseUp(e){this.props.onChange(e.target.value);const t={position:!1};if(this.props.tooltip){const n=e.target.getBoundingClientRect(),a=Math.floor(n.left),i=Math.floor(n.width);(e.clientX<a||e.clientX>a+i)&&(t.tooltipOffset=null)}this.setState(t,(()=>{this.isDragging=!1}))}_onKeyUp(e){-1!==[33,34,35,36,37,38,39,40].indexOf(e.keyCode)&&(this.props.onChange(e.target.value),this.setState({position:!1}))}_onChange({target:{value:e}}){this.props.onProgress(e),(this.isDragging||Number(e)!==this.props.min&&Number(e)!==this.props.max)&&this.setState({position:e})}_showTooltip(e){const t=this._sliderTrackRef.current.getBoundingClientRect(),n=Math.floor(t.left),a=Math.floor(t.width);let i=e.clientX-n;i<0&&(i=0),i>a&&(i=a);const s=this._getValueByCursorPosition(e.clientX);null!==this.state.tooltipOffset&&s===this.state.tooltipValue||this.setState({tooltipOffset:i,tooltipValue:s})}_hideTooltip(){this.setState({tooltipOffset:null})}_formatValue(e){const{counter:t}=this.props;return"function"==typeof t?t(e):e}_setActive(e){this.setState({isActive:e})}_getSliderTrackStyle(e){return{width:`${e}%`,willChange:"width"}}_getTooltipStyle(e){return{transform:`translate3d(${e}px, 0px, 0px)`,WebkitTransform:`translate3d(${e}px, 0px, 0px)`,willChange:"transform"}}_getValueByCursorPosition(e){const{min:t,max:n,step:a}=this.props,i=this._sliderTrackRef.current.getBoundingClientRect(),s=Math.floor(i.left),r=Math.floor(i.width);let o=e-s;o<0&&(o=0),o>r&&(o=r);const l=o/r*100/100,c=Math.round(l*(n*a/a)+t-l*t);return a>1&&c%a!=0?c-c%a:c}}wl.defaultProps={min:0,max:100,value:0,step:1,disabled:!1,counter:!0,tooltip:!1,autoHide:!1,onChange:()=>{},onProgress:()=>{},testId:null};const Pl=wl;var xl=n("s026");class Nl extends i.Component{constructor(...e){super(...e),this.state={position:0},this._onPositionChanged=(e,t)=>{this.setState({position:t})},this._onSeek=e=>{const{duration:t}=this.props;e>=t?Be.Ay.control.nextSong():Be.Ay.isPlaying()||Be.Ay.isPaused()?Be.Ay.control.seek(e/t):(Be.Ay.getTrackList()[0].OFFSET=e/t*t,Be.Ay.control.play())}}componentDidMount(){E.A.subscribe(E.A.player.position,this._onPositionChanged)}componentWillUnmount(){E.A.unsubscribe(E.A.player.position,this._onPositionChanged)}render(){const{position:e}=this.state,{playerUI:t,duration:n,seekAllowed:a}=this.props;return t.seek?i.createElement(Pl,{max:n,value:e,counter:xl.A,onChange:this._onSeek,disabled:!a,tooltip:!0,autoHide:!0,testId:"progress_bar"}):null}}const Rl=(0,s.Ng)((e=>({duration:e.player.music.trackDuration,playerUI:(0,Xi.Cu)(e),seekAllowed:(0,al.rt)(e)})))(Nl);var Ll=n("g1Fm"),Ol=n("wZBD");const Dl=()=>{const{uiType:e,isUpnext:t,isFlow:n}=(0,s.d4)((e=>({uiType:(0,Xi.ip)(e),isUpnext:e.player.config.isUpnext,isFlow:e.player.config.isFlow})));let a=(0,X.AP)("MIX");return e===Ji.U.AD||e===Ji.U.TRITON_AD?null:(e===Ji.U.LIVESTREAM?a=(0,X.AP)("EN DIRECT"):t?a=(0,X.AP)("RECOMMANDÉ"):n&&(a=(0,X.AP)("FLOW")),i.createElement(Ol.J,{size:"small","data-testid":"listening_context_label"},(0,Ll.A)(a,!0)))};var Ml,Ul,Fl,zl,ql,Bl,Gl,Ql,Hl;const Vl=()=>{const e=(0,s.d4)((e=>(0,Xi.Cu)(e)));return i.createElement(Te.s,{width:"33%",px:"spacing.l",direction:"column",gap:"spacing.xs",dir:"ltr"},i.createElement(Te.s,{justifyContent:"center",alignItems:"center",position:"relative"},e.label&&i.createElement(te.a,{left:"0",top:"50%",transform:"translateY(-50%)",position:"absolute",opacity:{md:"100%",base:"0%"}},Ml||(Ml=i.createElement(Dl,null))),i.createElement(Qo.e,{size:"small",gap:"spacing.s",spacing:0},e.skipBackwards?Ul||(Ul=i.createElement(Vo,null)):Fl||(Fl=i.createElement(vl,null)),zl||(zl=i.createElement(il,null)),ql||(ql=i.createElement(gl,null)),Bl||(Bl=i.createElement(_l,null)),e.skipForwards?Gl||(Gl=i.createElement(jo,null)):Ql||(Ql=i.createElement(Tl,null)))),Hl||(Hl=i.createElement(Rl,null)))};var Wl,Yl=n("Al8Q"),jl=n("RGaU");const Kl=(0,Yl.A)(He.A,{target:"ely5kss1"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),$l=(0,Yl.A)("a",{target:"ely5kss0"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),Jl=()=>{const{playerUI:e,trackTitle:t,uiType:n,track:a}=(0,s.d4)((e=>({playerUI:(0,Xi.Cu)(e),trackTitle:e.player.music.trackTitle,uiType:(0,Xi.ip)(e),track:e.player.music.track})));if(n===Ji.U.AD){const e=window.sasAudioConfig||{},t=e.text,n=decodeURIComponent(e.url),a=e=>{e.preventDefault(),e.stopPropagation(),/^http/.test(n)&&open(n)};return t?/^http/.test(n)?i.createElement($l,{href:n,onClick:a},t):i.createElement(Kl,{to:n,onClick:a},t):null}if(n===Ji.U.TRITON_AD)return i.createElement(i.Fragment,null,Wl||(Wl=i.createElement(jl.k,{as:"span",size:20,thickness:2,marginRight:1,verticalAlign:"text-bottom"})),(0,X.AP)("Chargement en cours"));const r=br({playerUI:e,track:a});return r?i.createElement(Kl,{to:r},t):t},Xl=(0,Yl.A)(He.A,{target:"erlh4i50"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),Zl=()=>{const{trackArtists:e,playerUI:t}=(0,s.d4)((e=>({trackArtists:e.player.music.trackArtists,playerUI:(0,Xi.Cu)(e)})));return e.map(((e,n)=>{const a=kr({playerUI:t},e);return[n>0?", ":"",a?i.createElement(Xl,{className:"track-link",key:e.ART_ID,to:a},e.ART_NAME):e.ART_NAME]}))};var ec;const tc=()=>{const{playerUI:e,track:t,id:n,mediaType:a,userId:r,context:o,trackArtists:l}=(0,s.d4)((e=>({playerUI:(0,Xi.Cu)(e),id:e.player.music.id,track:e.player.music.track,mediaType:e.player.music.mediaType,userId:e.user.id,context:e.player.music.context,trackArtists:e.player.music.trackArtists})));if(a===qe.zu.LIVE_STREAM&&t.EXTERNAL)return null;const c={anchor:e=>i.createElement(ye.K0,{"aria-label":"Open context menu",variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},icon:ec||(ec=i.createElement(Wi.c,null)),size:"small"}),context:{ID:r,TYPE:"player"},data:{SONG:t,PLAYLIST_ID:o.ID},forceShowPlaylists:!0,id:n,placement:"top"},d=String(t.SNG_ID_ORIGIN||n);return i.createElement(Qo.e,{size:"small",spacing:"spacing.xs",alignItems:"center"},e.like&&i.createElement(Ki.A,{type:Ne.Ay.Song,context:{ID:d,TYPE:"player",CONTEXT_ID:t.SPONSORED?"sponsored=true":void 0},tooltip:!0,id:d}),i.createElement(Ar,{placement:"top",artistId:l.length>0?l[0].ART_ID:"0",trackId:String(t.SNG_ID_ORIGIN||n)}),e.contextMenu&&i.createElement("div",{"data-testid":"add_to_playlist_button"},i.createElement($i.A,c)))};var nc,ac,ic,sc;const rc=()=>{const{playerUI:e,mediaType:t,isExplicit:n,uiType:a,currentTrack:r,isExplicitCover:o}=(0,s.d4)((e=>({playerUI:(0,Xi.Cu)(e),mediaType:e.player.music.mediaType,isExplicit:e.player.music.isExplicit,isExplicitCover:(0,fr.cV)(e.player.music.track),uiType:(0,Xi.ip)(e),currentTrack:e.player.music})));return i.createElement(Te.s,{width:"33%",alignItems:"center"},e.cover&&i.createElement(te.a,{boxSize:"size.xl","data-testid":"item_cover",minWidth:"size.xl"},i.createElement(Ge.A,{src:r.cover,alt:r.trackTitle,isExplicitCover:o})),i.createElement(Te.s,{alignItems:"flex-start",minWidth:0},i.createElement(Te.s,{direction:"column",ms:"spacing.s",minWidth:0},e.title&&i.createElement(Te.s,{alignItems:"center",gap:"spacing.xs"},nc||(nc=i.createElement(Ve.A,null,i.createElement(ze.E,{variant:"body.l.default",color:"text.neutral.primary.default","data-testid":"item_title"},i.createElement(Jl,null)))),n&&a!==Ji.U.AD&&a!==Ji.U.TRITON_AD&&(ac||(ac=i.createElement(ji.A,{size:"small"})))),e.subTitle&&(ic||(ic=i.createElement(Ve.A,null,i.createElement(ze.E,{variant:"body.s.default",color:"text.neutral.secondary.default","data-testid":"item_subtitle"},i.createElement(Zl,null))))))),t&&(sc||(sc=i.createElement(Te.s,{ms:"spacing.l"},i.createElement(tc,null)))))};var oc,lc,cc,dc,uc=n("AeFk"),pc=(n("ECDS"),n("oxTq"));class mc extends i.Component{constructor(e){super(e),this._onAudioQualityUpdate=this._onAudioQualityUpdate.bind(this),this._onTriforceUpdate=this._onTriforceUpdate.bind(this),this._onDiscoverClick=this._onDiscoverClick.bind(this)}render(){return i.createElement(te.a,{className:"player-overlay-settings",fontSize:"sm","data-testid":"audio_settings_menu"},this._renderAudioQuality(),i.createElement("ul",{className:"setting-menu"},this._renderNormalized(),this._renderTriforce()))}_renderAudioQuality(){const e=!0===this.props.isCasting?(0,X.AP)("hificast_title_audioqualityondevices_web"):(0,X.AP)("Qualité Audio"),t=this._getCurrentAudioQuality();return i.createElement(to.z,{onChange:this._onAudioQualityUpdate,value:t},i.createElement("ul",{className:"setting-menu"},i.createElement("li",{className:"setting-item"},i.createElement("div",{className:"setting-label-text","data-testid":"audio_setting_title"},e)),this._renderAudioQualityStandard(),this._renderAudioQualityHigh(),this._renderAudioQualityLossless()))}_renderAudioQualityStandard(){const{hasHqAudioRight:e,hasLosslessAudioRight:t}=this.props,n=!t&&!e,a=this._getCurrentAudioQuality()===vr.en.STANDARD;return i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_standard_title"},i.createElement("div",{className:"setting-label-text"},(0,X.AP)("Standard")),!n&&(oc||(oc=i.createElement("div",{className:"setting-label-info"},"128kb/s"))),i.createElement("div",{className:"setting-label-control"},i.createElement(ao.s,{as:"span",value:vr.en.STANDARD,"data-testid":"quality_standard_button_"+(a?"on":"off")}))))}_renderAudioQualityHigh(){const{hasHqAudioRight:e,conversionEntrypoints:t}=this.props;if(!e&&!t.AUDIO_SETTING_PREMIUM)return null;const n=this._getCurrentAudioQuality()===vr.en.HIGH;return e?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_hq_title"},i.createElement("div",{className:"setting-label-text"},(0,X.AP)("Supérieure")),lc||(lc=i.createElement("div",{className:"setting-label-info"},"320kb/s")),i.createElement("div",{className:"setting-label-control"},i.createElement(ao.s,{as:"span",value:vr.en.HIGH,"data-testid":"quality_hq_button_"+(n?"on":"off")})))):i.createElement("li",{className:"setting-item"},i.createElement(Zt.A,null,i.createElement(He.A,{target:"_blank",to:(0,Cn.hY)(t.AUDIO_SETTING_PREMIUM.action),className:"setting-label"},i.createElement("div",{className:"setting-label-text"},(0,X.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-label-control"},i.createElement("span",{className:"setting-discover-link"},t.AUDIO_SETTING_PREMIUM.label,cc||(cc=i.createElement(en.A,{size:"14"})))))))}_renderAudioQualityLossless(){const{conversionEntrypoints:e,hasLosslessAudioRight:t,hasHqAudioRight:n}=this.props;if(!t&&!e.AUDIO_SETTING_HIFI||!n)return null;if(!Be.Ay.html5.flac)return i.createElement("li",{className:"setting-item disabled"},i.createElement("div",{className:"setting-label-text"},(0,X.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-notice"},(0,X.AP)("infomessage_text_notsupportedbybrowserusechromefirefoxedge_web")));const a=this._getCurrentAudioQuality()===vr.en.LOSSLESS;return i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_loseless_title"},i.createElement("div",{className:"setting-label-text"},(0,X.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-label-control"},t?i.createElement(ao.s,{as:"span",value:vr.en.LOSSLESS,"data-testid":"quality_loseless_button_"+(a?"on":"off")}):i.createElement(Zt.A,null,i.createElement(He.A,{className:"setting-discover-link",to:(0,Cn.hY)(e.AUDIO_SETTING_HIFI.action),target:"_blank"},e.AUDIO_SETTING_HIFI.label,dc||(dc=i.createElement(en.A,null)))))),i.createElement("div",{className:"setting-notice"},(0,X.AP)("audiosettings_text_highfidelitydescription_web")))}_renderNormalized(){return f.A.isAllowed("volume_normalization")?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label"},i.createElement("div",{className:"setting-label-text","data-testid":"normalize_title"},(0,X.AP)("audiosettings_title_normalizeaudio_web")),i.createElement("div",{className:"setting-label-control"},i.createElement(nn.d,{as:"span","data-testid":"normalize_button_"+(this.props.isNormalized?"on":"off"),isChecked:this.props.isNormalized,onChange:this._onNormalizedUpdate}))),i.createElement("div",{className:"setting-notice","data-testid":"normalize_subtitle"},(0,X.AP)("audiosettings_text_normalizeaudiodescription_web"))):null}_renderTriforce(){return f.A.isAllowed("triforce_queuelist_ui")&&this.props.isPremium?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label"},i.createElement("div",{className:"setting-label-text","data-testid":"synchronised_title"},(0,X.AP)("Synchronisation de la file d'attente")),i.createElement("div",{className:"setting-label-control"},i.createElement(nn.d,{as:"span",isChecked:this.props.isTriforceEnabled,"data-testid":"synchronised_button_"+(this.props.isTriforceEnabled?"on":"off"),onChange:this._onTriforceUpdate}))),i.createElement("div",{className:"setting-notice","data-testid":"synchronised_subtitle"},(0,X.AP)("Le contenu de votre file d'attente reste le même sur tous les appareils où vous utilisez Deezer."))):null}_onAudioQualityUpdate(e){const t={site:{player_hq:e===vr.en.HIGH||e===vr.en.LOSSLESS}};!0===this.props.isCasting?t.site.cast_audio_quality=e:t.site.player_audio_quality=e,this.props.updateSettings(t),Be.Ay.control.setAudioQuality(e)}_onNormalizedUpdate(e){if(!e.isTrusted)return void e.preventDefault();const t=e.target.checked;Be.Ay.control.setNormalized(t),Ht.A.set({site:{player_normalize:t}}),bt.A.call({method:"log_central.log",data:{BATCH:[{channel:"feature_activation",params:{ts:Math.floor(Date.now()/1e3),state:t?"on":"off",feature:"normalization",os_based:!1}}]}})}_onTriforceUpdate(e){if(!e.isTrusted)return void e.preventDefault();const t=e.target.checked;this.props.updateSettings({site:{triforce:t}})}_onDiscoverClick(e){e.preventDefault(),(0,Er.A)(e.target.href)}_getCurrentAudioQuality(){return this.props.isCasting?this.props.currentCastAudioQuality:this.props.currentAudioQuality}}const hc={updateSettings:C.Xx},yc=(0,s.Ng)((({user:e,player:t})=>({conversionEntrypoints:e.USER.ENTRYPOINTS,currentAudioQuality:e.currentAudioQuality,currentCastAudioQuality:e.currentCastAudioQuality,hasHqAudioRight:e.hasHqAudioRight,hasLosslessAudioRight:e.hasLosslessAudioRight,isPremium:(0,T.ki)(e),isTriforceEnabled:(0,T.Qi)(e),isCasting:t.chromecast.casting,isNormalized:(0,al.mQ)({player:t})})),hc)(mc);var gc,Ac,Ec=n("Ohse");const fc=()=>{const[e,t]=(0,i.useState)(!1);return(0,i.useEffect)((()=>(E.A.subscribe(E.A.player.openAudioSettings,open),()=>E.A.unsubscribe(E.A.player.openAudioSettings,open))),[]),i.createElement(Ds.A,{placement:"top",isLazy:!0,onOpen:()=>t(!0),onClose:()=>t(!1)},i.createElement(Ms.W,null,i.createElement(ye.K0,{"aria-label":(0,X.AP)("Audio"),size:"small",variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},icon:gc||(gc=i.createElement(Ec.U,null)),"data-testid":"audio_settings_button"})),Ac||(Ac=i.createElement(Us.h,{w:"auto"},i.createElement(Fs.R,null),i.createElement(zs.e,{p:0},i.createElement(yc,null)))))};var _c=n("ITz4"),vc=n("mIO1");const bc=()=>{const e=(0,s.d4)(al.yk),t=(0,s.d4)(al.bE),n=(0,i.useCallback)((e=>{Be.Ay.control.setVolume(Number(e/100),!0)}),[]);return i.createElement(Pl,{min:0,max:100,step:1,value:e?0:Math.round(100*t),counter:!1,onProgress:n,testId:"volume_menu_bar"})};var kc,Tc,Cc;const Sc=()=>{const e=(0,s.d4)(al.yk),t=(0,s.d4)(Xi.Cu),n=(0,i.useCallback)((()=>{Be.Ay.control.mute(!e)}),[e]);return i.createElement(Ds.A,{placement:"top",trigger:"hover",isLazy:!0},i.createElement(Ms.W,null,i.createElement(ye.K0,{"aria-label":"volume button",disabled:!t.volume,onClick:n,"data-testid":"volume_button_"+(e?"mute":"default"),icon:e?kc||(kc=i.createElement(_c.V,null)):Tc||(Tc=i.createElement(vc.s,null)),variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},size:"small"})),Cc||(Cc=i.createElement(Us.h,{w:"240px","data-testid":"volume_menu"},i.createElement(Fs.R,null),i.createElement(zs.e,null,i.createElement(bc,null)))))};var Ic,wc,Pc,xc;uc.i7`
	0% {opacity: 1}
	50% {opacity: 0.2}
	100% {opacity: 1}
`;const Nc=()=>{const e=(0,s.wA)(),{playerUI:t,hasLyrics:n,playerLyrics:a,isOnline:r,list:o,playerQueuelist:l,playerFull:c,casting:d,connecting:u,active:p}=(0,s.d4)((e=>({playerUI:(0,Xi.Cu)(e),hasLyrics:(0,_r.jk)(e),playerLyrics:e.player.config.playerLyrics,isOnline:e.app.online,list:e.player.music.list,playerQueuelist:e.player.config.playerQueuelist,playerFull:e.player.config.playerFull,connecting:e.player.chromecast.connecting,casting:e.player.chromecast.casting,active:e.player.chromecast.active}))),m=t.lyrics&&n&&r;return i.createElement(Qo.e,{size:"small",alignItems:"center",width:"33%",justifyContent:"flex-end",spacing:"spacing.xs"},m&&i.createElement(ki.m,{label:a?(0,X.AP)("lyrics_action_hidelyrics_web"):(0,X.AP)("Afficher les paroles")},i.createElement(ye.K0,{"data-testid":"lyrics_button",icon:Ic||(Ic=i.createElement(Vi.c,null)),variant:"ghost",isActive:a,_active:{color:"icon.accent.primary.default",bg:"transparent"},onClick:()=>{e(a?(0,qi.no)(!1):(0,qi.IG)(!0)),Be.Ay.isPaused()||Be.Ay.isPlaying()||Be.Ay.control.play()},"aria-label":a?(0,X.AP)("lyrics_action_hidelyrics_web"):(0,X.AP)("Afficher les paroles")})),t.queuelist&&i.createElement(ye.K0,{"data-testid":"queue_list_button","aria-label":"open queuelist",variant:"ghost",isActive:l,_active:{color:"icon.accent.primary.default",bg:"transparent"},isDisabled:!o.length,onClick:()=>{e(l?(0,qi.no)(!c):(0,qi.PV)(!0))},icon:wc||(wc=i.createElement(pc.j,null))}),((()=>{try{var e;const t=null===(e=navigator.userAgentData)||void 0===e?void 0:e.brands;return t?t.some((e=>"Google Chrome"===e.brand)):/Chrome/.test(navigator.userAgent)}catch{return/Chrome/.test(navigator.userAgent)}})(),null),Pc||(Pc=i.createElement(Sc,null)),xc||(xc=i.createElement(fc,null)))};var Rc=n("p2PB");var Oc=n("qBrz"),Dc=n("FvhZ"),Mc=n("DFyM"),Uc=n("JPje");const Fc={buffer:0,volume:0,repeat:0,shuffle:!1,mute:!1,playing:!1,paused:!1,loading:!1,hasPrev:!1,hasNext:!1,hasRepeat:!1,hasShuffle:!1,normalized:!0};var zc=n("PIVb");const qc={available:!1,connecting:!1,casting:!1,loading:!1,active:!1,chunksInfo:{},skipLimited:!1};var Bc=n("5LFp");const Gc={isRadio:!1,isUpnext:!1,isFlow:!1,isMyFlow:!1,isBlindTestMode:!1,playerType:"",playerFull:!1,playerQueuelist:!1,playerLyrics:!1};var Qc=n("FMs+");let Hc=function(e){return e.SET_TONE="components/Player/ui/SET_TONE",e.SET_COLOR="components/Player/ui/SET_COLOR",e}({});const Vc={tone:(0,Qc.Q5)(),backgroundColor:(0,Qc.D8)()[0],isLightMode:(0,Qc.D8)()[1]};let Yc={statusExclamationMark:80,object:null,type:"no_restriction",init:function(){try{if(z.A.getState().user.id<=0||(0,T.jQ)(z.A.getState().user))return!1;if(z.A.getState().user.USER.OPTIONS.web_streaming&&0===z.A.getState().user.USER.OPTIONS.web_streaming_duration)return!1;bt.A.call({method:"restriction.get",data:{},success:function(e){e&&(Yc.object=e,Math.round((new Date).getTime()/1e3)<Yc.object.date_end_discover?Yc.type="discovery_unlimited":(Yc.type="discovery",E.A.subscribe(E.A.player.updateRestrictTime,Yc.updateRestrictTime)))}})}catch(e){v.A.error(e)}return!0},updateRestrictTime:function(e,t){return Yc.object.time_left-=t,Yc.object.time_used+=t,Yc.object.percent=100*Yc.object.time_used/(Yc.object.time_used+Yc.object.time_left),Yc.object.percent=Math.min(Yc.object.percent,100),!0}};const jc=Yc;var Kc=n("AY3M");const $c=(0,Pe.Us)(Ne.Ay.Album),Jc=(0,Pe.Pe)(Ne.Ay.Artist,Kc.sI),Xc=(0,Pe.Pe)(Ne.Ay.Playlist,Kc.lh),Zc=(0,Pe.Us)(Ne.Ay.Episode),ed=(0,Pe.Pe)(Ne.Ay.User,Kc.N_),td=(0,Pe.Pe)(Ne.Ay.Album,Kc.LF),nd=(0,Pe.Pe)(Ne.Ay.Artist,Kc.LF),ad=(0,Pe.Pe)(Ne.Ay.Playlist,Kc.LF),id=(0,Pe.Pe)(Ne.Ay.Radio,Kc.LF),sd=(0,Pe.Pe)(Ne.Ay.Track,Kc.LF),rd=(0,Pe.Us)(Ne.Ay.Livestream),od=(0,Pe.Us)(Ne.Ay.Playlist),ld=(0,Pe.Pe)(Ne.Ay.User,Kc.N_),cd=(0,Pe.Us)(Ne.Ay.Radio),dd=(0,Pe.Pe)(Ne.Ay.Artist,Kc.Gv),ud=(0,Pe.Us)(Ne.Ay.Show),pd=(0,Pe.Us)(Ne.Ay.Smarttracklist),md=(0,Pe.Us)(Ne.Ay.Track),hd={album:$c,artist:Jc,episode:Zc,flow:ed,landingalbum:td,landingartist:nd,landingplaylist:ad,landingradio:id,landingtrack:sd,livestream:rd,playlist:od,profile:ld,mix:cd,mixes:dd,show:ud,smarttracklist:pd,track:md},yd=/.*\/([0-9]+).*/,gd=/.*\/smarttracklist\/([0-9a-z-]+).*/;var Ad=n("DNpT"),Ed=n("w2Jm"),fd=n("IZwO"),_d=n("RuKb"),vd=n("2dhM");let bd=!1;const kd=({getState:e,dispatch:t},n)=>{const a=n?n.offset:Math.floor(Be.Ay.getPosition()),i=n?n.id:Be.Ay.getSongId(),s=n?n.type:Be.Ay.getMediaType(),r=n?n.duration:Be.Ay.getDuration();if(!i||!s||!r)return;const o=(0,Ed.qx)(String(s));if(null===o)return;const l=(0,_d.v6)(e().bookmarks,o,String(i));(l?(0,Ad.Ki)(l,a,r):(0,Ad.Ht)(o,String(i),a,r)).then((e=>{t((0,fd.S8)(e))}))};var Cd=n("dn5u"),Sd=n.n(Cd);const Id=Sd()(),wd="LIMITATION";function Pd(e,[t]){var n;t&&t.VALUE&&!Number(t.VALUE.USER_ID)||Id!==(null==t||null===(n=t.VALUE)||void 0===n?void 0:n.UNIQID)&&E.A.trigger(E.A.live.simultaneousAccess)}n("hB5o"),n("LvTk");var xd=n("YNBm");class Nd{constructor(){(0,xd.A)(this).list=[]}add(e){const t=(0,xd.A)(this);return t.list=t.list.filter((t=>t.name!==e.name)),t.list.push(e),this}clear(){return(0,xd.A)(this).list.length=0,this}has(e={}){return Boolean((0,xd.A)(this).list.filter((t=>Object.keys(e).reduce(((n,a)=>n&&t[a]===e[a]),!0))).length)}pause(){return(0,xd.A)(this).paused=!0,this}prioritize(e={}){const t=(0,xd.A)(this),n=t.list.filter((t=>Object.keys(e).reduce(((n,a)=>n&&t[a]===e[a]),!0)));if(n.length){const e=n[n.length-1];return t.list=t.list.filter((e=>n.indexOf(e)<0)),t.list.unshift(e),!0}return!1}resume(){return(0,xd.A)(this).paused=!1,this.run(),this}run(){const e=(0,xd.A)(this);if(e.paused||e.running)return this;const t=e.list[0];if(t){const a=Date.now();if(t.timeout&&self.clearTimeout(t.timeout),t.timestamp>a)return t.timeout=self.setTimeout((()=>this.run()),t.timestamp-a),this;e.list.shift(),e.running=!0;const i=t.fn();(n=i,!Boolean(n)||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof n.then?Promise.resolve():i).catch((e=>v.A.error(e))).then((()=>{e.running=!1,this.run()}))}var n;return this}}var Rd=n("8VJL"),Ld=n("LURY");const Od={};let Dd;function Md(e){const t={from:e.getAttribute("from"),to:e.getAttribute("to")},n=e.getElementsByTagName("items")[0];t.node=n?n.getAttribute("node"):void 0;const a=e.getElementsByTagName("payload")[0]||e.getElementsByTagName("item")[0];t.payload=a.childNodes.length?a.childNodes[0].textContent:void 0;try{t.payload=JSON.parse(t.payload)}catch(e){}return t}function Ud(e){const t=Md(e);return((0,xd.A)(this).listeners.message||[]).filter((e=>Object.keys(e.options||{}).reduce(((n,a)=>n&&(Array.isArray(e.options[a])?e.options[a]:[e.options[a]]).indexOf(t[a])>-1),!0))).forEach((e=>{try{e.fn(t)}catch(e){this.emit("error",e)}})),!0}function Fd(e){const t={client:e.getAttribute("from"),type:e.getAttribute("type")};return t.client!==this.socket.jid&&this.emit("presence",t),!0}Ld.aC.Builder.prototype.cdata||(Ld.aC.Builder.prototype.cdata=function(e){return this.node.appendChild(Ld.aC.xmlGenerator().createCDATASection(e)),this});class AuthenticationError extends Rd.A{}class ConnectionError extends Rd.A{}class zd{static get singleton(){const e=(0,Dn.WV)({itemType:ua.Wi.CONFIG,itemName:"messaging"})||ma.default.get("host_messaging");return Dd||(Dd=new zd({endpoint:`wss://${e}/websocket`,jid:`${z.A.getState().user.id}@${e}`,password:z.A.getState().user.USER_TOKEN}))}constructor({endpoint:e="",id:t=Sd()(),jid:n,password:a}={}){this.id=t,Object.defineProperty(this,"endpoint",{value:e}),Object.defineProperty(this,"jid",{value:n}),Object.defineProperty(this,"password",{value:a}),Object.defineProperty(this,"socket",{value:new Ld.aC.Connection(e)});const i=(0,xd.A)(this);i.listeners={},i.retries=0}connect(){const e=(0,xd.A)(this);if(e.connecting)return e.connecting;if(this.socket.connected)return Promise.resolve();const t=e.connecting=new Promise(((t,n)=>{e.connected=(e,a)=>e?n(e):t(a)}));return this.socket.connect(this.jid,this.password,function t(n,a){switch(n){case Ld.aC.Status.ERROR:this.emit("error",new Error(a));break;case Ld.aC.Status.CONNFAIL:case Ld.aC.Status.CONNTIMEOUT:this.emit("error",new ConnectionError(a||"Timeout"));break;case Ld.aC.Status.AUTHFAIL:a=new AuthenticationError,this.emit("error",a),e.connected(a),e.retries=0,delete e.connecting,delete e.connected;break;case Ld.aC.Status.CONNECTED:this.socket.addHandler(Ud.bind(this),null,"message"),this.socket.addHandler(Fd.bind(this),null,"presence"),this.emit("connect"),e.connected(),e.retries=0,delete e.connecting,delete e.connected;break;case Ld.aC.Status.DISCONNECTED:this.emit("disconnect"),e.disconnecting?(e.disconnected(),delete e.disconnecting,delete e.disconnected,delete this.socket.connect_callback):self.setTimeout((()=>e.connecting?this.socket.connect(this.jid,this.password,t.bind(this)):this.connect()),1e3*(Math.random()*(Math.pow(2,++e.retries)-Math.pow(2,e.retries-1))+Math.pow(2,e.retries-1)));case Ld.aC.Status.CONNECTING:case Ld.aC.Status.AUTHENTICATING:case Ld.aC.Status.DISCONNECTING:case Ld.aC.Status.ATTACHED:case Ld.aC.Status.REDIRECT:}}.bind(this)),t}disconnect(){const e=(0,xd.A)(this);if(this===Dd)return Promise.reject(new Error("Cannot disconnect the singleton since the socket might be used somewhere else."));if(e.disconnecting)return e.disconnecting;if(!this.socket.connected)return Promise.resolve();const t=e.disconnecting=new Promise(((t,n)=>{e.disconnected=(e,a)=>e?n(e):t(a)}));return this.socket.disconnect(),t}emit(e,...t){((0,xd.A)(this).listeners[e]||[]).forEach((e=>{try{e.fn(...t)}catch(e){this.emit("error",e)}}))}get(e,t={}){const n=new Ld.aC.Builder("iq",{from:this.jid,type:"get"}).c("pubsub",{xmlns:"http://jabber.org/protocol/pubsub"}).c("items",{node:e});return this.connect().then((()=>new Promise(((e,a)=>this.socket.sendIQ(n,(t=>e(Md(t))),a,t.timeout)))))}off(e,t){const n=(0,xd.A)(this),a=n.listeners[e]||[];let i=a.length;for(;i--;)t&&a[i]!==t||a.splice(i,1);a.length||delete n.listeners[e]}on(e,t,n){const a=(0,xd.A)(this);a.listeners[e]=a.listeners[e]||[],a.listeners[e].push({fn:t,options:n})}post(e,t,n={}){const a=new Ld.aC.Builder("iq",{from:this.jid,type:"set"}).c("pubsub",{xmlns:"http://jabber.org/protocol/pubsub"}).c("publish",{node:e}).c("item").cdata("string"==typeof t?t:JSON.stringify(t));return this.connect().then((()=>new Promise((function e(t){const n=Math.floor(Date.now()/1e3);return Object.keys(Od).filter((e=>e<n)).forEach((e=>delete Od[e])),Od[n]>=10?self.setTimeout((()=>e(t)),1e3):(Od[n]=(Od[n]||0)+1,t())})))).then((()=>new Promise(((e,t)=>this.socket.sendIQ(a,e,t,n.timeout)))))}presence(e,t={}){return this.connect().then((()=>new Promise(((n,a)=>this.socket.sendPresence(new Ld.aC.Builder("presence",e),n,a,t.timeout)))))}}zd.AuthenticationError=AuthenticationError,zd.ConnectionError=ConnectionError;const qd=zd;var Bd=n("wlv8"),Gd=n.n(Bd),Qd=n("nLzw"),Hd=n("MVPB"),Vd=n("4OMY"),Wd=n("77Ru"),Yd=n.n(Wd);const jd=new Map([[qe.EV.ALL,Yd().com.deezer.kmp.player.models.RepeatMode.All],[qe.EV.OFF,null],[qe.EV.SINGLE,Yd().com.deezer.kmp.player.models.RepeatMode.One]]),Kd={[qe.Cc.ADS]:null,[qe.Cc.CHROMECAST]:null,[qe.Cc.JINGLE]:null,[qe.Cc.LIVESTREAM]:null,[qe.Cc.MOD]:Yd().com.deezer.kmp.player.models.ListenType.MOD,[qe.Cc.RADIO]:Yd().com.deezer.kmp.player.models.ListenType.SMART_RADIO,[qe.Cc.TRITON_AD]:null},$d={[qe.zu.SONG]:Yd().com.deezer.kmp.player.models.PlayableType.TRACK,[qe.zu.LIVE_STREAM]:Yd().com.deezer.kmp.player.models.PlayableType.LIVESTREAM,[qe.zu.EPISODE]:Yd().com.deezer.kmp.player.models.PlayableType.PODCAST_EPISODE};var Jd=(0,Vd.A)("log"),Xd=(0,Vd.A)("dzPlayer"),Zd=(0,Vd.A)("playerStateEmitter"),eu=(0,Vd.A)("getUnshuffledTrackOrder"),tu=(0,Vd.A)("setIsActive"),nu=(0,Vd.A)("tranformCBQLTracklistToDzPlayerTracklist"),au=(0,Vd.A)("transformDzPlayerTracklistToCBQLTracklist");class iu{constructor(e,t,n){Object.defineProperty(this,au,{value:lu}),Object.defineProperty(this,nu,{value:ou}),Object.defineProperty(this,tu,{value:ru}),Object.defineProperty(this,eu,{value:su}),Object.defineProperty(this,Jd,{writable:!0,value:void 0}),Object.defineProperty(this,Xd,{writable:!0,value:void 0}),Object.defineProperty(this,Zd,{writable:!0,value:void 0}),this.playerState=void 0,this._hydrateDzPlayerTracks=void 0,(0,Hd.A)(this,Jd)[Jd]=n,(0,Hd.A)(this,Xd)[Xd]=e,this._hydrateDzPlayerTracks=t;const a=(0,Hd.A)(this,Xd)[Xd].getRepeat();(0,Hd.A)(this,Zd)[Zd]=new(Yd().com.deezer.kmp.mp.async.MPStateFlowEmitter)(new(Yd().com.deezer.kmp.queuesync.api.DzAppPlayerState)(new(Yd().com.deezer.kmp.queuesync.models.DzAppQueueState)(Yd().com.deezer.kmp.queuesync.models.DzAppQueueType.BasicQueueList,jd.get(a),(0,Hd.A)(this,Xd)[Xd].getTrackListIndex(),(0,Hd.A)(this,au)[au]([]),(0,Hd.A)(this,Xd)[Xd].isShuffle()?Yd().com.deezer.kmp.mp.copyToMPList((0,Hd.A)(this,eu)[eu]()):null),(0,Hd.A)(this,Xd)[Xd].isPlaying(),!1)),this.playerState=(0,Hd.A)(this,Zd)[Zd].flow(),E.A.subscribe(E.A.player.play,(()=>(0,Hd.A)(this,tu)[tu](!0))),E.A.subscribe(E.A.player.playing,((e,t)=>(0,Hd.A)(this,tu)[tu](t))),E.A.subscribe(E.A.player.paused,((t,n)=>(0,Hd.A)(this,tu)[tu](!!e.isPlaying()&&!n)))}dispatch(e){if(e instanceof Yd().com.deezer.kmp.queuesync.api.DzAppPlayerAction.SetQueue){const t=this.playerState.value.queueState.copy();(0,Hd.A)(this,Jd)[Jd]("Receving new state from CBQL",e.queueState),(0,Hd.A)(this,Zd)[Zd].emit(this.playerState.value.copy(e.queueState)),(0,Hd.A)(this,nu)[nu](e.queueState.queueTrackList).then((n=>{if(!n)return;const a=n.filter((({context:{TYPE:e}})=>"up_next_artist"===e)),i=a.length?n.slice(0,n.indexOf(a[0])):n;if(t.copy(t.queueType,t.repeatMode,e.queueState.queuePosition).equals(e.queueState))return void(0,Hd.A)(this,Xd)[Xd].setTriforceIndex(e.queueState.queuePosition);var s;if(t.copy(t.queueType,e.queueState.repeatMode).equals(e.queueState))return void(0,Hd.A)(this,Xd)[Xd].control.setRepeat(null===(s=jd.entries().find((([,t])=>t===e.queueState.repeatMode)))||void 0===s?void 0:s[0],{sync:!1});const r=e.queueState.queueType instanceof Yd().com.deezer.kmp.queuesync.models.DzAppQueueType.InfiniteQueueList?e.queueState.queueType.context.listenType===Yd().com.deezer.kmp.player.models.ListenType.SMART_RADIO:e.queueState.queueTrackList.get(e.queueState.queuePosition).itemContext.listenType===Yd().com.deezer.kmp.player.models.ListenType.SMART_RADIO,o={original:i,tracks:e.queueState.queuePlayingOrder?Yd().com.deezer.kmp.mp.copyToJsArray(e.queueState.queuePlayingOrder).map((e=>i[e])):i,recommended:a,shuffled:null!==e.queueState.queuePlayingOrder,index:e.queueState.queuePosition,radio:r};(0,Hd.A)(this,Jd)[Jd]("Sending queuelist to dzPlayer",o),(0,Hd.A)(this,Xd)[Xd].setTriforceState(o)}))}}setRepeat(e){(0,Hd.A)(this,Zd)[Zd].emit(this.playerState.value.copy(this.playerState.value.queueState.copy(this.playerState.value.queueState.queueType,jd.get(e)))),(0,Hd.A)(this,Jd)[Jd]("Sending new state to CBQL for repeatMode",this.playerState.value)}setTracklist(e,t=0){(0,Hd.A)(this,Zd)[Zd].emit(this.playerState.value.copy(this.playerState.value.queueState.copy(Yd().com.deezer.kmp.queuesync.models.DzAppQueueType.BasicQueueList,this.playerState.value.queueState.repeatMode,t,(0,Hd.A)(this,au)[au](e.tracks),e.shuffled?Yd().com.deezer.kmp.mp.copyToMPList(e.tracks_order):null))),(0,Hd.A)(this,Jd)[Jd]("Sending new state to CBQL for a tracklist ",this.playerState.value)}setTracklistIndex(e){(0,Hd.A)(this,Zd)[Zd].emit(this.playerState.value.copy(this.playerState.value.queueState.copy(this.playerState.value.queueState.queueType,this.playerState.value.queueState.repeatMode,e))),(0,Hd.A)(this,Jd)[Jd]("Sending new state to CBQL for the tracklist index",this.playerState.value)}}function su(){const e=(0,Hd.A)(this,Xd)[Xd].getTrackList(!0,!1);return(0,Hd.A)(this,Xd)[Xd].getTrackList(!0,!0).map((t=>e.findIndex((e=>e===t))))}function ru(e){(0,Hd.A)(this,Zd)[Zd].emit(this.playerState.value.copy(this.playerState.value.queueState.copy(),e)),(0,Hd.A)(this,Jd)[Jd]("Setting isActive locally - aka is playing",this.playerState.value)}async function ou(e){if(!e.size)return;let t=!1;const n=Yd().com.deezer.kmp.mp.copyToJsArray(e),a=await Promise.all([this._hydrateDzPlayerTracks("songs",n.filter((e=>e.identifier.type===Yd().com.deezer.kmp.player.models.PlayableType.TRACK)).map((e=>e.identifier.playableId))),this._hydrateDzPlayerTracks("episodes",n.filter((e=>e.identifier.type===Yd().com.deezer.kmp.player.models.PlayableType.PODCAST_EPISODE)).map((e=>e.identifier.playableId))),this._hydrateDzPlayerTracks("lives",n.filter((e=>e.identifier.type===Yd().com.deezer.kmp.player.models.PlayableType.LIVESTREAM)).map((e=>e.identifier.playableId)))]).then((([e,a,i])=>{const s=[];return n.map((n=>{const{itemContext:{contextContainer:r,contextId:o,contextType:l}}=n,c={CONTEXT_ID:r||void 0,ID:o,TYPE:l};let d=s.findIndex((e=>(0,Qd.A)(e,c)));switch(d<0&&(d=s.push(c)-1),n.identifier.type){case Yd().com.deezer.kmp.player.models.PlayableType.TRACK:return{data:e.find((({SNG_ID:e})=>e.toString()===n.identifier.playableId)),context:s[d]};case Yd().com.deezer.kmp.player.models.PlayableType.PODCAST_EPISODE:return{data:a.find((({EPISODE_ID:e})=>e.toString()===n.identifier.playableId)),context:s[d]};case Yd().com.deezer.kmp.player.models.PlayableType.LIVESTREAM:return{data:i.find((({LIVESTREAM_ID:e})=>e.toString()===n.identifier.playableId)),context:s[d]};default:t=!0}}))}));return t?a.filter(Boolean):a}function lu(e){return Yd().com.deezer.kmp.mp.copyToMPList(e.map((e=>Yd().com.deezer.kmp.queuesync.models.DzAppQueueItem.withDefaults(new(Yd().com.deezer.kmp.player.models.PlayableIdentifier)(e.type in $d?$d[e.type]:$d[qe.zu.SONG],e.id),new(Yd().com.deezer.kmp.queuesync.models.DzAppStreamContext)(e.context.ID.toString(),e.context.TYPE,e.context.CONTEXT_ID||null,Kd[(0,Hd.A)(this,Xd)[Xd].getPlayerType()]||Yd().com.deezer.kmp.player.models.ListenType.MOD)))))}var cu=(0,Vd.A)("topic"),du=(0,Vd.A)("realtimeStateEmitter"),uu=(0,Vd.A)("messageReceivedEmitter"),pu=(0,Vd.A)("onCBQLMessage");class mu{constructor(e){Object.defineProperty(this,cu,{writable:!0,value:void 0}),Object.defineProperty(this,du,{writable:!0,value:new(Yd().com.deezer.kmp.mp.async.MPStateFlowEmitter)(Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Stopped)}),this.realtimeState=(0,Hd.A)(this,du)[du].flow(),Object.defineProperty(this,uu,{writable:!0,value:new(Yd().com.deezer.kmp.mp.async.MPStateFlowEmitter)("")}),this.jsonMessageReceived=(0,Hd.A)(this,uu)[uu].flow(),Object.defineProperty(this,pu,{writable:!0,value:(e,[t])=>{(0,Hd.A)(this,uu)[uu].emit(JSON.stringify(t))}}),(0,Hd.A)(this,cu)[cu]=`${e}_${e}_${Yd().com.deezer.kmp.queuesync.api.realtime.QUEUESYNC_RELIVE_CHANNEL_NAME}`,_.A.addChannel((0,Hd.A)(this,cu)[cu]),_.A.connected?(0,Hd.A)(this,du)[du].emit(Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Connected):((0,Hd.A)(this,du)[du].emit(Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Connecting),E.A.subscribe(E.A.live.connected,(()=>{(0,Hd.A)(this,du)[du].emit(Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Connected)}))),E.A.subscribe(E.A.live.cbql,(0,Hd.A)(this,pu)[pu])}dispatchRealtimeAction(e){if(e===Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeAction.Stop)return _.A.deleteChannel((0,Hd.A)(this,cu)[cu]),void(0,Hd.A)(this,du)[du].emit(Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Stopped);e===Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeAction.Start&&(_.A.addChannel((0,Hd.A)(this,cu)[cu]),(0,Hd.A)(this,du)[du].emit(Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Connected)),e instanceof Yd().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeAction.SendMessage&&_.A.publish((0,Hd.A)(this,cu)[cu],JSON.parse(e.jsonPayload))}}var hu=(0,Vd.A)("userID"),yu=(0,Vd.A)("queueSynchronizer");class gu{constructor(e,t,n,a,i=!1){Object.defineProperty(this,hu,{writable:!0,value:void 0}),Object.defineProperty(this,yu,{writable:!0,value:void 0}),(0,Hd.A)(this,hu)[hu]=n;const s=`https://${(0,Dn.WV)({itemType:ua.Wi.CONFIG,itemName:"pipe"})||ma.default.get("host_pipe")}/api`;(0,Hd.A)(this,yu)[yu]=(new(Yd().com.deezer.kmp.queuesync.DzQueueSynchronizerFactory)).create(new(Yd().com.deezer.kmp.pipe.apollo.NetworkClientsFactory)(s).create(Yd().com.deezer.kmp.pipe.apollo.jwt.sharedJwtTokenProvider({providesToken:e=>{(0,Mn.gf)("0"!==n).then((t=>{e.onResult(t)}))},forceExpiredToken:Mn.M4,canRetryRequest:()=>!0}),"undefined"!=typeof window?window.navigator.userAgent:""),Yd().com.deezer.kmp.time.api.sharedServerTimeProvider({get currentTimeMillis(){return Yd().com.deezer.kmp.mp.toMPLong(a())}}),Yd().com.deezer.kmp.queuesync.api.sharedDzAppPlayer(e),Yd().com.deezer.kmp.queuesync.api.realtime.sharedQueueSyncRealtimeClient(t)),i&&Yd().com.deezer.kmp.helper.Logger_setLogWriter(Yd().com.deezer.kmp.helper.sharedLogWriter(console))}set enable(e){e?(0,Hd.A)(this,yu)[yu].dispatchAction(new(Yd().com.deezer.kmp.queuesync.api.QueueSyncAction.Start)((0,Hd.A)(this,hu)[hu])):(0,Hd.A)(this,yu)[yu].dispatchAction(Yd().com.deezer.kmp.queuesync.api.QueueSyncAction.Stop)}}var Au=n("c33K");let Eu=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ALBUM=1]="ALBUM",e[e.ARTIST=2]="ARTIST",e[e.CHARTS=3]="CHARTS",e[e.FAMILY=4]="FAMILY",e[e.GENRE=5]="GENRE",e[e.HISTORY=6]="HISTORY",e[e.PLAYLIST=7]="PLAYLIST",e[e.SEARCH=8]="SEARCH",e[e.SONG=9]="SONG",e[e.USER=10]="USER",e[e.OFFLINE=11]="OFFLINE",e}({}),fu=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ARTIST=1]="ARTIST",e}({}),_u=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ALBUM=1]="ALBUM",e[e.LIVE=3]="LIVE",e[e.MIX=4]="MIX",e[e.PERSONAL=5]="PERSONAL",e[e.PLAYLIST=6]="PLAYLIST",e[e.PODCAST=7]="PODCAST",e[e.RECOMMENDED=8]="RECOMMENDED",e[e.SHUFFLE_MY_MUSIC=9]="SHUFFLE_MY_MUSIC",e[e.SMART_TRACKLIST=10]="SMART_TRACKLIST",e[e.TOP_TRACKS=11]="TOP_TRACKS",e}({}),vu=function(e){return e[e.SONG=0]="SONG",e[e.EPISODE=2]="EPISODE",e[e.LIVE=3]="LIVE",e}({}),bu=function(e){return e[e.NONE=0]="NONE",e[e.ALL=1]="ALL",e[e.ONE=2]="ONE",e}({});class ku extends Au.G{constructor(){super("IndexChanged",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"index",kind:"scalar",T:13},{no:3,name:"timestamp",kind:"scalar",T:4,L:2}])}}const Tu=new ku;class Cu extends Au.G{constructor(){super("ListChanged",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"contexts",kind:"message",repeat:1,T:()=>wu},{no:3,name:"tracks",kind:"message",repeat:1,T:()=>Fu},{no:4,name:"tracks_order",kind:"scalar",localName:"tracks_order",repeat:1,T:13},{no:5,name:"shuffled",kind:"scalar",T:8},{no:6,name:"timestamp",kind:"scalar",T:4,L:2}])}}const Su=new Cu;class Iu extends Au.G{constructor(){super("ListChanged.Context",[{no:1,name:"container",kind:"message",T:()=>xu},{no:2,name:"log",kind:"message",T:()=>Mu}])}}const wu=new Iu;class Pu extends Au.G{constructor(){super("ListChanged.Context.Container",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.ContainerType",_u]},{no:3,name:"mix",kind:"message",oneof:"extra",T:()=>Ru},{no:4,name:"smart_tracklist_method",kind:"scalar",localName:"smart_tracklist_method",oneof:"extra",T:9},{no:5,name:"topTracks",kind:"message",oneof:"extra",T:()=>Ou}])}}const xu=new Pu;class Nu extends Au.G{constructor(){super("ListChanged.Context.Container.Mix",[{no:1,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.Mix.MixType",Eu]}])}}const Ru=new Nu;class Lu extends Au.G{constructor(){super("ListChanged.Context.Container.TopTracks",[{no:1,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.TopTracks.TopTracksType",fu]}])}}const Ou=new Lu;class Du extends Au.G{constructor(){super("ListChanged.Context.Log",[{no:1,name:"context_id",kind:"scalar",localName:"context_id",T:9},{no:2,name:"listening_context",kind:"scalar",localName:"listening_context",T:9}])}}const Mu=new Du;class Uu extends Au.G{constructor(){super("ListChanged.Track",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"context",kind:"scalar",T:13},{no:3,name:"type",kind:"enum",T:()=>["ListChanged.Track.TrackType",vu]}])}}const Fu=new Uu;class zu extends Au.G{constructor(){super("RepeatChanged",[{no:1,name:"repeat",kind:"enum",T:()=>["RepeatChanged.RepeatMode",bu]}])}}const qu=new zu;var Bu=n("oEcL"),Gu=n("ij5m"),Qu=n("zCrf"),Hu=n("ISNy");let Vu;const Wu=[Su],Yu=new Nd,ju=new Nd,Ku={paused:!0},$u={stack:[]};function Ju(...e){$u.console&&window.console.log("[TRIFORCE]",...e),$u.enabled&&$u.stack.push(e)}const Xu={songs:Qu.d0,episodes:Bu.l$,lives:Gu.qS},Zu={songs:Hu.KW,episodes:Bu.KN,lives:Gu.b2};function ep(e){const t=[],n=e.music.unshuffledList.map(((e,n)=>{const a=Be.Ay.getContextByIndexFromOriginal(n),i={container:{id:a.ID,extra:{}},log:{context_id:a.CONTEXT_ID||"",listening_context:a.TYPE}};let s,r=t.findIndex((e=>(0,Qd.A)(e,i)));switch(r<0&&(r=t.push(i)-1),Be.Ay.getMediaType(e)){case qe.zu.EPISODE:s=vu.EPISODE;break;case qe.zu.LIVE_STREAM:s=vu.LIVE;break;default:s=vu.SONG}return{context:r,id:String(e[Be.Ay.getMediaId(e)]),type:s}})),a=[],i=e.music.list.map(((t,n)=>{let i=0;const s=Be.Ay.getContextByIndex(n),r=t[Be.Ay.getMediaId(t)],o=e.music.unshuffledList.filter((e=>e[Be.Ay.getMediaId(e)]===t[Be.Ay.getMediaId(t)])).filter((t=>(0,Qd.A)(s,Be.Ay.getContextByIndexFromOriginal(e.music.unshuffledList.indexOf(t)))));return o.length>1&&(i=a.filter((e=>r===e)).length,a.push(r)),e.music.unshuffledList.indexOf(o[i])}));t.forEach((({container:e,log:{listening_context:t,context_id:n=""}})=>{if(/album(?!_similar)|artist_discography/i.test(t))e.type=_u.ALBUM;else if(/livestream/.test(t))e.type=_u.LIVE;else if(/personal/.test(t))e.type=_u.PERSONAL;else if(/playlist(?!_radio)/.test(t))e.type=_u.PLAYLIST;else if(/show/.test(t))e.type=_u.PODCAST;else if("up_next_artist"===t)e.type=_u.RECOMMENDED;else if(/^shuffled/.test(t))e.type=_u.SHUFFLE_MY_MUSIC;else if(/smarttracklist/.test(t)){const t=n.split(",").filter((e=>e.startsWith("card_name"))).map((e=>e.split("=")[1])).shift()||"";e.type=_u.SMART_TRACKLIST,e.extra={oneofKind:"smart_tracklist_method",smart_tracklist_method:t}}else/artist|smartradio/.test(t)?(e.type=_u.MIX,e.extra={oneofKind:"mix",mix:{type:Eu.ARTIST}}):"history_radio"===t||"playlist_radio"===t?(e.type=_u.MIX,e.extra={oneofKind:"mix",mix:{type:Eu.HISTORY}}):"search_radio"===t?(e.type=_u.MIX,e.extra={oneofKind:"mix",mix:{type:Eu.SEARCH}}):/user|flow/.test(t)?(e.type=_u.MIX,e.extra={oneofKind:"mix",mix:{type:Eu.USER}}):/radio/i.test(t)?(e.type=_u.MIX,e.mix={type:Eu.DEFAULT}):e.type=_u.DEFAULT}));const s=!i.reduce(((e,t,n)=>e&&t===n),!0);return{contexts:t,id:Ku.id||Sd()(),shuffled:s,timestamp:Ku.now(),tracks:n,tracks_order:s?i:[]}}function tp(e,t){const n=atob(e),a=Array.from(n).map((e=>e.charCodeAt(0))),i=a.length&&Wu.includes(t)?Gd().inflate(new Uint8Array(a)):a;return t.fromBinary(new Uint8Array(i))}function np(e,t,n={}){const a={PlaybackCurrentIndex:Tu,PlaybackQueueList:Su,PlaybackRepeatMode:qu};let i;Ju(`Enqueueing a task to update ${e} with:`,t),n.defer&&(Ku.retries=(Ku.retries||0)+1,i=Date.now()+Math.round(Math.random()*(Math.pow(2,Ku.retries)-Math.pow(2,Ku.retries-1))*1e3)),Ku.retries>5?Ju(`Exceeded 5 retries (${e}), task won't be scheduled`):ju.add({name:e,timestamp:i,fn:()=>(Ju(`Sending to node ${e}:`,t),qd.singleton.post(e,function(e,t){const n=t.toBinary(e),a=n.length&&Wu.includes(t)?Gd().deflate(n,7):n;return btoa(String.fromCharCode(...a))}(t,a[e])||null))}).run()}function ap(e){const t=e/(Be.Ay.getDuration()||0);return Number.isFinite(t)?t:0}function ip(e){Be.Ay.isPlaying()||Be.Ay.control.play();const t=Be.Ay.getPosition()/(Be.Ay.getDuration()||0)+e;t>0&&t<1&&Be.Ay.control.seek(t)}let sp=!1;function rp(e,t){try{var n;navigator.mediaSession.setPositionState({duration:Math.max(null!==(n=Be.Ay.getDuration())&&void 0!==n?n:1/0,0),position:t})}catch(e){}}var lp=n("Z64h");function cp(e,t,n={}){e.dispatch((0,w.S7)(t,n))}const dp=({backgroundColor:e,isLightMode:t})=>({type:Hc.SET_COLOR,backgroundColor:e,isLightMode:t});var up=n("nMcH");const pp=new Image;let mp,hp=28;(0,up.A)()&&(hp*=2),(0,Dc.I7)((()=>e=>t=>{const n=e(t);return t.type===Mc.xo&&function(){E.A.subscribeOnce(E.A.player.tracklist_changed,(()=>E.A.resolve(E.A.player.playerReady))),E.A.subscribeOnce(E.A.player.playerLoaded,(()=>{Be.Ay.restoreSetting(z.A.getState().user.USER.SETTING)})),jc.init(),Be.Ay.html5.init();const t=hd[z.A.getState().app.currentPage]||Xc,n=["flow","landing"].includes(z.A.getState().app.currentPage),a=d.A.location&&d.A.location.query&&("true"===d.A.location.query.autoplay||"1"===d.A.location.query.autoplay);let i=z.A.getState().user.PLAYLIST_WELCOME_ID;t===ld?i=z.A.getState().user.USER.USER_ID:t===pd&&gd.test(d.A.location.pathname)?i=d.A.location.pathname.replace(gd,"$1"):t!==Xc&&yd.test(d.A.location.pathname)&&(i=d.A.location.pathname.replace(yd,"$1"));let s=ma.default.get("log_contexts")[t];switch(t){case Jc:s="topArtistFull";break;case td:case nd:case ad:case id:case sd:s=ma.default.get("log_contexts")[z.A.getState().app.currentPage]}Be.Ay.play({autoplay:n||a,context:{ID:i,TYPE:t},id:i,initializing:!0,sync:!1,type:s,radio:[cd,dd,ld].includes(t),callbackTrack(e){if(e.length)return;const t=z.A.getState().user.PLAYLIST_WELCOME_ID,n=Xc;Be.Ay.play({autoplay:!1,context:{ID:t,TYPE:n},id:t,initializing:!0,sync:!1,type:ma.default.get("log_contexts")[n]})}})}(),n}),(e=>t=>n=>{const a=e.getState().player.control.playing,i=t(n),s=e.getState().player.control.playing,r=e.getState().user.isAuth,o=e.getState().user.id;if(!r)return i;switch(n.type){case Mc.xo:!function(e){const t=`${e}_${e}_STREAM`;_.A.addChannel(t),E.A.subscribe(E.A.live[wd.toLocaleLowerCase()],Pd)}(o);break;case Uc.EC:!s||a||Be.Ay.chromecast.isCasting()||function(e){const t=`${e}_${e}_STREAM`,n=String(Be.Ay.getCurrentSong(Be.Ay.getMediaId())),a={ACTION:"PLAY",APP:wd,VALUE:{USER_ID:String(e),UNIQID:Id,SNG_ID:n}};_.A.publish(t,a)}(o)}return i}),(e=>t=>n=>{const a=e.getState(),i=t(n),s=e.getState(),r=f.A.isAllowed("kmp_queue_synchronizer"),o=f.A.isAllowed("queue_synchronizer");if(a===s)return i;if(!f.A.isAllowed("triforce_queuelist_messages")&&!o)return i;if(!(0,T.ki)(s.user))return i;if(Ku.now||(Ku.now=r?()=>(0,T.Wk)(s.user):()=>(0,T.mI)(s.user)),Ku.enabled!==(0,T.Qi)(s.user)){const l=void 0===Ku.enabled;if(Ku.enabled=(0,T.Qi)(s.user),!l)if(r)Ku.KMPSynchronizer.enable=Ku.enabled;else if(Ku.enabled){const c=e=>Vu[e.node](e);Promise.resolve().then((()=>qd.singleton.get("PlaybackQueueList").then(c))).then((()=>qd.singleton.get("PlaybackCurrentIndex").then(c))).then((()=>qd.singleton.get("PlaybackRepeatMode").then(c)))}else Yu.clear(),ju.clear(),delete Ku.id}if("enabled"in $u||($u.enabled=/triforce/i.test(window.location.search),$u.console=$u.enabled,$u.enabled&&(window.triforce={get console(){return $u.console},set console(e){$u.console=Boolean(e)},copy:()=>window.copy($u.stack),dump:()=>$u.stack.forEach((e=>window.console.log("[TRIFORCE]",...e)))})),n.type===Mc.xo){if(r){if(o){function d(t,n){if(!Xu[t]||!Zu[t])return Promise.resolve();const a=Zu[t];return(0,Xu[t])({ids:n})(e.dispatch,e.getState).then((()=>a(e.getState().entities,n)))}const u=(0,T.F6)(s.user);Ku.DzAppPlayerApi=new iu(Be.Ay,d,Ju),Ku.KMPSynchronizer=new gu(Ku.DzAppPlayerApi,new mu(u),u,Ku.now),Ju("Initializing CBQL"),Ku.KMPSynchronizer.enable=Ku.enabled}return}E.A.subscribe(E.A.player.play,(()=>Ku.paused=!1)),E.A.subscribe(E.A.player.playing,((e,t)=>Ku.paused=!t)),E.A.subscribe(E.A.player.paused,((e,t)=>Ku.paused=!Be.Ay.isPlaying()||Boolean(t))),Vu={PlaybackCurrentIndex(t){const n=tp(t.payload,Tu);n&&(Ju("Received from PlaybackCurrentIndex node:",n),Yu.add({id:n.id,name:"PlaybackCurrentIndex",fn(){if(!Yu.prioritize({name:"PlaybackQueueList"})&&!Yu.prioritize({id:Ku.id,name:"PlaybackCurrentIndex"})&&!ju.has({name:"PlaybackQueueList"})){if(!Ku.paused||n.timestamp&&n.timestamp<Ku.timestamp){if(n.id!==Ku.id){Ju("Payload id isn't matching with the current one, sending the current state");const t=ep(e.getState().player);return np("PlaybackQueueList",t,{defer:!0}),void np("PlaybackCurrentIndex",{id:t.id,index:Be.Ay.getIndexSong(),timestamp:Ku.now()})}return n.index!==Be.Ay.getIndexSong()?(Ju("Currently playing, sending the current index"),void np("PlaybackCurrentIndex",{id:Ku.id,index:Be.Ay.getIndexSong(),timestamp:Ku.now()},{defer:!0})):void Ju("Asked to change for the same id, so this is a no-op")}(f.A.isAllowed("triforce_queuelist_ui")||"B"===(s.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&(delete Ku.retries,Ju("Updating the index with:",n.index),Be.Ay.setTriforceIndex(n.index))}}}).run())},PlaybackQueueList(t){const n=tp(t.payload,Su);if(!n)return;if(Ju("Received from PlaybackQueueList node:",{...n,tracks:n.tracks.map((e=>({...e})))}),n.id===Ku.id)return void Ju("Payload id is matching with the current one, stopping here.");if(!n.tracks.length)return void Ju("No tracks found in the payload, stopping here.");const a=n.contexts.map((({container:{id:e},log:{context_id:t,listening_context:n}})=>({CONTEXT_ID:t,ID:e,TYPE:n})));function i(t){if(!Xu[t]||!Zu[t])return Promise.resolve();const i=Xu[t],s=Zu[t],r=vu[t.substring(0,t.length-1).toUpperCase()]||vu.SONG,o=n.tracks.filter((e=>e.type===r)),l=o.map((e=>e.id));return i({ids:l})(e.dispatch,e.getState).then((()=>{const t=s(e.getState().entities,l);o.forEach(((e,i)=>{const s=e.context;Object.keys(e).forEach((t=>delete e[t])),e.context=a[s],e.data={...t[i]},"up_next_artist"===e.context.TYPE&&n.recommended.push(e)}))}))}n.recommended=[],Yu.add({name:"PlaybackQueueList",fn(){if(!Yu.prioritize({name:"PlaybackQueueList"}))return Promise.all([i("songs"),i("episodes"),i("lives")]).then((()=>{if(Yu.prioritize({name:"PlaybackQueueList"}))return;n.tracks=n.tracks.filter((e=>n.recommended.indexOf(e)<0)),n.original=[...n.tracks],n.tracks=n.tracks_order.length?n.tracks_order.map((e=>n.tracks[e])):n.tracks;const t={[Eu.ARTIST]:"artist",[Eu.USER]:"user"};if(n.recommended.length)n.radio="up_next_artist";else{const{container:e}=n.contexts[0];e.type===_u.LIVE?n.radio="livestream":e.type===_u.MIX&&(n.radio=t[e.extra.mix.type])}if(delete n.contexts,delete n.tracks_order,Ju("Hydrated the payload:",n),!Ku.paused||n.timestamp&&n.timestamp<Ku.timestamp){const{CONTEXT_ID:t,ID:a,TYPE:i}=Be.Ay.getContext(),s={CONTEXT_ID:t,ID:String(a),TYPE:i},r=Be.Ay.getMediaId(),o=Be.Ay.getCurrentSong(r),l=n.tracks.filter((e=>(0,Qd.A)(e.context,s))).filter((e=>e.data[r]===o));if(Ju("Currently playing, searching for the current track"),!l.length){Ju("Current track not found, sending the current state");const t=ep(e.getState().player);return np("PlaybackQueueList",t,{defer:!0}),void np("PlaybackCurrentIndex",{id:t.id,index:Be.Ay.getIndexSong(),timestamp:Ku.now()})}n.index=n.tracks.indexOf(l[0]),Ju("Current track found, sending the index in case of de-sync"),np("PlaybackCurrentIndex",{id:n.id,index:n.index,timestamp:Ku.now()})}(f.A.isAllowed("triforce_queuelist_ui")||"B"===(s.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&(delete Ku.retries,Ku.id=n.id,Ju("Updating the queuelist"),Be.Ay.setTriforceState(n))}))}}).run()},PlaybackRepeatMode(e){const t=null===e.payload?{repeat:0}:tp(e.payload,qu);Ju("Received from PlaybackRepeatMode node:",t),(f.A.isAllowed("triforce_queuelist_ui")||"B"===(s.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&Be.Ay.control.setRepeat(t?t.repeat:0,{sync:!1})}},qd.singleton.on("connect",(()=>{Ju("Socket connected, sending a presence signal"),ju.clear().resume(),qd.singleton.presence()})),qd.singleton.on("disconnect",(()=>{Ju("Socket disconnected, pausing the outgoing queue"),ju.pause()})),qd.singleton.on("message",(e=>Ku.enabled&&Vu[e.node](e)),{node:Object.keys(Vu)}),qd.singleton.connect()}if(!1===n.sync||!Ku.enabled)return i;switch(n.type){case Uc.yd:Ku.timestamp=Ku.now();break;case Uc.f6:a.player.control.repeat!==s.player.control.repeat&&(r?Ku.DzAppPlayerApi.setRepeat(s.player.control.repeat):(delete Ku.retries,np("PlaybackRepeatMode",{repeat:s.player.control.repeat})));break;case Mc.Qx:if(!(0,Qd.A)(a.player.music.list,s.player.music.list)){if(r){const p=function(e){const t=e.music.unshuffledList.map(((e,t)=>({context:Be.Ay.getContextByIndexFromOriginal(t),id:String(e[Be.Ay.getMediaId(e)]),type:Be.Ay.getMediaType(e)}))),n=[],a=e.music.list.map(((t,a)=>{let i=0;const s=Be.Ay.getContextByIndex(a),r=t[Be.Ay.getMediaId(t)],o=e.music.unshuffledList.filter((e=>e[Be.Ay.getMediaId(e)]===t[Be.Ay.getMediaId(t)])).filter((t=>(0,Qd.A)(s,Be.Ay.getContextByIndexFromOriginal(e.music.unshuffledList.indexOf(t)))));return o.length>1&&(i=n.filter((e=>r===e)).length,n.push(r)),e.music.unshuffledList.indexOf(o[i])})),i=!a.reduce(((e,t,n)=>e&&t===n),!0);return{shuffled:i,tracks:t,tracks_order:i?a:[]}}(s.player);Ku.DzAppPlayerApi.setTracklist(p,s.player.music.index,s.player.music.context);break}{const m=ep(s.player);delete Ku.retries,Ku.id=m.id=Sd()(),np("PlaybackQueueList",m),np("PlaybackCurrentIndex",{id:Ku.id,index:s.player.music.index,timestamp:Ku.now()})}}case Mc.gz:if(!(0,Qd.A)(a.player.music.track,s.player.music.track)||!(0,Qd.A)(a.player.music.context,s.player.music.context))if(r)Ku.DzAppPlayerApi.setTracklistIndex(s.player.music.index);else{if(!Ku.id){const h=ep(s.player);Ku.id=h.id,np("PlaybackQueueList",h)}np("PlaybackCurrentIndex",{id:Ku.id,index:s.player.music.index,timestamp:Ku.now()})}}return i}),(e=>t=>n=>{const a=t(n),i=e.getState();if(n.type===Mc.gz||n.type===Mc.GD){const e=(0,_r.tc)(i),t=(0,_r.KX)(i).map((({ART_NAME:e})=>e)).filter(Boolean).join(", "),n=(0,_r.ZQ)(i),a=(0,_r.uY)(i);if(document.title=`${a} - ${t} - Deezer`,"mediaSession"in navigator){const s=(0,fr.vp)(i.user,i.player.music.track);!sp&&navigator.mediaSession.setPositionState&&(E.A.subscribe(E.A.player.position,rp),sp=!0),navigator.mediaSession.metadata=new MediaMetadata({title:a,artist:t,album:e,artwork:s?[]:[{src:n,sizes:"250x250",type:"image/jpeg"}]})}}if("mediaSession"in navigator&&(n.type===Uc.Qx||n.type===Uc.aw)){navigator.mediaSession.setActionHandler("nexttrack",(0,al.oy)(i)?Be.Ay.control.nextSong:null),navigator.mediaSession.setActionHandler("pause",(0,al.J2)(i)?Be.Ay.control.pause:null),navigator.mediaSession.setActionHandler("play",(0,al.v_)(i)?Be.Ay.control.play:null),navigator.mediaSession.setActionHandler("previoustrack",(0,al.eX)(i)?Be.Ay.control.prevSong:null),navigator.mediaSession.setActionHandler("seekbackward",(0,al.rt)(i)?({seekOffset:e})=>ip(e?ap(e):-.05):null),navigator.mediaSession.setActionHandler("seekforward",(0,al.rt)(i)?({seekOffset:e})=>ip(e?ap(e):.05):null);try{navigator.mediaSession.setActionHandler("seekto",(0,al.rt)(i)?({seekTime:e})=>{const t=e/Be.Ay.getDuration();t>0&&t<1&&Be.Ay.control.seek(t)}:null)}catch(e){}}return a}),(e=>t=>n=>{const a=t(n),i=e.getState().user;if(n.type===Mc.xo&&(0,T.UJ)(i)&&!(0,T.jQ)(i)&&!(0,T.Dx)(i)&&"US"===(0,T.JJ)(i))return cp(e,ee.cn),a;if(n.type!==Mc.xo||lp.$.HTML5Renderer||cp(e,ee.Iv),n.type!==Uc.EC)return a;if(n.playing){if((0,T.UJ)(i)||Be.Ay.getMediaType()!==qe.zu.SONG){if((0,T.UJ)(i)&&!(0,T.jQ)(i)&&e.getState().player.config.playerType===qe.Cc.MOD)if((0,T.fn)(i)){if(!(0,T.Dx)(i)){const t=(0,T.ai)(i);"US"===(0,T.JJ)(i)?cp(e,ee.cn):t>0?cp(e,ee.aC,{streamingDuration:t}):cp(e,ee.h5)}}else cp(e,ee.v4)}else e.dispatch((0,P.qf)({name:se.b.AUTH_MODAL,size:"large",props:{context:"catalog-preview"}}));return a}return a}),(e=>t=>n=>{const a=t(n);if(n.type!==Mc.LK)return a;let i=n.cover;if(i===mp)return a;mp=i;const s=(0,Qc.D8)();return e.dispatch(dp({backgroundColor:s[0],isLightMode:s[1]})),pp.onload=()=>{try{var{color:t}=(0,Qc.xH)(pp);const a=(0,Qc.nr)(t);(0,_r.Cv)(e.getState())===n.cover&&e.dispatch(dp({backgroundColor:a.color[0],isLightMode:a.color[1]}))}catch(e){}},pp.crossOrigin="",pp.src=n.cover.replace("250x250",`${hp}x${hp}-000000-80-0-0`),a}),(e=>t=>n=>{n.type===Mc.xo&&(e=>{bd||(E.A.subscribe(E.A.player.seekCompleted,(()=>{kd(e)}),"bookmarking_middleware"),E.A.subscribe(E.A.player.paused,((t,n)=>{!0===n&&kd(e)}),"bookmarking_middleware"),E.A.subscribe(E.A.player.trackChange,((t,n)=>{kd(e,{id:n.previousTrack.id,type:n.previousTrack.type,offset:n.previousTrack.offset,duration:n.previousTrack.duration})}),"bookmarking_middleware"),bd=!0)})(e);const a=t(n);if(n.type!==vd.S.MARK_AS_PLAYED&&n.type!==vd.S.MARK_AS_NOT_PLAYED)return a;const i=Be.Ay.getSongId(),s=Be.Ay.getMediaType();if(!i||!s||!function(e){return{}.hasOwnProperty.call(e,"bookmark")}(n))return a;const r=(0,Ed.qx)(String(s)),o=n.bookmark;return null===r||o.type===r&&o.id===i&&Be.Ay.control.stop(),a}));const yp=(0,Oc.combineReducers)({config:function(e=Gc,t={}){let n;switch(t.type){case Mc.xo:case Mc.Qx:case Mc.gz:return{...e,isRadio:Be.Ay.isRadio(),isUpnext:"up_next_artist"===Be.Ay.getContext("TYPE"),isFlow:Be.Ay.helper.isPlayingFlow(),isMyFlow:Be.Ay.helper.isPlayingUserFlow(),playerType:Be.Ay.getPlayerType()};case Bc.MC:return Boolean(t.active)!==e.isBlindTestMode?{...e,isBlindTestMode:Boolean(t.active)}:e;case Bc.Dp:return n=Be.Ay.getPlayerType(),n!==e.playerType?{...e,playerType:n}:e;case Bc.HO:return e.playerFull!==t.active?{...e,playerFull:t.active}:e;case Bc.J:return e.playerQueuelist!==t.active?{...e,playerFull:t.active||e.playerFull,playerQueuelist:t.active,playerLyrics:!t.active&&e.playerFull}:e;case Bc.Kf:return e.playerLyrics!==t.active?{...e,playerFull:t.active||e.playerFull,playerLyrics:t.active}:e;default:return e}},control:function(e=Fc,t={}){switch(t.type){case Mc.xo:case Mc.Qx:case Mc.gz:return{...e,volume:Be.Ay.getVolume(),hasShuffle:(0,Be.S1)(),shuffle:Be.Ay.isShuffle(),hasRepeat:(0,Be.k2)(),repeat:Be.Ay.getRepeat(),mute:Be.Ay.isMuted()};case Uc.Qx:return{...e,hasNext:t.hasNext};case Uc.aw:return{...e,hasPrev:t.hasPrev};case Uc.EC:return t.playing!==e.playing?{...e,playing:t.playing,loading:!1}:e;case Uc.oB:return t.loading!==e.loading?{...e,loading:t.loading}:e;case Uc.yd:return t.paused!==e.paused?{...e,paused:t.paused}:e;case Uc.Iq:return t.volume!==e.volume?{...e,volume:t.volume}:e;case Uc.tU:return{...e,mute:t.mute};case Uc.f6:return{...e,repeat:t.repeat};case Uc.RA:return{...e,shuffle:t.shuffle};case Uc.Ym:return t.buffer!==e.buffer?{...e,buffer:t.buffer}:e;case Uc.vg:return{...e,playing:!1,paused:!1,loading:!1};case Uc.pU:return{...e,normalized:t.normalized};default:return e}},music:_r.Ay,chromecast:function(e=qc,t={}){switch(t.type){case Mc.xo:return{...qc,loading:Be.Ay.chromecast.isLoading(),active:Be.Ay.chromecast.isActive(),chunksInfo:Be.Ay.chromecast.getChunksInfo()};case zc.Kx:return{...e,available:t.status,connecting:!1,active:t.active,chunksInfo:t.chunksInfo};case zc.tM:return{...e,available:!0,connecting:t.status,casting:!1,chunksInfo:t.chunksInfo};case zc.qC:return{...e,available:!0,connecting:!1,active:t.active,casting:t.status,chunksInfo:t.chunksInfo};case zc.iY:return{...e,loading:t.loading,active:t.active,chunksInfo:t.chunksInfo};case zc.Y0:return{...e,skipLimited:t.skipLimited};default:return e}},ui:(e=Vc,t)=>{switch(t.type){case Hc.SET_TONE:return{...e,tone:t.tone};case Hc.SET_COLOR:return{...e,backgroundColor:t.backgroundColor,isLightMode:t.isLightMode};default:return e}}});var Ep,fp,_p,vp,bp,gp=n("3mue"),Ap=n("pJNj");const kp=i.lazy((()=>n.e(8314).then(n.bind(n,"OER3"))));class Tp extends i.Component{constructor(e){super(e),this.state={fading:!1},this._onFading=this._onFading.bind(this),this._onFinish=this._onFinish.bind(this),this._onTrackChange=this._onTrackChange.bind(this),this._onTrackRecognized=this._onTrackRecognized.bind(this),this._onChangePlayerType=this._onChangePlayerType.bind(this),this._onTracklistChange=this._onTracklistChange.bind(this),this._onToggleFavorite=this._onToggleFavorite.bind(this),this._onPlayingChange=this._onPlayingChange.bind(this),this._onPauseChange=this._onPauseChange.bind(this),this._onTracklistFinish=this._onTracklistFinish.bind(this),this._onLoaded=this._onLoaded.bind(this),this._onTrackDurationChange=this._onTrackDurationChange.bind(this),this._onVolumeChange=this._onVolumeChange.bind(this),this._onToggleMute=this._onToggleMute.bind(this),this._onRepeatChange=this._onRepeatChange.bind(this),this._onSimultaneousAccess=this._onSimultaneousAccess.bind(this),this._onShuffleChange=this._onShuffleChange.bind(this),this._onQualityChange=this._onQualityChange.bind(this),this._onNormalizedChange=this._onNormalizedChange.bind(this),this._setAvailableStatus=this._setAvailableStatus.bind(this),this._setConnectingStatus=this._setConnectingStatus.bind(this),this._setCastingStatus=this._setCastingStatus.bind(this),this._setChromecastActiveState=this._setChromecastActiveState.bind(this)}componentDidMount(){!function(){let e,t=[];const{offer_id:n,user_id:a}=Pa.It.get();E.A.subscribe(E.A.player.licenseChanged,((i,{license_country:s})=>{if(e&&e!==s){const i=(0,Oa.L)("playback.media_request_errors","2.0.0",{error:{type:"OtherError",subtype:"CountryMismatch"},media:{id:"id-of-the-track",type:"song"},apiCalls:t,license:{new:s,old:e},client_ip:La.A.get(),offer_id:n,user_id:a});Un.A.log(i)}e=s,t=[]})),bt.A.addEventListener(bt.Q.CALL_STARTED,(({detail:e})=>{t.push({method:new URL(e.url).searchParams.get("method"),params:e.data})}))}(),this.props.initPlayer(),E.A.ready(E.A.user.userReady,this._onToggleFavorite),E.A.subscribe(E.A.player.displayCurrentSong,this._onTrackChange,"player"),E.A.subscribe(E.A.player.displayRecognizedTrack,this._onTrackRecognized,"player"),E.A.subscribe(E.A.player.changePlayerType,this._onChangePlayerType,"player"),E.A.subscribe(E.A.player.tracklist_changed,this._onTracklistChange,"player"),E.A.subscribe(E.A.user.addFavorite,this._onToggleFavorite,"player"),E.A.subscribe(E.A.user.deleteFavorite,this._onToggleFavorite,"player"),E.A.subscribe(E.A.player.playing,this._onPlayingChange,"player"),E.A.subscribe(E.A.player.paused,this._onPauseChange,"player"),E.A.subscribe(E.A.player.finishTrackList,this._onTracklistFinish,"player"),E.A.subscribe(E.A.player.pourcentLoaded,this._onLoaded,"player"),E.A.subscribe(E.A.player.duration,this._onTrackDurationChange,"player"),E.A.subscribe(E.A.player.volume_changed,this._onVolumeChange,"player"),E.A.subscribe(E.A.player.mute_changed,this._onToggleMute,"player"),E.A.subscribe(E.A.player.repeat_changed,this._onRepeatChange,"player"),E.A.subscribe(E.A.player.shuffle_changed,this._onShuffleChange,"player"),E.A.subscribeOnce(E.A.player.playerLoaded,(()=>{Be.Ay.restoreSetting(this.props.userSetting)})),E.A.subscribe(E.A.player.fading,this._onFading,"player"),E.A.subscribe(E.A.player.finish,this._onFinish,"player"),E.A.subscribe(E.A.live.simultaneousAccess,this._onSimultaneousAccess,"player"),E.A.subscribe(E.A.player.qualityChanged,this._onQualityChange,"player"),E.A.subscribe(E.A.player.normalizedChanged,this._onNormalizedChange,"player"),E.A.subscribe(E.A.player.trackAddNext,this._onTrackAddNext,"player"),E.A.subscribe(E.A.player.trackAddToQueue,this._onTrackAddToQueue,"player"),E.A.subscribe(E.A.chromecast.available,this._setAvailableStatus,"player"),E.A.subscribe(E.A.chromecast.connecting,this._setConnectingStatus,"player"),E.A.subscribe(E.A.chromecast.casting,this._setCastingStatus,"player"),E.A.subscribe(E.A.chromecast.loading,this._setChromecastActiveState,"player")}componentDidUpdate(e){this.props.id!==e.id&&this.props.dispatchHidePopper()}componentWillUnmount(){E.A.unsubscribeAll("player")}render(){const{hasDesktopNotifications:e}=this.props;return i.createElement(te.a,{className:"page-player",id:"page_player","data-testid":"miniplayer_container"},e?Ep||(Ep=i.createElement(kp,null)):null,i.createElement(Te.s,{minWidth:"768px",alignItems:"center",backgroundColor:"background.neutral.secondary.default",bottom:"0",borderTopWidth:"1px",borderTopStyle:"solid",borderTopColor:"border.neutral.primary.default",justifyContent:"space-between",height:"var(--layout-player-height)",left:"0",px:"spacing.l",position:"fixed",right:"0",zIndex:"300"},fp||(fp=i.createElement(rc,null)),_p||(_p=i.createElement(Vl,null)),vp||(vp=i.createElement(Nc,null))),bp||(bp=i.createElement(Bo,null)))}_onFading(){this.props.hasAudioAds&&null!==Be.Ay.getAudioAds()||(this.setState({fading:!0}),Be.Ay.control.nextSong(!0))}_onFinish(){this.state.fading||Be.Ay.control.nextSong(!0),this.setState({fading:!1}),this.props.isLogged||this.props.showAlert(ee.mu)}_onTrackChange(e,t,n){this.props.updateTrack(n)}_onTrackRecognized(e,t){t?this.props.updateRecognizedTrack({track:t}):this._onTrackChange()}_onChangePlayerType(){this.props.updatePlayerType()}_onTracklistChange(e,t){this.props.updateTracklist(t),E.A.trigger(E.A.list.deselectAll)}_onToggleFavorite(e,t){(!t||"song"===t.type&&String(t.id)===this.props.id)&&this.props.updateFavorite()}_onPlayingChange(e,t){this.props.setPlaying({playing:t})}_onPauseChange(e,t,n){this.props.setPaused({paused:t,...n})}_onTracklistFinish(){this.props.setTracklistFinished()}_onLoaded(e,t){this.props.setBuffer({buffer:t})}_onTrackDurationChange(e,t){this.props.setTrackDuration({trackDuration:t})}_onVolumeChange(e,t){this.props.setVolume({volume:t/100})}_onToggleMute(e,t){this.props.setMute({mute:t})}_onRepeatChange(e,t,n){this.props.setRepeat({repeat:t,...n})}_onSimultaneousAccess(){const{playing:e,playerType:t,hasEventSimultaneousListening:n,triggerAppCustoEvent:a}=this.props;if(e&&!(0,Be._k)(t)&&!Be.Ay.chromecast.isActive()){if(Be.Ay.control.pause(),n&&a(Rc.Sc.SIMULTANEOUS_LISTENING))return;this.props.openModal({name:"PLAYER_LIMITATION"})}}_onShuffleChange(e,t){this.props.setShuffle({shuffle:t}),E.A.trigger(E.A.list.deselectAll)}_onQualityChange(e,t){this.props.setQuality(t)}_onNormalizedChange(e,t){this.props.setNormalized(t)}_onTrackAddNext(e,{notify:t,count:n}){!0===t&&(0,zi.A)({body:(0,X.WI)("Le titre a bien été ajouté à la file d'attente.","Les titres ont bien été ajoutés à la file d'attente.",{count:n})})}_onTrackAddToQueue(e,{count:t}){(0,zi.A)({body:(0,X.WI)("Le titre a bien été ajouté à la file d'attente.","Les titres ont bien été ajoutés à la file d'attente.",{count:t})})}_setChromecastActiveState(e,t){this.props.setLoading({loading:t}),this.props.setChromecastActiveState({loading:t,active:Be.Ay.chromecast.isActive(),chunksInfo:Be.Ay.chromecast.getChunksInfo()})}_setAvailableStatus(e,t){this.props.setChromecastAvailableStatus({status:t,active:Be.Ay.chromecast.isActive(),chunksInfo:Be.Ay.chromecast.getChunksInfo()})}_setConnectingStatus(e,t){this.props.setChromecastConnectingStatus({status:t,chunksInfo:Be.Ay.chromecast.getChunksInfo()})}_setCastingStatus(e,t){this.props.setChromecastCastingStatus({status:t,active:Be.Ay.chromecast.isActive(),chunksInfo:Be.Ay.chromecast.getChunksInfo()})}_seek(e,t){e&&(e.preventDefault(),e.stopPropagation()),this.props.canSeek&&(void 0===t&&(t=e.pageX/e.currentTarget.parentNode.offsetWidth),Be.Ay.control.seek(t))}}z.A.addReducers({player:yp});const Cp=(0,s.Ng)((e=>({isLogged:(0,T.UJ)(e.user),id:e.player.music.id,track:e.player.music.track,playing:e.player.control.playing,playerType:e.player.config.playerType,userSetting:e.user.USER.SETTING,hasAudioAds:e.user.USER.OPTIONS.ads_audio,hasEventSimultaneousListening:(0,Fi.lm)(e,Rc.Sc.SIMULTANEOUS_LISTENING),hasDesktopNotifications:(0,T.AU)(e.user),canSeek:(0,al.rt)(e)})),{dispatchHidePopper:B.Lm,initPlayer:_r.kI,setPlaying:gp.Li,setPaused:gp.XP,setLoading:gp.r1,setTracklistFinished:gp.qq,setBuffer:gp.V6,setTrackDuration:_r.WN,setVolume:gp.ls,setRepeat:gp.oD,setShuffle:gp.UD,setMute:gp.YI,setQuality:_r.Up,setNormalized:gp.ej,showAlert:w.S7,updateFavorite:_r.O,updateTrack:_r.FZ,updateRecognizedTrack:_r.NL,updatePlayerType:qi.pE,updateTracklist:_r.Fh,triggerAppCustoEvent:Ui.sS,openModal:P.qf,setChromecastActiveState:Ap.uP,setChromecastAvailableStatus:Ap.E9,setChromecastConnectingStatus:Ap.F$,setChromecastCastingStatus:Ap.ix})(Tp);var Sp=n("WeLa");class Ip extends i.Component{shouldComponentUpdate(e){return!!e.current&&(!this.props.current||Boolean(this.props.current&&e.current.name!==this.props.current.name))}render(){const{current:e}=this.props;return e&&e.value?(e.type===Rc.DP.CUSTO&&(this._custoModal(),(0,Sp.s6)(e.onTriggered||[])),null):null}_custoModal(){const{current:e}=this.props;e&&e.value&&e.type===Rc.DP.CUSTO&&this.props.openModal({name:"CUSTO",props:{custo:e.value,closeModal:()=>{this.props.removeCurrent(),this.props.closeModal()}},size:"medium",addRadius:!0,disableClosingAction:!(0,Fi.db)(e)})}}Ip.displayName="AppCusto";const wp=(0,s.Ng)((({appCusto:{current:e}})=>({current:e})),{openModal:P.qf,closeModal:P.Oo,removeCurrent:Ui.in})(Ip);var Pp=n("9odk");const xp=({openScreen:e,isOnboardingOpen:t,toRenderWhenNoOnboarding:n,toRenderWhenOnboarding:a})=>{const s=(0,Pp.AP)();return i.useEffect((()=>{null!=s&&s.shouldBeOnboarded&&!t&&e({name:G.F.ONBOARDING,data:{showGenreFilter:!0}})}),[t,s,e]),s&&!1===s.shouldBeOnboarded?n:a};xp.defaultProps={toRenderWhenNoOnboarding:null,toRenderWhenOnboarding:null};const Np=(0,s.Ng)((({user:{id:e},fullscreen:{name:t}})=>({currentUserId:e,isOnboardingOpen:t===G.F.ONBOARDING})),{openScreen:I.J2,closeScreen:I.Fn})(xp);class Rp extends i.Component{render(){const{darkModeOn:e}=this.props,t="dark"===document.documentElement.getAttribute("data-theme");return f.A.isAllowed("dark_mode")?(e===t||(e?(document.body.classList.add("no-transitions"),document.documentElement.setAttribute("data-theme","dark"),window.requestAnimationFrame((()=>{document.body.classList.remove("no-transitions")}))):Wt()),null):(Wt(),null)}}const Lp=(0,s.Ng)((e=>({darkModeOn:(0,T.NF)(e.user)})))(Rp);var Op=n("imBb"),Dp=n.n(Op);const Vp=({label:e,displaySize:t,shortcut:n})=>{if(!e)return null;const a="wide"!==t?null==n?void 0:n.split(","):[n],s=(0,r.A)("cZzQk",{X8ULE:"wide"===t,qQd6L:"wide"!==t&&1===(null==a?void 0:a.length)});return i.createElement("div",{className:"pr654"},null==a?void 0:a.map(((e,t)=>{if(!e)return null;const n=t;return i.createElement("div",{className:s,key:"shortcut"+n},e)})),i.createElement("div",{className:"zt_Lq"},e))};var Wp=n("TYt9"),Yp=n("fJgm");const jp=e=>{e>0&&e<1&&Be.Ay.control.seek(e)},Kp=()=>{jp(1e-4)},$p=e=>{e.preventDefault(),Be.Ay.isPlaying()||Be.Ay.control.play();const t=(Be.Ay.getPosition()/(Be.Ay.getDuration()||1)-.05).toFixed(3);jp(Number(t))},Jp=e=>{e.preventDefault(),Be.Ay.isPlaying()||Be.Ay.control.play();const t=(Be.Ay.getPosition()/(Be.Ay.getDuration()||1)+.05).toFixed(3);jp(Number(t))},Xp=(e,t)=>{let n=parseFloat(t||"0")/10;return 0===n&&(n=1e-5),jp(n)},Zp=()=>{let e=Number((Be.Ay.getVolume()-.1).toFixed(2));e=Math.max(0,e),0!==e||Be.Ay.isMuted()||Be.Ay.control.mute(),Be.Ay.control.setVolume(e)},em=()=>{let e=Number((Be.Ay.getVolume()+.1).toFixed(2));e=Math.min(1,e),Be.Ay.control.setVolume(e)},tm=()=>{Be.Ay.control.mute(!Be.Ay.isMuted())},nm=(0,ue.A)((()=>{Be.Ay.control.nextSong()}),100),am=(0,ue.A)((()=>{Be.Ay.control.prevSong()}),100),im=e=>{"preventDefault"in e&&e.preventDefault(),hl.A.intent("play"),E.A.trigger("EVENT.TRACKLIST.togglePlayAll")},sm=e=>{"preventDefault"in e&&e.preventDefault(),Be.Ay.getPlayerType()!==qe.Cc.ADS&&Be.Ay.getPlayerType()!==qe.Cc.TRITON_AD&&(hl.A.intent((0,Wp.G)(Be.Ay)),Be.Ay.control.togglePause())},rm=()=>{const e=Number(Be.Ay.getRepeat());Be.Ay.control.setRepeat(2===e?0:e+1)},om=()=>{E.A.ready(E.A.user.initialized,(()=>{if(-1!==[qe.Cc.ADS,qe.Cc.LIVESTREAM].indexOf(Be.Ay.getPlayerType()))return;if(Be.Ay.getMediaType()!==qe.zu.SONG)return;const e=Be.Ay.getCurrentSong("SNG_ID"),t=Yp.A.isFavorite(Ne.Ay.Song,e)?"remove":"add",n=Be.Ay.getContext();Yp.A[t]({type:Ne.Ay.Song,id:e,context:n})}))},lm=e=>{var t;"preventDefault"in e&&e.preventDefault(),null===(t=document.getElementById("topbar-search"))||void 0===t||t.focus()},cm=jr.A.is("macos")?"alt":"ctrl",dm=()=>{const[e,t]=(0,i.useState)(!1),n=(0,i.useCallback)((()=>{t(!e)}),[e]),s=()=>{document.body.classList&&(document.body.classList.add("konami"),setTimeout((()=>{document.body.classList.remove("konami")}),1e4))},o=(0,i.useMemo)((()=>[{keys:["0","1","2","3","4","5","6","7","8","9"],callback:Xp,options:{label:(0,X.AP)("Aller à la position"),shortcut:"0...9",displaySize:"wide"}},{keys:"space",callback:sm,options:{label:(0,X.AP)("Lecture/Pause"),shortcut:(0,X.AP)("Espace"),displaySize:"wide"}},{keys:"shift+enter",callback:im,options:{label:(0,X.AP)("Lire les titres présents sur la page"),shortcut:"⇧ ⏎",displaySize:"wide"}},{keys:["s","shift+s"],callback:lm,options:{label:(0,X.AP)("Rechercher"),shortcut:"S"}},{keys:[`${cm}+left`,"left"],callback:$p,options:{label:(0,X.AP)("Reculer"),shortcut:`${cm},←`}},{keys:[`${cm}+right`,"right"],callback:Jp,options:{label:(0,X.AP)("Avancer"),shortcut:`${cm},→`}},{keys:"r",callback:Kp,options:{label:(0,X.AP)("Rejouer le titre"),shortcut:"R"}},{keys:"shift+left",callback:am,options:{label:(0,X.AP)("Lire le titre précédent"),shortcut:"⇧,←",event:"keyup"}},{keys:"shift+right",callback:nm,options:{label:(0,X.AP)("Lire le titre suivant"),shortcut:"⇧,→",event:"keyup"}},{keys:["m","shift+m"],callback:tm,options:{label:(0,X.AP)("Silence"),shortcut:"M"}},{keys:"shift+up",callback:em,options:{label:(0,X.AP)("Augmenter le volume"),shortcut:"⇧,↑"}},{keys:"shift+down",callback:Zp,options:{label:(0,X.AP)("Baisser le volume"),shortcut:"⇧,↓"}},{keys:["l","shift+l"],callback:om,options:{label:(0,X.AP)("Ajouter le titre aux Coups de cœur"),shortcut:"L"}},{keys:"shift+r",callback:rm,options:{label:(0,X.AP)("Mode de répétition"),shortcut:"⇧,R"}},{keys:["h","shift+h","?"],callback:n,options:{label:(0,X.AP)("Afficher les raccourcis clavier"),shortcut:"H / ?",displaySize:"wide",event:"keypress"}},{keys:"up up down down left right left right b a enter",callback:s}]),[n]);(0,i.useEffect)((()=>(o.forEach((e=>(({keys:e,callback:t,options:n})=>{const a=(null==n?void 0:n.event)||"keydown";Dp().bind(e,t,a)})(e))),()=>{o.forEach((e=>Dp().unbind(e.keys)))})),[o]);const l=(0,r.A)("h3wew",{igbv2:e});return i.createElement("div",{className:l,"aria-hidden":!e,"data-testid":"hotkey-panel"},i.createElement("div",{className:"KGl0e"}),i.createElement("div",{className:"vBn6X"},o.map((e=>i.createElement(Vp,(0,a.A)({key:e.keys.toString()},e.options))))))};n("Dk60");class um{constructor(e,t,n,a=void 0){this.userId=void 0,this.name=void 0,this.to=void 0,this.event=void 0,this.channel=void 0,this.eventHandler=void 0,this.listeners=void 0,this._connected=!1,this.event=e,this.userId=t,this.name=n,this.to=a,this.channel=[this.userId,this.userId,this.event.toUpperCase()].join("_"),this.listeners=[]}connect(){if(!0!==this._connected){if(this.event in E.A.live==0)throw new Error(`Unknown event ${this.event}: you should specify an event from Events.live`);_.A.addChannel(this.channel),this.eventHandler=this.onMessage.bind(this),E.A.subscribe(E.A.live[this.event],this.eventHandler),this._connected=!0}}disconnect(){!1!==this._connected&&(_.A.deleteChannel(this.channel),E.A.unsubscribe(E.A.live[this.event],this.eventHandler),this._connected=!1,this.listeners=[])}get connected(){return this._connected}onMessage(e,t){if(!1===this._connected)return;const{body:n,headers:a}=t[0];if("string"!=typeof n)throw new Error("No string body property on message");if("object"!=typeof a)throw new Error("No headers on message");const{destination:i,from:s}=a;if(void 0===s)throw new Error("No sender defined");s!==this.name&&(i&&i!==this.name||this.to&&s!==this.to||this.listeners.forEach((e=>e(n))))}publish(e,t){if(!this._connected)return Promise.reject(new Error("Not connected"));if(void 0!==this.to&&void 0!==t&&t!==this.to)return Promise.reject(new Error("Cannot publish to another peer that the one we connected to"));const n={from:this.name};void 0!==this.to&&(n.destination=this.to),void 0!==t&&(n.destination=t);const a={APP:this.event.toUpperCase(),headers:n,body:e};return _.A.publish(this.channel,a),Promise.resolve()}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}}var pm=n("8cVe");function mm(e,t){const n=JSON.parse(e);if("string"!=typeof n.messageType)throw new Error('No string property "messageType" on message');if("string"!=typeof n.messageId||""===n.messageId)throw new Error('No string property "messageId" on message');if("string"!=typeof n.payload)throw new Error('No string property "payload" on message');if("string"!=typeof n.protocolVersion)throw new Error('No string property "protocolVersion" on message');const a=t[n.messageType];if(void 0===a)throw new Error(`Unknow message type ${n.messageType}`);return a(n)}function hm(e){return({messageId:t,payload:n})=>{const a=""===n?{}:JSON.parse((0,pm.D4)(n));return new e({messageId:t,...a})}}function ym(e){return JSON.stringify({messageId:e.messageId,messageType:e.messageType,protocolVersion:e.protocolVersion,clock:e.clock,payload:e.payloadString()})}class gm{constructor({messageType:e,messageId:t=Sd()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.discovery.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}payloadString(){const e=this.payloadJSON();return 0===Object.getOwnPropertyNames(e).length?"":(0,pm.lF)(JSON.stringify(e))}}class Am extends gm{constructor({from:e,params:t,messageId:n}){if(super({messageType:"connectionOffer",messageId:n}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}class Em extends gm{constructor({from:e,params:t,messageId:n}){if(super({messageType:"connect",messageId:n}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}class fm extends gm{constructor({from:e,params:t,messageId:n}){if(super({messageId:n,messageType:"discoveryRequest"}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}var _m=n("xNxK"),vm=n("mEUi");class bm extends vm.Ay{}class km extends Error{constructor(e){super(e),this.name="Stopped"}}class Tm{constructor(){this.internalCache=new Map,this.waiting=new Map}clear(){this.waiting.forEach((({reject:e})=>{e(new u.MU)})),this.waiting.clear(),this.internalCache.clear()}cache(e){this.internalCache.set(e.id,e);const t=this.waiting.get(e.id);if(void 0===t)return;const{resolve:n}=t;this.waiting.delete(e.id),n(e)}get(e,t){return(0,_m.h)(new Promise(((t,n)=>{const a=this.internalCache.get(e);void 0===a?this.waiting.set(e,{resolve:t,reject:n}):t(a)})),t).finally((()=>this.waiting.delete(e)))}}class Cm{constructor({messageType:e,messageId:t=Sd()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.queue.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}}class Sm extends Cm{constructor({queue:e,messageId:t}){super({messageType:"publishQueue",messageId:t}),this.queue=void 0,this.queue=e}payloadString(){return function(e){const t=Su.toBinary(e),n=t.length>0?Gd().deflate(t,7):t;return btoa(String.fromCharCode(...n))}(this.queue)}}function Im({messageId:e,payload:t}){const n=function(e){if("string"!=typeof e)return;const t=atob(e),n=Array.from(t).map((e=>e.charCodeAt(0))),a=Gd().inflate(new Uint8Array(n));return Su.fromBinary(new Uint8Array(a))}(t);if(!n)throw new Error("Could not decode received queue");return new Sm({messageId:e,queue:n})}class wm extends Cm{constructor({messageId:e}){super({messageType:"refreshQueue",messageId:e})}payloadString(){return""}}class Pm extends bm{constructor(e,t,n){super(),this.conn=void 0,this.cache=new Tm,this.closed=!1,this.onQueueNeedsRefresh=void 0,this.conn=new um("remotequeue",e,t,n),this.conn.addListener((e=>this.didReceiveMessage(e)))}connect(){this.conn.connect()}disconnect(){this.conn.disconnect()}queueWithId(e,t){return!0===this.closed?Promise.reject(new km):this.cache.get(e,t)}publishQueue(e){var t;const n=ym(new Sm({queue:e}));return this.dispatchEvent(new CustomEvent("sendqueue",{detail:{content:n,containerType:(null===(t=e.contexts[0])||void 0===t||null===(t=t.container)||void 0===t?void 0:t.type)||0}})),this.conn.publish(n)}stop(){this.disconnect(),this.cache.clear(),this.onQueueNeedsRefresh=void 0,this.closed=!0}didReceiveMessage(e){const t=mm(e,{refreshQueue:hm(wm),publishQueue:Im});switch(t.messageType){case"publishQueue":return this.cache.cache(t.queue);case"refreshQueue":return this.onQueueNeedsRefresh&&this.onQueueNeedsRefresh();default:throw new Error("Unknow message type "+t.messageType)}}}class xm extends vm.Ay{}class Nm extends Error{constructor(e,t){super(t),this.code=void 0,this.code=e}}class Rm{constructor({messageType:e,messageId:t=Sd()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.command.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}payloadString(){const e=this.payloadJSON();return 0===Object.getOwnPropertyNames(e).length?"":(0,pm.lF)(JSON.stringify(e))}}class Lm extends Rm{constructor({acknowledgementId:e,messageId:t}){if(super({messageType:"ack",messageId:t}),this.acknowledgementId=void 0,"string"!=typeof e)throw new TypeError("Parse Error, no acknowledgementId");this.acknowledgementId=e}payloadJSON(){return{acknowledgementId:this.acknowledgementId}}}class Om extends Rm{constructor({messageId:e}={}){super({messageType:"ready",messageId:e})}payloadJSON(){return{}}}class Dm extends Rm{constructor({queueId:e,elementId:t,progress:n,buffered:a,duration:i,quality:s,isPlaying:r,isShuffle:o,repeatMode:l,volume:c,messageId:d}){super({messageType:"playbackProgress",messageId:d}),this.queueId=void 0,this.elementId=void 0,this.progress=void 0,this.buffered=void 0,this.duration=void 0,this.quality=void 0,this.volume=void 0,this.isPlaying=void 0,this.isShuffle=void 0,this.repeatMode=void 0,this.queueId=e,this.elementId=t,this.progress=n,this.buffered=a,this.duration=i,this.quality=s,this.isPlaying=r,this.isShuffle=o,this.repeatMode=l,this.volume=c}payloadJSON(){return{queueId:this.queueId,elementId:this.elementId,progress:this.progress,buffered:this.buffered,duration:this.duration,quality:this.quality,volume:this.volume,isPlaying:this.isPlaying,isShuffle:this.isShuffle,repeatMode:this.repeatMode}}}class Mm extends Rm{constructor({queueId:e,elementId:t,progress:n,shouldPlay:a,setShuffle:i,setRepeatMode:s,setVolume:r,messageId:o}){super({messageType:"skip",messageId:o}),this.queueId=void 0,this.elementId=void 0,this.progress=void 0,this.shouldPlay=void 0,this.setShuffle=void 0,this.setRepeatMode=void 0,this.setVolume=void 0,this.queueId=e,this.elementId=t,this.progress=n,this.shouldPlay=a,this.setRepeatMode=s,this.setShuffle=i,this.setVolume=r}payloadJSON(){return{queueId:this.queueId,elementId:this.elementId,progress:this.progress,shouldPlay:this.shouldPlay,setShuffle:this.setShuffle,setRepeatMode:this.setRepeatMode,setVolume:this.setVolume}}}class Um extends Rm{constructor({messageId:e}){super({messageType:"ping",messageId:e})}payloadJSON(){return{}}}class Fm extends Rm{constructor({messageId:e}){super({messageType:"close",messageId:e})}payloadJSON(){return{}}}class zm extends Rm{constructor({messageId:e}){super({messageType:"stop",messageId:e})}payloadJSON(){return{}}}class qm extends Rm{constructor({commandId:e,status:t,messageId:n}){if(super({messageType:"status",messageId:n}),this.commandId=void 0,this.status=void 0,"string"!=typeof e)throw new TypeError("Parse Error, no commandId");if("number"!=typeof t&&void 0!==t)throw new TypeError("Parse Error, no status");this.commandId=e,this.status=t}payloadJSON(){return{commandId:this.commandId,status:this.status}}}class Bm extends xm{constructor(e,t,n){super(),this.conn=void 0,this.remotePromises=void 0,this.commandHandler=void 0,this.stopWatchDog=()=>{},this.conn=new um("remotecommand",e,t,n),this.remotePromises=new Map}connect(e,t){this.stopWatchDog=function(e,t,n){let a,i=!1;function s(){clearTimeout(a)}function r(e=!1){i||(a=window.setTimeout((()=>{if(!e)return n.onInactive(),void r(!0);n.onLost()}),Math.floor(t+1e3*Math.random())))}function o(){s(),r()}return r(),e.addListener(o),()=>{i=!0,e.removeListener(o),s()}}(this.conn,5e3,{onInactive:()=>this.publish(new Um({})),onLost:t||(()=>{})}),this.commandHandler=e,this.conn.addListener((e=>this.onMessage(e))),this.conn.connect()}async disconnect(e){!e&&this.conn.connected&&await this.publish(new Fm({})),this.commandHandler=void 0,this.conn.disconnect(),this.stopWatchDog(),this.remotePromises=new Map}onCommandStatus(e){const t=this.remotePromises.get(e.commandId);t&&(e.status>0?t.reject(e.status):t.resolve())}onMessage(e){const t=(e=>mm(e,{ack:hm(Lm),ready:hm(Om),playbackProgress:hm(Dm),skip:hm(Mm),ping:hm(Um),close:hm(Fm),stop:hm(zm),status:hm(qm)}))(e);if(t instanceof Lm){const e=new CustomEvent("msgack",{detail:{id:t.acknowledgementId}});return void this.dispatchEvent(e)}if(t instanceof qm)return void this.onCommandStatus(t);const n=new Lm({acknowledgementId:t.messageId});if(this.publish(n),!(t instanceof Um)&&void 0!==this.commandHandler){const e={commandId:t.messageId,status:0};this.commandHandler(t).then((()=>e)).catch((n=>(v.A.error(`command ${t.messageType} errored`,n),{...e,status:n instanceof Nm?n.code:1}))).then((e=>{this.publish(new qm(e))}))}}publish(e,t){const n=ym(e),a=()=>{const t=new CustomEvent("msgsent",{detail:{id:e.messageId,type:e.messageType}});return this.dispatchEvent(t),this.conn.publish(n)};return void 0===t?a().catch((()=>{})):(0,_m.h)(new Promise(((t,n)=>{this.remotePromises.set(e.messageId,{resolve:t,reject:n}),a()})),t).catch((t=>{const n=t instanceof u.MU?"timeout":"error",a={status:n,id:e.messageId,type:e.messageType,code:"error"===n?t:void 0},i=new CustomEvent("msgstatus",{detail:a});this.dispatchEvent(i);const s=`${a.type} failed (reason: ${n}, code: ${a.code})`;throw"timeout"===n?new u.MU(s):Error(s)})).then((()=>{const t=new CustomEvent("msgstatus",{detail:{status:"ok",id:e.messageId,type:e.messageType}});this.dispatchEvent(t)})).finally((()=>{this.remotePromises.delete(e.messageId)}))}}class Gm{constructor(e,t){this.userId=void 0,this.conn=void 0,this.discoveryRequestHandler=void 0,this.pendingOffers=new Map,this.seen=new Set,this.userId=e,this.conn=new um("remotediscover",e,t),this.conn.addListener((e=>this.handleMessage(e)))}listen(e){this.discoveryRequestHandler=e,this.conn.connect()}stop(){this.pendingOffers.forEach((({reject:e})=>e(new u.MU))),this.pendingOffers=new Map,this.conn.disconnect()}handleMessage(e){const t=mm(e,{discoveryRequest:hm(fm),connectionOffer:hm(Am),connect:hm(Em)});switch(t.messageType){case"discoveryRequest":this.handleDiscoveryRequest(t);break;case"connect":this.handleConnect(t)}}handleDiscoveryRequest({from:e,params:t}){const{discovery_session:n}=t,a=e+n;if(!0!==this.seen.has(a)&&(this.seen.add(a),this.discoveryRequestHandler)){const n={from:e,params:t,accept:(t={},n=3e4)=>{const a=new Am({from:this.conn.name,params:t}),i=ym(a);return this.conn.publish(i,e).then((()=>(0,_m.h)(new Promise(((e,t)=>{this.pendingOffers.set(a.messageId,{resolve:e,reject:t})})),n).finally((()=>{this.pendingOffers.delete(a.messageId)}))))}};this.discoveryRequestHandler(n)}}handleConnect({from:e,params:t}){var n;const a=t.offer_id;if(void 0===a)return;const{resolve:i,reject:s}=null!==(n=this.pendingOffers.get(a))&&void 0!==n?n:{};void 0!==i&&void 0!==s&&i({command:new Bm(this.userId,this.conn.name,e),queue:new Pm(this.userId,this.conn.name,e)})}}function Qm(e,t){if(t)return[e,t.id,t.index].join("-")}var Vm=n("sEfC"),Wm=n.n(Vm);n("W8Tb");class Ym{constructor(e){this._less_eq=void 0,this._count=void 0,this._less_eq=e,this._count=0}get less_eq(){return this._less_eq===1/0?"+Inf":this._less_eq.toString()}add(e){if(!this.test(e))throw new Error(`${e} is out of bound`);this._count++}test(e){return e<=this._less_eq}serialize(){return{count:this._count,less_eq:this.less_eq}}reset(){this._count=0}}const jm=class{constructor({id:e,buckets:t,tags:n}){if(this._tags=void 0,this._buckets=void 0,this._id=void 0,this._count=void 0,this._sum=void 0,!t.length)throw new Error("Buckets values are mandatory");this._id=e,this._count=0,this._sum=0,this._buckets=[...new Set(t)].sort(((e,t)=>e-t)).map((e=>new Ym(e))),n&&Object.keys(n).length&&(this._tags=n)}get id(){return this._id}get buckets(){return this._buckets}get count(){return this._count}get sum(){return this._sum}add(e){const t=this._buckets.filter((t=>t.test(e)));if(!t.length)throw new Error(`${e} is out of bound`);t.forEach((t=>t.add(e))),this._count++,this._sum+=e}send(){const e={metric:{id:this._id},histogram:{buckets:this._buckets.map((e=>e.serialize())),count:this._count,sum:this._sum}};this._tags&&(e.metric.tags=this._tags),Un.A.log((0,Oa.L)("metrics.histogram","1.0.0",e)),this.reset()}reset(){this._buckets.forEach((e=>e.reset())),this._count=0,this._sum=0}},Km=e=>{const t={},n=({detail:e})=>{const n=`${e.type}${e.status}${e.code||""}`;t[n]=t[n]||new ga.A({id:Aa.Ps.REMOTE_COMMAND_STATUS,tags:{command_type:e.type,status:e.status,errorCode:e.code}}),t[n].increment(1)};return e.addEventListener("msgstatus",n),{stop:()=>e.removeEventListener("msgstatus",n),flush:()=>{Object.values(t).filter((e=>e.value>0)).forEach((e=>e.send()))}}},$m=e=>{const t={},n=({detail:e})=>{t[e.type]=t[e.type]||new ga.A({id:Aa.Ps.REMOTE_COMMAND_TYPE,tags:{command_type:e.type}}),t[e.type].increment(1)};return e.addEventListener("msgsent",n),{stop:()=>e.removeEventListener("msgsent",n),flush:()=>{Object.values(t).filter((e=>e.value>0)).forEach((e=>e.send()))}}},Jm=(e,t)=>{const n={},a=new jm({id:Aa.xK.REMOTE_BUS_LATENCY,buckets:[100,500,1e3,3e3,1/0],tags:{country_code:t}}),i=({detail:e})=>{"ack"!==e.type&&(n[e.id]=Date.now())},s=e=>{const{id:t}=e.detail;if(t in n){const e=Date.now()-n[t];a.add(e),delete n[t]}};return e.addEventListener("msgsent",i),e.addEventListener("msgack",s),{stop:()=>{e.removeEventListener("msgsent",i),e.removeEventListener("msgack",s)},flush:()=>a.send()}},Xm=(e,t)=>{const n=[Km,$m,Jm].map((n=>n(e,t))),a=setInterval((()=>{n.forEach((e=>e.flush()))}),3e4);return{stop:()=>{n.forEach((e=>e.stop())),clearInterval(a)},flush:q.A}},Zm=new Map([[0,"DEFAULT"],[1,"ALBUM"],[3,"LIVE"],[4,"MIX"],[5,"PERSONAL"],[6,"PLAYLIST"],[7,"PODCAST"],[8,"RECOMMENDED"],[9,"SHUFFLE_MY_MUSIC"],[10,"SMART_TRACKLIST"],[11,"TOP_TRACKS"],[-1,"UNRECOGNIZED"]]);function eh(e){const t=({detail:e})=>{((e,t)=>{const n=new jm({id:Aa.xK.REMOTE_QUEUE_SIZE,buckets:[1e3,1e5,5e5,1e6,1/0],tags:{queue_type:null!=t?t:"UNRECOGNIZED"}});n.add(e),n.send()})(new Blob([e.content]).size,Zm.get(e.containerType))};return e.addEventListener("sendqueue",t),{stop:()=>{e.removeEventListener("sendqueue",t)}}}class th{constructor(e,t,n,a,i){this.commandConnection=void 0,this.queueConnection=void 0,this.eventGroup=void 0,this.player=void 0,this.countryCode=void 0,this.trackers=[],this.playRequestHandler=void 0,this.playerEventsBound=!1,this.enableTracking=void 0,this.player=e,this.queueConnection=n,this.commandConnection=t,this.eventGroup=Sd()(),this.countryCode=a,this.enableTracking=i}set onPlayRequested(e){this.playRequestHandler=e}connect(e){this.trackers=this.enableTracking?[eh(this.queueConnection),Xm(this.commandConnection,this.countryCode)]:[],this.queueConnection.connect(),this.commandConnection.connect(this.onCommand.bind(this),e),this.queueConnection.onQueueNeedsRefresh=()=>{this.publishQueue(this.player.getQueue()||this.player.generateQueue())};let t=0;const n=()=>{this.commandConnection.publish(new Om,3e3).then((()=>this.bindPlayerListeners())).catch((()=>{!this.playerEventsBound&&t<3&&(t++,n())}))};n()}disconnect(e){return this.trackers.forEach((e=>e.stop())),this.trackers=[],E.A.unsubscribeAll(this.eventGroup),this.playerEventsBound=!1,this.queueConnection.stop(),this.commandConnection.disconnect(e)}publishQueue(e){this.queueConnection.publishQueue(e).catch((e=>v.A.error(e)))}publishState(){const e=this.player.getState();this.commandConnection.publish(new Dm({...e,elementId:Qm(e.queueId,e.track)}),1e3).catch((()=>{}))}bindPlayerListeners(){if(this.playerEventsBound)return;this.playerEventsBound=!0;const e=Wm()(this.publishState.bind(this),30);E.A.subscribe(E.A.player.position,(0,fo.A)((()=>this.publishState()),3e3,{leading:!0}),this.eventGroup),E.A.subscribe(E.A.player.tracklist_changed,(()=>{this.onTracklistChange()}),this.eventGroup),E.A.subscribe(E.A.player.volume_changed,Wm()(e,300),this.eventGroup),E.A.subscribe(E.A.player.paused,e,this.eventGroup),E.A.subscribe(E.A.player.mute_changed,e,this.eventGroup),E.A.subscribe(E.A.player.repeat_changed,e,this.eventGroup)}onTracklistChange(){this.publishQueue(this.player.generateQueue()),this.publishState()}onCommand(e){switch(this.playerEventsBound||this.bindPlayerListeners(),e.messageType){case"skip":return this.onSkip(e);case"stop":return Promise.resolve(this.stop());case"close":return this.stop(),this.disconnect("remote");default:return Promise.reject(new Nm(0))}}stop(){this.player.stop()}async onSkip(e){const{queueId:t,elementId:n,progress:a,shouldPlay:i,setShuffle:s,setRepeatMode:r,setVolume:o}=e,l=t!==this.player.getQueueId();if(l){const e=await this.queueConnection.queueWithId(t,12e4);await this.player.replaceQueue(e)}if(void 0!==n){const{score:e,index:t}=function(e,t,n){var a;const i=function(e){const t=e.match(/^((?:[0-9A-Fa-f]+-?)+[0-9A-Fa-f]+)-([-]?[0-9]+)-([0-9]+)$/);if(!t)return;const[,n,a,i]=t;return{queue:n,id:a,index:Number(i)}}(n);if(!i)return{score:0,index:-1};const{queue:s,id:r,index:o}=i;return s===e&&(null===(a=t[o])||void 0===a?void 0:a.SNG_ID)===r?{score:1,index:o}:t.reduce(((t,n,a)=>{let i=e===s?.25:0;return n.SNG_ID===r&&(i+=.5),a===o&&(i+=.25),t.score<i?{score:i,index:a}:t}),{score:0,index:-1})}(this.player.getQueueId(),this.player.getTrackList(),n);if(e<.5)throw new Nm(0);(l||t!==this.player.getTrackListIndex())&&this.player.playTrackAtIndex(t,!0)}void 0!==s&&this.player.setShuffle(s),void 0!==r&&this.player.setRepeatMode(r),void 0!==o&&(0===o&&this.player.isMuted()||this.player.setVolume(o)),void 0!==a&&a>0&&this.player.seek(a),i&&this.playRequestHandler&&await this.playRequestHandler(),void 0!==i&&i!==this.player.isPlaying()&&(i?this.player.play():this.player.pause())}}const nh={[Eu.ARTIST]:"artist",[Eu.USER]:"user"};const ih={[vr.en.LOW]:0,[vr.en.STANDARD]:1,[vr.en.HIGH]:2,[vr.en.LOSSLESS]:3,[vr.en.UNKNOWN]:-1};function sh(e,t){const n={queue:void 0,quality:void 0};return E.A.subscribe(E.A.player.qualityChanged,((e,t)=>{n.quality=t})),{play:()=>e.control.play(),pause:()=>e.control.pause(),stop:()=>[qe.zu.LIVE_STREAM,qe.zu.EPISODE].includes(e.getMediaType())?e.control.stop():e.control.pause(),seek:t=>e.control.seek(t),setShuffle:t=>e.control.setShuffle(t),setRepeatMode:t=>e.control.setRepeat(t),setDeviceID:t=>{e.setLinkedDevice(t?{device_type:"remote_control",name:t,type:"in"}:void 0)},isPlaying:()=>e.isPlaying(),getPosition:()=>e.getPosition(),getDuration:()=>e.getDuration(),setVolume:(0,ue.A)((t=>e.control.setVolume(t)),100),isMuted:()=>e.isMuted(),playTrackAtIndex:(t,n=!1)=>e.playTrackAtIndex(t,n),getSongId:()=>e.getSongId(),getTrackListIndex:()=>e.getTrackListIndex(),getTrackList:()=>e.getTrackList(!0).map((e=>e.data)),getQueueId:()=>{var e;return(null===(e=n.queue)||void 0===e?void 0:e.id)||""},getQueue:()=>n.queue,generateQueue:()=>{const t=function(e){const t=e.getTrackList(!0,!0),n=[],a=t.map((({context:t,data:a})=>{const i=function(e){const t={id:e.ID.toString(),extra:{oneofKind:void 0}};if(/album(?!_similar)|artist_discography/i.test(e.TYPE))t.type=_u.ALBUM;else if(/livestream/.test(e.TYPE))t.type=_u.LIVE;else if(/personal/.test(e.TYPE))t.type=_u.PERSONAL;else if(/artist_top/.test(e.TYPE))t.type=_u.TOP_TRACKS,t.extra={oneofKind:"topTracks",topTracks:{type:fu.ARTIST}};else if(/playlist(?!_radio)/.test(e.TYPE)||/history_page/.test(e.TYPE)||/profile_top/.test(e.TYPE))t.type=_u.PLAYLIST;else if(/show/.test(e.TYPE))t.type=_u.PODCAST;else if("up_next_artist"===e.TYPE)t.type=_u.RECOMMENDED;else if(/^shuffled/.test(e.TYPE))t.type=_u.SHUFFLE_MY_MUSIC;else if(/smarttracklist/.test(e.TYPE)){const n=(e.CONTEXT_ID||"").split(",").filter((e=>e.startsWith("card_name"))).map((e=>e.split("=")[1])).shift()||"";t.type=_u.SMART_TRACKLIST,t.extra={oneofKind:"smart_tracklist_method",smart_tracklist_method:n}}else/artist|smartradio/.test(e.TYPE)?(t.type=_u.MIX,t.extra={oneofKind:"mix",mix:{type:Eu.ARTIST}}):"history_radio"===e.TYPE||"playlist_radio"===e.TYPE?(t.type=_u.MIX,t.extra={oneofKind:"mix",mix:{type:Eu.HISTORY}}):"search_radio"===e.TYPE?(t.type=_u.MIX,t.extra={oneofKind:"mix",mix:{type:Eu.SEARCH}}):/user|flow/.test(e.TYPE)?(t.type=_u.MIX,t.extra={oneofKind:"mix",mix:{type:Eu.USER}}):"mix_bottom_sheet_layer"===e.TYPE?(t.type=_u.MIX,t.extra={oneofKind:"mix",mix:{type:Eu.GENRE}}):/radio|mix/i.test(e.TYPE)?(t.type=_u.MIX,t.extra={oneofKind:"mix",mix:{type:Eu.DEFAULT}}):t.type=_u.DEFAULT;return{container:t,log:{context_id:e.CONTEXT_ID||"",listening_context:e.TYPE||""}}}(t);let s,r=n.findIndex((e=>(0,Qd.A)(e,i)));switch(r<0&&(r=n.push(i)-1),e.getMediaType(a)){case qe.zu.EPISODE:s=vu.EPISODE;break;case qe.zu.LIVE_STREAM:s=vu.LIVE;break;default:s=vu.SONG}return{context:r,id:String(a[e.getMediaId(a)]),type:s}})),i=[],s=e.getTrackList(!0,!1).map((({context:n,data:a})=>{let s=0;const r=a[e.getMediaId(a)],o=t.filter((({context:t,data:i})=>i[e.getMediaId(i)]===a[e.getMediaId(a)]&&(0,Qd.A)(n,t)));return o.length>1&&(s=i.filter((e=>r===e)).length,i.push(r)),t.indexOf(o[s])})),r={contexts:n,id:Sd()(),tracks:a,tracks_order:[],shuffled:!1,timestamp:0};return s.reduce(((e,t,n)=>e&&t===n),!0)||(r.tracks_order=s,r.shuffled=!0),r}(e);return n.queue=t,t},replaceQueue:a=>async function(e,t){if(!0===e.hydrated)return Promise.resolve(e);const n=e.contexts.map((({container:e,log:t})=>({CONTEXT_ID:null==t?void 0:t.context_id,ID:(null==e?void 0:e.id)||"",TYPE:(null==t?void 0:t.listening_context)||""}))),a=e=>({type:t})=>t===e,i=e=>e.id,{tracks:s}=e,r=s.filter(a(vu.SONG)).map(i),o=s.filter(a(vu.EPISODE)).map(i),l=s.filter(a(vu.LIVE)).map(i),c=[...r.length?await t(r,"song"):[],...o.length?await t(o,"episode"):[],...l.length?await t(l,"live"):[]],{originals:d,recommended:u}=s.reduce(((e,t,a)=>{if(!c[a])return e;const i=t.context,s={context:n[i],data:c[a]};return"up_next_artist"===s.context.TYPE?e.recommended.push(s):e.originals.push(s),e}),{originals:[],recommended:[]}),p={hydrated:!0,contexts:e.contexts,tracks_order:e.tracks_order,timestamp:e.timestamp,id:e.id,shuffled:e.shuffled,original:d,recommended:u,tracks:(Array.isArray(e.tracks_order)&&e.tracks_order.length?e.tracks_order.map((e=>d[e])):d).map((e=>e.data))};if(u.length)p.radio="up_next_artist";else{const{container:t}=e.contexts[0];if(t&&t.type===_u.LIVE)p.radio="livestream";else if(t&&t.type===_u.MIX){var m;p.radio=nh["mix"===(null==t||null===(m=t.extra)||void 0===m?void 0:m.oneofKind)&&t.extra.mix.type||0]||""}}return p}(a,t).then((t=>{n.queue=a,e.setTriforceState(t)})),getState(){var t;const a=n.quality||e.control.getAudioQuality()||"standard",i=this.getQueueId();let s,r,o;if(e.getMediaType()===qe.zu.LIVE_STREAM)o=0,s=e.getPosition(),r=e.getPosition()/2;else{var l;const t=null!==(l=e.getDuration())&&void 0!==l?l:180;s=Number(t),o=s,r=e.getPosition()/s}const c=null===(t=e.getSongId())||void 0===t?void 0:t.toString();return{queueId:i,track:c?{id:c,index:e.getTrackListIndex()}:void 0,buffered:o,volume:Number(e.isMuted()?0:e.getVolume()),progress:r,duration:s,quality:ih[a],isPlaying:e.isPlaying(),isShuffle:e.isShuffle(),repeatMode:e.getRepeat()}}}}class rh{constructor(e,t,n,a,i,s){this.discovery=void 0,this.currentReceiverConnection=void 0,this.player=void 0,this.playRequestHandler=void 0,this.deviceName=void 0,this.countryCode=void 0,this.enableTracking=void 0,this.player=sh(e,a),this.discovery=new Gm(t,Sd()()),this.deviceName=n,this.countryCode=i,this.enableTracking=s}set onPlayRequested(e){this.playRequestHandler=e}listenForRemotes(){this.discovery.listen(this.handleConnectionOffer.bind(this))}isConnectedToRemote(){return void 0!==this.currentReceiverConnection}disconnect(){return this.discovery.stop(),this.disconnectFromCurrentSender()}async disconnectFromCurrentSender(e){this.currentReceiverConnection&&(await this.currentReceiverConnection.disconnect(e),this.player.setDeviceID(void 0),this.currentReceiverConnection=void 0)}async handleConnectionOffer(e){const{command:t,queue:n}=await e.accept({device_name:this.deviceName,device_type:"web",supported_control_versions:["1.0.0-beta2"]});await this.disconnectFromCurrentSender("remote"),this.currentReceiverConnection=new th(this.player,t,n,this.countryCode,this.enableTracking),this.player.setDeviceID(e.from),this.currentReceiverConnection.onPlayRequested=()=>this.playRequestHandler?this.playRequestHandler():Promise.resolve(),this.currentReceiverConnection.connect(this.disconnectFromCurrentSender.bind(this,"timeout"))}}var oh=n("+Hyk"),lh=function(e){return e.UPDATE_STATE="updateState",e.JOIN="join",e.LEAVE="leave",e.PING="ping",e}(lh||{});function ch(e,t){return e>=([...t].sort(((e,t)=>e-t))[t.length-1]||0)}const dh=async(e,t)=>{switch(t){case"song":return await z.A.dispatch((0,Qu.d0)({ids:e})),(0,Hu.KW)(z.A.getState().entities,e);case"episode":return await z.A.dispatch((0,Bu.l$)({ids:e})),(0,Bu.KN)(z.A.getState().entities,e);case"live":return await z.A.dispatch((0,Gu.qS)({ids:e})),(0,Gu.b2)(z.A.getState().entities,e);default:throw new Error("Unhandled track type")}},uh=({onAutoplayBlocked:e})=>((0,i.useEffect)((()=>{let t;const n=(0,T.F6)(z.A.getState().user),a=function(e,t=""){if(!("BroadcastChannel"in window))return e(),()=>{};const n=new BroadcastChannel((t?t+"-":"")+"single-active-tab"),a=Date.now();let i=0,s={leadTab:void 0,tabs:[a]},r=()=>{s.leadTab=a,n.postMessage({type:lh.UPDATE_STATE,state:s}),e(),r=()=>{}};const o=()=>a===s.leadTab,l=setTimeout(r,500),c=setInterval((()=>{o()?n.postMessage({type:lh.PING}):Date.now()-i>6e4&&ch(a,s.tabs)&&r()}),5e3);return n.onmessage=e=>{const t=e.data;switch(t.type){case lh.JOIN:o()&&(s.tabs.push(t.id),n.postMessage({type:lh.UPDATE_STATE,state:s}));break;case lh.LEAVE:s.tabs=s.tabs.filter((e=>e!==t.id)),t.id===s.leadTab&&(s.leadTab=void 0,ch(a,s.tabs)&&r());break;case lh.PING:clearTimeout(l),i=Date.now();break;case lh.UPDATE_STATE:clearTimeout(l),i=Date.now(),s={...t.state}}},n.postMessage({type:lh.JOIN,id:a}),()=>{n.postMessage({type:lh.LEAVE,id:a}),n.close(),clearInterval(c)}}((()=>{let i=!1;const s=Qt.Ay?null===Qt.Ay||void 0===Qt.Ay?void 0:Qt.Ay.getHostname():jr.A.getBrowserName();t=new rh(Be.Ay,n,s,dh,(0,T.JJ)(z.A.getState().user),f.A.isAllowed("metric.remote_control")),t.onPlayRequested=()=>i?Promise.resolve():oh.A.audio({timeout:1e3}).then((({result:t})=>(i=t,t?Promise.resolve():e()))),t.listenForRemotes(),window.addEventListener("beforeunload",(()=>{t.disconnect(),a()}))}),n);return()=>{a(),t&&t.disconnect()}}),[]),null);var ph=n("vMeB");var gh=n("oN5d"),Ah=n("jUB+");const Eh=()=>{const[e,t]=i.useState({message:"",timerId:0});i.useEffect((()=>(gh.Ay.addEventListener(gh.v9.OPEN,n),()=>{gh.Ay.removeEventListener(gh.v9.OPEN,n)})));const n=n=>{clearTimeout(e.timerId);const a=(0,ph.A)((()=>t({message:"",timerId:0})),n.detail.duration||Ah.j);t({message:n.detail.body,timerId:a})};return""===e.message?null:i.createElement($.P.aside,{initial:{opacity:0,transform:"translate3d(200px, 0, 0)"},animate:{opacity:1,transform:"translate3d(0, 0, 0)"},role:"alert",className:"Y6Dsl"},i.createElement("div",{className:"mtZhp"},i.createElement("h2",{className:"LWPFL"},e.message)))};var fh,_h=n("+c3z");function vh(){return i.createElement(Yr.K2,null,i.createElement(Te.s,{alignItems:"center",background:"#EAD1FF",bottom:"var(--layout-player-height)",gap:"spacing.l",left:"0",p:"spacing.l",position:"fixed",w:"100%",zIndex:"2"},fh||(fh=i.createElement(Te.s,{alignItems:"center",background:"#A238FF3D",borderRadius:"2xs",flexShrink:0,height:"48px",justifyContent:"center",width:"48px"},i.createElement(_h.h,{size:"medium",color:"icon.accent.primary.default"}))),i.createElement(Te.s,{alignItems:"start",flexDirection:"column",flexGrow:1},i.createElement(Ce.D,{color:"text.neutral.primary.default",variant:"heading.s"},(0,X.AP)("unloggedhomepagevitrine_title_stickybanner_web")),i.createElement(ze.E,{display:{base:"none",md:"block"},color:"text.neutral.primary.default",variant:"body.l.default"},(0,X.AP)("unloggedhomepagevitrine_text_stickybanner_web"))),i.createElement(ye.$n,{flexShrink:0,as:"a",onClick:function(){var e;(0,yl.R2)({eventcategory:null!==(e=(0,yl.bg)())&&void 0!==e?e:"",eventaction:"signup-sticky"})},href:(0,Nn.t)({route:"register",comeback:!0})},(0,X.AP)("unloggedhomepage_action_signupforfree_web"))))}var bh=n("FuY1");let kh,Th,Ch;n("noe2");class Sh extends i.Component{constructor(){super(),this._onPageChanged=this._onPageChanged.bind(this),this._onPageDisplayed=this._onPageDisplayed.bind(this),this._updateWidth=this._updateWidth.bind(this),this._onTransitionEnd=this._onTransitionEnd.bind(this),this.state={isLoading:!1,width:0},this.contentRef=i.createRef()}componentDidMount(){E.A.subscribe(E.A.navigation.page_changed,this._onPageChanged),E.A.subscribe(E.A.navigation.page_displayed,this._onPageDisplayed)}componentWillUnmount(){clearTimeout(kh),clearTimeout(Ch),clearInterval(Th),E.A.unsubscribe(E.A.navigation.page_changed,this._onPageChanged),E.A.unsubscribe(E.A.navigation.page_displayed,this._onPageDisplayed)}render(){const e=(0,r.A)({"page-loader":!0,opened:this.state.isLoading}),t=(0,r.A)({"page-loader-bar":!0,"has-transition":this.state.hasTransition});return i.createElement("div",{className:e,id:"page_loader",ref:this.contentRef},i.createElement("div",{className:t,style:{width:`${this.state.width}%`}}))}_onPageChanged(){this.state.isLoading||(this.setState({isLoading:!0,hasTransition:!0,width:20+55*Math.random()}),kh=setTimeout((()=>{this._updateWidth(),Th=setInterval(this._updateWidth,1e3)}),1e3))}_onPageDisplayed(){setImmediate((()=>{this.state.isLoading&&(clearTimeout(kh),clearInterval(Th),this.setState({hasTransition:!1,width:100}),Ch=setTimeout((()=>{this.contentRef.current&&this.contentRef.current.addEventListener("transitionend",this._onTransitionEnd,!1),this.setState({isLoading:!1})}),500))}))}_onTransitionEnd(){this.setState({width:0}),this.contentRef.current&&this.contentRef.current.removeEventListener("transitionend",this._onTransitionEnd)}_updateWidth(){this.state.width>=90&&clearInterval(Th),this.setState({width:this.state.width+5})}}var Ih,wh,Ph=n("hYAH");function xh(){return i.createElement("div",{className:"modal",id:"modal",role:"dialog","aria-hidden":"true",style:{display:"none"}},Ih||(Ih=i.createElement("div",{className:"modal-backdrop"})),wh||(wh=i.createElement("div",{className:"modal-wrapper"})))}var Nh=n("o6eM"),Rh=n("G/O0"),Lh=n("V9V8"),Oh=n("Au7y");const Dh=({id:e,onClose:t,onError:n,userId:a,placeholders:r})=>{const[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),u=(0,s.wA)(),p=(0,Oh.oc)(),m=(0,s.d4)((({user:e})=>(0,T.Pe)(e))),h=(0,s.d4)((({user:e})=>(0,T.G8)(e))),y=(0,s.d4)((({user:e})=>(0,T.zJ)(e))),g=(0,s.d4)((({user:e})=>(0,T.Mn)(e))),A=(0,i.useMemo)((()=>new Lh.A),[]),E=(0,i.useMemo)((()=>new Nh.Ay((0,Dn.WV)({itemType:ua.Wi.CONFIG,itemName:"media-service"})||y,m,{timeService:A,trackTokenProvider:async function e(t,{fetchPolicy:n="cache-first"}={}){if(!p)return;const{data:a}=await p.query({fetchPolicy:n,query:Oh.J1`
								query TrackMediaToken($trackId: String!) {
									track(trackId: $trackId) {
										media {
											token {
												payload
												expiresAt
											}
										}
									}
								}
							`,variables:{trackId:t.id}}),{track:{media:{token:{payload:i="",expiresAt:s=Date.now()}={}}={}}={}}=a,r=new Nh.X8(i,{expire:new Date(s).getTime()});return r.isExpired(A.now())&&n.startsWith("cache")?e(t,{fetchPolicy:"network-only"}):r}})),[p,m,y,A]);return(0,i.useEffect)((()=>{var e;window.IASReady={_e:[()=>l(!0)]};const t=document.createElement("script");return t.async=!0,t.id="ias-wjs",t.src="https://sdk.inappstory.com/v2.4.3/dist/js/IAS.js",null===(e=document.getElementsByTagName("script")[0])||void 0===e||e.insertAdjacentElement("beforebegin",t),()=>{delete window.IASReady,t.remove()}}),[]),(0,i.useEffect)((()=>{if(!o)return;const{IAS:i}=window,s=(new i.AppearanceManager).setStoryReaderOptions({sharePanel:{targets:[]}}),l={};null==r||r.forEach((({key:e,value:t})=>{l[e]=t}));const c={apiKey:ma.default.get("inappstory_api_key"),userId:a,tags:[],placeholders:{blogname:g||"",...l},lang:"en"},p=new Rh.A,m=new i.StoryManager({...c},{storyLinkClickHandler:e=>{const{data:t}=e,{url:n}=t;(0,Sa.$)(n,{dispatch:u,lovedTracksId:h,userId:a})?m.closeStoryReader():window.open(n)}}),y=({payload:e})=>function(e,{mediaProvider:t,previewer:n,placeholders:a}){if(!e)return;let i;try{i=JSON.parse(e)}catch(e){return}switch(i.action){case"muteAudio":"boolean"==typeof i.data.isMuted&&(n.muted=i.data.isMuted);break;case"playAudio":{const{data:e}=i;let{content:s}=e;const{type:r}=e,o=null==a?void 0:a.find((e=>(null==e?void 0:e.key)===s));if(o&&(s=o.value),!s)break;"external"===r&&(n.load(s),n.volume=Be.Ay.getVolume()),"internal"===r&&t.getMedia({id:s},{type:Nh.Sq.PREVIEW}).then((e=>{const t=e.sources[0];t&&(n.load(t.url),n.volume=Be.Ay.getVolume())})).catch((()=>{}));break}case"stopAudio":n.stop()}}(e,{mediaProvider:E,previewer:p,placeholders:r});return m.on("closeStory",t),m.on("showSlide",y),m.showStory(e,s).then(d).catch(n),()=>{p.stop(),m.closeStoryReader(),m.off("closeStory",t),m.off("showSlide",y)}}),[r,u,e,h,E,t,n,o,g,a]),(0,i.useEffect)((()=>{if(!c)return;const e=Be.Ay.isPlaying();return Be.Ay.control.pause(),()=>{e&&Be.Ay.control.play()}}),[c]),null};var Mh=n("pIhH");const Uh=({story:e})=>e.id;var Fh,zh;function qh(){const e=(0,pe.W6)(),t=(0,s.wA)(),n=(0,s.d4)((({user:e})=>(0,T.F6)(e))),a=(0,s.d4)(Uh),{data:r,loading:o}=(0,we.ZO1)({variables:{storyId:a||""},skip:!a});(0,i.useEffect)((()=>{const n=e=>{const n=new URL(e).searchParams.get("stories");n&&t((0,Ph.o)({id:n}))};n(window.location.href);const a=e.listen((()=>{n(window.location.href)}));return()=>{a()}}),[]);const l=(0,i.useCallback)((()=>{window.location.href.includes("stories")&&e.replace(window.location.pathname),t((0,Ph.E)())}),[]),c=(0,i.useMemo)((()=>{var e;return(null==r||null===(e=r.me)||void 0===e||null===(e=e.simpleStory)||void 0===e?void 0:e.placeholders)||[]}),[r]);return i.createElement("div",{className:"page-shadow"},Fh||(Fh=i.createElement(xh,null)),a&&n&&!o?i.createElement(Dh,{id:a,onClose:l,onError:l,userId:n,placeholders:c}):null,f.A.isAllowed("reactivation_desktop_notification")&&(zh||(zh=i.createElement(Mh.Ay,null))))}var Bh=n("r2ys"),Gh=n("ebSJ"),Qh=n("uHHB");let Hh;var Wh,Yh,jh,Kh,$h,Jh,Xh,Zh,ey,ty,ny,ay,iy,sy,ry,oy,ly,cy,dy,uy;class py extends i.Component{constructor(e){super(e),e.updateCurrentPage(e.location.pathname),this._onLiveFeed=this._onLiveFeed.bind(this),this.state={error:null}}componentDidMount(){(()=>{if(void 0!==Hh)return Hh;if("undefined"!=typeof document){const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="-9999px",e.style.overflow="scroll",document.body.appendChild(e),Hh=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}else Hh=0;return Hh})()>0&&document.body.classList.add("force-scrollbar"),_.A.addInternalChannel("-1_"+this.props.userID+"_USERFEED_"+this.props.userID),_.A.init(),E.A.subscribe(E.A.live.feed,this._onLiveFeed),E.A.trigger(E.A.navigation.page_displayed,{path:this.props.location.pathname}),E.A.resolve(E.A.navigation.page_initialized),this.props.hasMultiAccountEnabled&&this.props.fetchChildAccount();const e=this._getSelectedAccount();!1!==e?this.props.selectChildAccount(e):this.props.isSubAccount?this.props.selectChildAccount(this.props.userID):this.props.hasNoChildAccountSelected&&!e&&this.props.openScreen({name:G.F.SELECT_PROFILE,data:{hasPreselectedMember:!1,allowScreenClose:!1}}),!f.A.isAllowed("public_api_onboarding")&&this.props.hasOnBoarding&&this.props.openScreen({name:G.F.ONBOARDING_LEGACY,data:{showGenreFilter:!0}}),this.props.location.query&&this.props.location.query.modal&&(0,x.C)(this.props.location.query.modal)&&this.props.openModal({name:this.props.location.query.modal}),(0,Gh.A)("hideBannerElectronUI")&&(0,Qh.A)("hideBannerElectronUI",!1,-1),this._displayProfileSelection(),this._displayAlerts()}shouldComponentUpdate(e,t){return this.props.location.pathname!==e.location.pathname||this.props.location.state!==e.location.state||this.props.hasNoChildAccountSelected!==e.hasNoChildAccountSelected||this.props.userID!==e.userID||!this.state.error&&t.error}componentDidUpdate(){window.scrollTo(0,0),E.A.trigger(E.A.navigation.page_changed,{path:this.props.location.pathname}),this.props.updateCurrentPage(this.props.location.pathname),E.A.trigger(E.A.navigation.page_displayed,{path:this.props.location.pathname}),this._hideAlerts(),!f.A.isAllowed("public_api_onboarding")&&this.props.hasOnBoarding&&this.props.openScreen({name:G.F.ONBOARDING_LEGACY,data:{showGenreFilter:!0}}),this.state.error&&this.setState({error:null})}componentDidCatch(e,t){this.setState({error:e.constructor.name}),e instanceof u.Dr||v.A.error(e,t)}componentWillUnmount(){E.A.unsubscribe(E.A.live.feed,this._onLiveFeed)}render(){if(this.props.hasNoChildAccountSelected)return Wh||(Wh=i.createElement("div",{className:"naboo"},i.createElement(Lp,null),i.createElement(j,null),i.createElement(qh,null),i.createElement(N.A,null)));const e=["/login","/register"].includes(this.props.location.pathname),t=(0,r.A)("naboo",{"with-banner":!this.props.isConnected});return i.createElement("div",(0,a.A)({className:t},{}),Yh||(Yh=i.createElement(Lp,null)),f.A.isAllowed("public_api_onboarding")?jh||(jh=i.createElement(Np,{toRenderWhenNoOnboarding:i.createElement(wp,null)})):!this.props.hasOnBoarding&&(Kh||(Kh=i.createElement(wp,null))),$h||($h=i.createElement(j,{withTransition:!0})),Jh||(Jh=i.createElement(ae,null)),Xh||(Xh=i.createElement(Eh,null)),Zh||(Zh=i.createElement(Sh,null)),e?null:ey||(ey=i.createElement(Ni,null)),e?null:ty||(ty=i.createElement(Mi,null)),this._renderMain(e),e||this.props.isConnected?null:ny||(ny=i.createElement(vh,null)),e?null:ay||(ay=i.createElement(Cp,null)),e?null:iy||(iy=i.createElement(ce.A,null)),sy||(sy=i.createElement(qh,null)),ry||(ry=i.createElement(dm,null)),f.A.isAllowed("remote_control")?i.createElement(uh,{onAutoplayBlocked:()=>new Promise((e=>{this.props.openModal({name:"REMOTE_CANNOT_AUTOPLAY",props:{onClose:e}})}))}):null,oy||(oy=i.createElement(N.A,null)),ly||(ly=i.createElement(oe,null)))}_renderMain(e){const t=(0,r.A)({"page-main":!0,"electron-auth":e});if(this.state.error)return i.createElement("div",{className:t,id:"page_content",role:"main"},cy||(cy=i.createElement(bh.A,null)));const n=this.props.location.pathname.replace(/^\/|\/$/g,"")===this.props.userLanguage;return i.createElement("div",{className:t,id:"page_content",role:"main"},i.createElement(le.A,{displayContentCard:n}),dy||(dy=i.createElement(de.s,null)),uy||(uy=i.createElement(Bh.A,null)),i.createElement(i.Suspense,{fallback:null},this.props.children))}_onLiveFeed(e,t){if(!t.length)return;const n=t[0];switch(n.ACTION){case"FRIEND_FOLLOW":case"PLAYLIST_COMMENT":case"SHARE":b.A.addNotification(n);break;default:b.A.addTicker(n,!0)}}_displayProfileSelection(){const{hasMultiAccountEnabled:e,hasParent:t,isSubAccount:n,isSubProfile:a}=this.props,{redirect:i}=c().parse(window.location.search,{ignoreQueryPrefix:!0});e&&"profiles"===i&&(!t||a&&!n)&&(this.props.openScreen({name:G.F.SELECT_PROFILE,data:{hasPreselectedMember:!1,allowScreenClose:!0}}),d.A.push((0,k.jd)("/")))}_displayAlerts(){const{isConnected:e,userOfferId:t,isHardbounce:n}=this.props;e&&!A.isDismissed(ee.jE)&&this.props.dispatchShowAlert(ee.jE,{userOfferId:t,onClose:()=>{A.markAsDismissed(ee.jE)}}),n&&this.props.dispatchShowAlert(ee.IV)}_hideAlerts(){const{alerts:e,dispatchHideAlert:t}=this.props;if(!e.length)return;const n=[ee.jE];e.filter((e=>n.includes(e.id))).forEach((e=>{t(e.id),A.markAsDismissed(e.id)}))}_getSelectedAccount(){return m.default.get("selectedChildAccount",!1,!0)}}py.defaultProps={userAge:"",userGender:"",hasNoChildAccountSelected:!1};const my=(0,s.Ng)((({user:e,alerts:t})=>({userID:e.USER.USER_ID,isConnected:(0,T.UJ)(e),hasOnBoarding:e.USER.ONBOARDING_MODAL,userAge:(0,T.QO)(e),userGender:(0,T.o_)(e),userLanguage:(0,T.Z0)(e),userOfferId:(0,T.id)(e),hasNoChildAccountSelected:(0,T.In)(e),alerts:t,isSubProfile:(0,T.W$)(e),isHardbounce:e.USER.HARDBOUNCED_EMAIL,hasParent:(0,T.p7)(e),hasMultiAccountEnabled:(0,T.mE)(e),isSubAccount:(0,T.m0)(e),displayCommunicationPreferencesUpdateBanner:!0===e.__DZR_GATEKEEPS__.display_communication_preferences_update_banner})),{selectChildAccount:C.me,updateCurrentPage:S.yf,openScreen:I.J2,openModal:P.qf,dispatchShowAlert:w.S7,dispatchHideAlert:w.Hd,fetchChildAccount:C.C9}),hy=my((0,o.Ay)((e=>({virtualpageurl:e.location.pathname,language:e.userLanguage,uilogged:e.isConnected})),{process:e=>e.pagename?e:null,dispatch:e=>{if(void 0!==window.dataLayer){const t=Object.assign({},e);e.pagecategory===Ct.CONTEXT_PAGE_SEARCH&&(t.pagename=Ct.CONTEXT_PAGE_SEARCH),window.dataLayer.push(t)}(0,p.TD)(e)}})(py))},r2ys:(e,t,n)=>{n.d(t,{A:()=>r});var a=n("q1tI"),i=n("uHHB"),s=n("vGT4");const r=()=>{const{state:e}=(0,s.b)(),t=(e=>null==e?void 0:e.settings)(e);return(0,a.useEffect)((()=>{const{consentString:e,statistics:n=0,targetedAdvertising:a=0}=t||{};window.sas&&window.sas.cmd.push((()=>{window.sas.setGdprConsentData(e)})),(0,i.A)("consentStatistics",n.toString(),100),(0,i.A)("consentMarketing",a.toString(),100)}),[t]),null}},"rYh+":(e,t,n)=>{n.d(t,{A:()=>c});var a=n("q1tI"),i=n("juqV"),s=n("TRpf"),r=n("RSbz"),o=n("6vqc");class l extends a.Component{render(){const{className:e,langDirection:t,size:n}=this.props,s="rtl"===t?r.Y:o.v,l=(0,i.A)(e,"animate-wobble-target");return a.createElement(s,{className:l,boxSize:`${n}px`})}}l.defaultProps={size:"16",langDirection:"ltr"};const c=(0,s.Ng)((({user:e})=>({langDirection:e.DIRECTION})))(l)},vHlZ:(e,t,n)=>{n.d(t,{A:()=>p});var a,i=n("+9dH"),s=n("q1tI"),r=n("okj2"),o=n("HmE0"),l=n("YIja"),c=n("7bxg"),d=n("mUtM"),u=n("TRpf");const p=({id:e,onClose:t,message:n,action:p,...m})=>{const h=(0,u.wA)(),y=s.createElement(r.z,{spacing:"spacing.s"},p,s.createElement(o.K0,{"aria-label":"close","data-testid":"alert-close-btn",icon:a||(a=s.createElement(c.w,null)),key:"close",onClick:n=>{h((0,d.Hd)(e)),t&&t(n)},type:"button",size:"small",variant:"outline"}));return s.createElement(l.N,(0,i.A)({borderRadius:"0","data-testid":`alert-${e}`,action:y},m),n)}},wGgI:(e,t,n)=>{n.d(t,{qT:()=>u,VX:()=>p,y8:()=>d,Ay:()=>h});var a=n("q1tI"),i=n("juqV"),s=n("HmE0"),r=n("yCtO");class o extends a.Component{render(){const{children:e,isDisabled:t,isSelected:n}=this.props,s=(0,i.A)("dropdown-item",{hidden:t,"is-selected":n});return a.createElement("li",{className:s},e)}}o.defaultProps={isDisabled:!1,isSelected:!1};const l=o;var c;const d="sm",u="left",p="right";class m extends a.Component{constructor(e){super(e),this._onToggle=this._onToggle.bind(this),this._onClose=this._onClose.bind(this),this.state={label:e.children[e.selected].props.label||e.label,isOpen:!1}}static getDerivedStateFromProps(e){return{label:e.children[e.selected].props.label||e.label}}render(){const{children:e,align:t,size:n,overflow:o,isDisabled:l}=this.props,{label:d,isOpen:u}=this.state,m=(0,i.A)("dropdown",{"dropdown-active":this.state.isOpen}),h=(0,i.A)("dropdown-menu",{"is-right":t===p,"is-overflow":o});return a.createElement("span",{className:m},a.createElement(s.$n,{"data-testid":`dropdown_${d}`,size:n,rightIcon:c||(c=a.createElement(r.e,null)),onClick:this._onToggle,variant:"outline",isDisabled:l},d),a.createElement("ul",{className:h,"aria-hidden":!u,onClick:this._onClose,onMouseDown:e=>e.stopPropagation()},u?e:null))}_onClose(){this.setState({isOpen:!1},(()=>{document.removeEventListener("mousedown",this._onClose)}))}_onToggle(){const e=!this.state.isOpen;this.setState({isOpen:e},(()=>{e&&document.addEventListener("mousedown",this._onClose)}))}}m.defaultProps={label:null,size:d,align:u,className:null,selected:0,overflow:!1,isDisabled:!1},m.Item=l;const h=m},xvdY:(e,t,n)=>{n.d(t,{A:()=>A});var a,i,s=n("q1tI"),r=n("TRpf"),o=n("fJgm"),l=n("OPhi"),c=n("GkgI"),d=n("5G9X"),u=n("PN+J"),p=n("HmE0"),m=n("P4bz"),h=n("//u0"),y=n("gtRZ");class g extends s.Component{constructor(e){super(e),this._handleToggle=this._handleToggle.bind(this),this._handleDoubleClick=this._handleDoubleClick.bind(this)}shouldComponentUpdate(e){return this.props.isFavorite!==e.isFavorite||this.props.id!==e.id}render(){const{className:e,isFavorite:t,type:n,tooltip:r,tooltipPosition:o,isDisabled:l}=this.props,c=this._getTooltip(),g=s.createElement(p.K0,{"data-testid":n!==d.Ay.User?"add_to_favorite_button_"+(t?"on":"off"):void 0,variant:"ghost",size:"small",isDisabled:l,onClick:this._handleToggle,onDoubleClick:this._handleDoubleClick,"aria-label":c,icon:s.createElement(s.Fragment,null,n===d.Ay.User&&s.createElement(m.H,{color:t&&"icon.accent.primary.default"}),n!==d.Ay.User&&t&&(a||(a=s.createElement(h.C,{color:"icon.accent.primary.default"}))),n!==d.Ay.User&&!t&&(i||(i=s.createElement(y.M,null)))),className:e});return r&&!l?s.createElement(u.m,{label:c,placement:o},g):g}_handleDoubleClick(e){e.stopPropagation()}_handleToggle(e){e.stopPropagation();const{isFavorite:t,type:n,id:a,context:i,onAdd:s,onRemove:r}=this.props,l={type:n,id:a,context:i};if(t){if(r)return void r(o.A,l);o.A.remove(l)}else{if(s)return void s(o.A,l);o.A.add(l)}}_getTooltip(){const{isFavorite:e,type:t}=this.props;return"song"===t?(0,c.b)({type:t,action:"favorite"},e?"hover":"add","full"):""}}g.defaultProps={type:d.Ay.Album,tooltip:!1,tooltipPosition:"top",isDisabled:!1};const A=(0,r.Ng)((({feedbacks:e},t)=>({isFavorite:(0,l.BA)(e,t.id,t.type)})))(g)}}]);