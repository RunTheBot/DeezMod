"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[9774],{"0VGm":(e,t,a)=>{a.r(t),a.d(t,{default:()=>cl});var s=a("q1tI"),l=a("TRpf"),r=a("XiPH"),n=a("lXQd"),i=a("XOWT"),o=a("nrKQ"),c=a("WKgy"),d=a("xSQY"),m=a("5G9X"),p=a("X6oL"),u=a("34sk"),h=a("xobL"),A=a("mKPD"),E=a("xckG"),_=a("4rpV"),y=a("Gr39"),b=a("8L3l"),g=a("ZPsS"),f=a("HGOC");const P={albums:m.Ay.Album,artists:m.Ay.Artist,loved:m.Ay.Song,playlists:m.Ay.Playlist,radios:m.Ay.Radio,shows:m.Ay.Show},T=new r.wQ.Entity("PROFILE_TAB",{album:new r.wQ.Array(E.A),artist:new r.wQ.Array(_.A),playlist:new r.wQ.Array(y.A),radio:new r.wQ.Array(b.A),show:new r.wQ.Array(g.A),song:new r.wQ.Array(f.A)},{idAttribute:()=>"entities",processStrategy:e=>{const t={};for(const[a,s]of Object.entries(e)){const e=P[a];e&&(0,A.SF)(e)&&(t[e]=s.data||[])}return t}}),w=new r.wQ.Entity("USERS",{},{idAttribute:"USER_ID"});var v=a("iiSH"),S=a("FSqQ"),I=a("17x9"),C=a.n(I),N=a("Ty5D"),R=a("juqV"),x=a("H/eQ"),L=a("Wp0Y"),F=a("iooo"),D=a("LOQS"),O=a("7E8A"),k=a("iyH+"),M=a("cFUB"),U=a("U9ZG"),B=a("OPhi"),G=a("+dDc");class H extends s.Component{render(){return s.createElement(s.Fragment,null,this._renderFollowAction(),this._renderShuffleAction())}_renderFollowAction(){const{id:e,isFollowed:t,isHiddenUser:a,isPersonal:l,onFollowToggle:r}=this.props;return l||a?null:s.createElement(k.$,{id:e,color:M.cW.PRIMARY,type:m.Ay.User,action:M.Hj.FOLLOW,context:{ID:e,TYPE:O.CONTEXT_PAGE_PROFILE},isFollowed:t,onToggleState:r})}_renderShuffleAction(){const{id:e,isPersonal:t,isHiddenUser:a,hasPersonalPlaylist:l,hasFavoritePlaylist:r,hasFavoriteAlbum:n,hasEnoughFavoriteSong:i}=this.props;return!t||a?null:r||n||l||i?s.createElement(U.A,{id:e,type:m.Ay.User,action:["shuffle"],data:this.context.data,context:{ID:this.props.id,TYPE:"shuffled_collection"}}):null}}H.contextTypes={data:C().object};const z=(0,l.Ng)((({user:e,entities:t,feedbacks:a})=>({hasPersonalPlaylist:Object.keys((0,G.eL)(t,(0,h.F6)(e))).length>0,hasFavoritePlaylist:(0,B.pp)(a,m.Ay.Playlist)>0,hasFavoriteAlbum:(0,B.pp)(a,m.Ay.Album)>0,hasEnoughFavoriteSong:(0,B.pp)(a,m.Ay.Song)>10})))(H);var W=a("MTsA"),X=a("2NhJ"),Y=a("oq/a"),j=a("zJSK"),Z=a("WY4A"),K=a("Ozpl"),J=a("wRgy"),$=a("JKL/"),q=a("23Qi"),Q=a("kPsn"),V=a("V1gm");class ee extends s.Component{render(){const{name:e,isPersonal:t,isHiddenUser:a}=this.props,l=(0,R.A)("profile-header-container",{"is-private":a});return s.createElement("div",{className:l},s.createElement("div",{className:"container"},s.createElement(X.Ay,null,this._renderThumbnail(),s.createElement(Y.A,{className:"profile-header-info"},s.createElement(j.A,null,t?(0,L.AP)("menu_title_favorites_web"):e),this._renderSubtitle())),this._renderToolbar(),this._renderNavbar()))}_renderSubtitle(){const{nbFollower:e,nbFollowing:t,isHiddenUser:a}=this.props;if(a)return null;const l=(0,L.WI)("%s follower","%s followers",{sprintf:[(0,q.A)(e)],count:e}),r=(0,L.WI)("%s following","%s following",{sprintf:[(0,q.A)(t)],count:t});return s.createElement(Z.A,null,s.createElement(K.A,null,l),s.createElement(K.A,null,r))}_renderThumbnail(){var e;const{name:t,picture:a,isHiddenUser:l,isPersonal:r}=this.props;if(r)return null;const{urls:n}=(0,Q.jg)(m.Ay.User,null,{__TYPE__:m.Ay.User,USER_PICTURE:l?"":a});return s.createElement(J.A,{alt:t,src:null===(e=n.large)||void 0===e?void 0:e[0],borderRadius:"rounded",type:m.Ay.User,"data-testid":"user-cover"})}_renderToolbar(){const{id:e,onFollowToggle:t,isFollowed:a,isPersonal:l,isHiddenUser:r}=this.props;return s.createElement($.A,null,s.createElement(z,{onFollowToggle:t,id:e,isFollowed:a,isPersonal:l,isHiddenUser:r}))}_renderNavbar(){const{tabList:e,activeTab:t,isHiddenUser:a}=this.props;return a?null:s.createElement(W.A,{items:e,active:t,align:"left"})}}ee.contextTypes={data:C().object},ee.defaultProps={nbFollower:0,nbFollowing:0,isPersonal:!1,tabList:[],activeTab:"home",isHiddenUser:!1};const te=(0,l.Ng)((({entities:e},{id:t})=>({name:(0,V.Nc)(e,t)||"",picture:(0,V.aR)(e,t)||""})))(ee);a("WpbS"),a("/eM8");var ae=a("p/gB"),se=a("AY3M"),le=a("tZCQ"),re=a("shsj"),ne=a("H9Ex"),ie=a("eq2Y"),oe=a("b5vm"),ce=a("wGgI"),de=a("lpJY"),me=a("X/JG"),pe=a("HmE0"),ue=a("7bxg"),he=a("6vRd"),Ae=a("fkXJ"),Ee=a("Vsul"),_e=(a("pxP/"),a("70bL"));var Pe,Te=a("g1Fm");const we=({onClose:e})=>{const a=(0,l.d4)(_e.sc),[r,n]=(0,l.d4)((e=>[(0,h.F6)(e.user),(0,h.Mn)(e.user)])),[i,o]=s.useState(!1);return s.createElement("div",{className:"Tytst","data-testid":"library-transfer-banner"},s.createElement("button",{className:"sL356",onClick:()=>{(0,he.K)(),e&&e()},type:"button"},Pe||(Pe=s.createElement(ue.w,null))),s.createElement("p",{className:"_rMIA"},(0,L.AP)("libraryimporter_title_transferyourfavorites_web")),s.createElement("p",{className:"aayeA"},(0,L.AP)("libraryimporter_text_moveplaylistsandfavoritestodzr_web")),s.createElement(pe.$n,{colorScheme:"white",size:"sm",onClick:async()=>{o(!0);const e=await(0,he.r)(r,n,true).catch((()=>(0,Ae.A)({body:(0,L.AP)("Une erreur est survenue, merci de rÃ©essayer plus tard.")})));e&&(0,Ee.A)(e),o(!1)},isDisabled:i||!a},(0,Te.A)((0,L.AP)("libraryimporter_action_selectaserviceUPP_web"),!0)))};var ve=a("TqF5"),Se=a("aoCz"),Ie=a("7Gye");var xe;const Le=({handleAdd:e,label:t,rounded:a=!1})=>{const l=(0,R.A)("thumbnail",{"thumbnail-bordered":!a,"thumbnail-rounded":a}),r=(0,R.A)("thumbnail-caption",{"is-centered":a});return s.createElement(s.Fragment,null,s.createElement("div",{className:l},s.createElement("button",{type:"button",className:"BEemH","aria-label":t,onClick:e},s.createElement("div",{className:"picture-img"},s.createElement("div",{className:"cCDZT"},xe||(xe=s.createElement(Ie.c,{size:"medium",scale:3,color:"icon.neutral.primary.default"})))))),s.createElement("div",{className:r},s.createElement("div",{className:"heading-4"},s.createElement("button",{type:"button",className:"Ztl2n",onClick:e},t))))},Fe=()=>{const e=(0,l.wA)();return s.createElement(Le,{handleAdd:()=>{e((0,ve.qf)({name:"PLAYLIST_ASSISTANT",props:{type:Se.F.CREATION}}))},label:(0,L.AP)("playlistspage_title_createaplaylist_web")})};var De=a("nxAS"),Oe=a("/uRm"),ke=a("I36q");const Me=({callbackLink:e="/profile/me"})=>{const t=(0,l.wA)();return s.createElement(Le,{rounded:!0,handleAdd:()=>{t((0,De.J2)({name:le.A.isAllowed("public_api_onboarding")?Oe.F.ONBOARDING:Oe.F.ONBOARDING_LEGACY,data:{showCloseButton:!0,context:ke.d.Improve,isOnlyAddArtist:!0,callbackLink:e}}))},label:(0,L.AP)("onboardingartistpicker_title_addartists_web")})};var Ue,Be,Ge=a("y7xR"),He=a("vF4p"),ze=a("0JBE");class We extends s.Component{constructor(e){super(e);const{albums:t,artists:a,playlists:s,shows:l,top_album:r,recently_played:n}=e.data;this.state={data:e.data,albums:t,artists:a,playlists:s,shows:l,recentlyPlayed:n,selectedTop:r&&r.total?"top_album":"top_track",isLibraryTransferBannerClosed:!1},this._onSwitchTop=this._onSwitchTop.bind(this),this._onLibraryTransferBannerClose=this._onLibraryTransferBannerClose.bind(this)}static getDerivedStateFromProps(e,t){if(!e.data)return null;const{albums:a,artists:s,playlists:l,shows:r,top_album:n,recently_played:i}=e.data,o=n&&n.total?"top_album":"top_track";return{data:e.data,albums:a,artists:s,playlists:l,shows:r,recentlyPlayed:i,selectedTop:t.selectedTop!==o?t.selectedTop:o,isLibraryTransferBannerClosed:t.isLibraryTransferBannerClosed}}async componentDidMount(){const e={album:{ids:Object.keys(this.props.cachedAlbums),loader:this.props.loadAlbum},playlist:{ids:Object.keys(this.props.cachedPlaylists),loader:this.props.loadPlaylist},show:{ids:Object.keys(this.props.cachedShows),loader:this.props.loadShow}};await Promise.all(Object.values(e).map((({ids:e,loader:t})=>e.reduce(((e,a)=>e.then((()=>t({id:a})))),Promise.resolve()))))}render(){return s.createElement(ze.OJ,{value:{page:"favorite_tab"}},this._renderLibraryTransfer(),this._renderPlayedSection(),this._renderContent())}_renderLibraryTransfer(){const{data:e,isLibraryTransferBannerClosed:t}=this.state;return this.props.isMe&&e.display_tmm_entrypoint&&!t?s.createElement("div",{className:"container"},s.createElement("section",{className:"user-section"},s.createElement(we,{onClose:this._onLibraryTransferBannerClose}))):null}_renderPlayedSection(){return this.props.isMe&&this.state.recentlyPlayed&&this.state.recentlyPlayed.data.length>0?this._renderRecentlyPlayed():this._renderTops()}_renderRecentlyPlayed(){const{recentlyPlayed:e}=this.state,t=e.data&&e.data.length>0?[...e.data]:[],a=this._filterRecentlyPlayed(t);return 0===a.length?this._renderTops():s.createElement("section",{className:"user-section"},s.createElement(me.A,{key:"profile_recently_played",title:(0,L.AP)("favoritestab_title_recentlyplayedcontent_web"),data:a,pageContext:O.CONTEXT_PAGE_PROFILE_RECENTLY_PLAYED,alignment:"left",context:"profile_recently_played"},s.createElement(de.A,{data:a,pageContext:O.CONTEXT_PAGE_PROFILE_RECENTLY_PLAYED,context:"profile_recently_played",nbLines:1})))}_renderTops(){const e=this.state.data,{selectedTop:t}=this.state;if(!e.top_track.total&&!e.top_album.total&&!e.top_artist.total)return null;const a={top_track:{key:"profile_top_tracks",data:e.top_track.data,total:e.top_track.total,label:(0,L.AP)("Titres"),context:"profile_top_tracks",placeholder:(0,L.AP)("Aucun Top Titres")},top_album:{key:"profile_top_albums",data:e.top_album.data,total:e.top_album.total,label:(0,L.AP)("favoritessidebar_title_albums_web"),context:"profile_top_albums",placeholder:(0,L.AP)("Aucun Top Albums")},top_artist:{key:"profile_top_artists",data:e.top_artist.data,total:e.top_artist.total,label:(0,L.AP)("Artistes"),context:"profile_top_artists",placeholder:(0,L.AP)("Aucun Top Artistes")}},l=s.createElement(ce.Ay,{label:a[t].label},Object.entries(a).map((([e,a])=>s.createElement(ce.Ay.Item,{key:e,isSelected:e===t},s.createElement("button",{"data-testid":e,type:"button",onClick:this._onSwitchTop.bind(this,e)},a.label)))));let r={key:a[t].key,data:a[t].data,context:a[t].context,pageContext:O.CONTEXT_PAGE_PROFILE_TAB_HOME,nbLines:1,placeHolder:{img:"nocontent",wording:a[t].placeholder}};return s.createElement("div",{className:"container"},s.createElement("section",{className:"user-section"},s.createElement("div",{className:"user-section-title top-title clearfix"},s.createElement(Ge.D,{variant:"heading.m"},(0,L.AP)("Top")),s.createElement("div",{className:"action-top-page"},l)),s.createElement(de.A,r)))}_renderContent(){const{isMe:e,downloaded:t,userHasDownload:a}=this.props,{playlists:l,albums:r,artists:n,shows:i}=this.props.data;let o={};a&&e&&(o.downloads={data:t,total:t.length,tab:He.E6.downloads}),Object.assign(o,{playlists:{data:l.data,total:l.total,tab:He.E6.playlists},albums:{data:r.data,total:r.total,tab:He.E6.albums},artists:{data:n.data,total:n.total,tab:He.E6.artists}}),le.A.isAllowed("talk")&&(o.shows={data:i.data,total:i.total,tab:He.E6.shows});let c=[];return Object.entries(o).forEach((([e,t])=>{const a=this._renderPrependElement(e);if(t.total>0||void 0!==a){const l=t.data.map((e=>({...e,context:(0,ae.Pe)(e.__TYPE__||e.type,se.z6)})));c.push(s.createElement("section",{className:"user-section",key:"profile_page_home_"+e},s.createElement(me.A,{title:this._getTitle(e),target:`/profile/${this.props.id}/${t.tab}`,hasMoreItems:t.total>0,related:{target:`/profile/${this.props.id}/${t.tab}`,label:(0,L.AP)("Voir tout")},data:l,pageContext:O.CONTEXT_PAGE_PROFILE_TAB_HOME,prependElement:a,alignment:"left",tab:t.tab},s.createElement(de.A,{hasMoreItems:t.total>0,related:{target:`/profile/${this.props.id}/${t.tab}`,label:(0,L.AP)("Voir tout")},data:l,pageContext:O.CONTEXT_PAGE_PROFILE_TAB_HOME,prependElement:a,nbLines:1}))))}})),c}_renderPrependElement(e){const{isMe:t}=this.props;if(t)return e===He.E6.playlists?Ue||(Ue=s.createElement(Fe,null)):e===He.E6.artists?Be||(Be=s.createElement(Me,null)):void 0}_onSwitchTop(e){this.state.selectedTop!==e&&this.setState({selectedTop:e})}_onLibraryTransferBannerClose(){this.setState({isLibraryTransferBannerClosed:!0})}_getTitle(e){return{downloads:(0,L.AP)("TÃ©lÃ©chargÃ©"),playlists:(0,L.AP)("Playlists"),albums:(0,L.AP)("favoritessidebar_title_albums_web"),artists:(0,L.AP)("Artistes"),shows:(0,L.AP)("Podcasts")}[e]}_filterRecentlyPlayed(e=[]){const t=[m.Ay.Album,m.Ay.Artist,m.Ay.Livestream,m.Ay.Playlist,m.Ay.Radio,m.Ay.Show,m.Ay.User];return e.filter((({__TYPE__:e})=>t.includes(e))).map((({__TYPE__:e,...t})=>e===m.Ay.User?{id:t.USER_ID,subtitle:String(t.USER_ID)===String(this.props.userID)?(0,L.AP)("flowcarddescription_text_aninfinitemixoffavoritesandnew_web"):t.BLOG_NAME,context:{ID:Number(t.USER_ID),TYPE:(0,ae.C3)(m.Ay.Flow)},__TYPE__:m.Ay.Flow}:{...t,context:{ID:Number(t[m.vn[e]]),TYPE:(0,ae.C3)(e)},__TYPE__:e===m.Ay.User?m.Ay.Flow:e}))}}We.defaultProps={cachedAlbums:{},cachedPlaylists:{},cachedShows:{}};const Xe=(0,l.Ng)((e=>{const{all:t}=(0,re.w1)(e.cache,e.entities,(0,h.F6)(e.user));return{userID:e.user.id,userHasDownload:(0,h.Jt)(e.user),cachedAlbums:e.cache.album,cachedPlaylists:e.cache.playlist,cachedShows:e.cache.show,downloaded:t}}),{loadAlbum:ne.eQ,loadPlaylist:ie.vW,loadShow:oe.A5})(We);var Ye=a("mk5l"),je=a("o+h5"),Ze=a("hIIJ"),Ke=a("Z9kq"),Je=a("h8EF");class $e extends s.Component{constructor(){super(),this._onChangeSearch=this._onChangeSearch.bind(this),this.state={query:"",filter:""}}componentDidMount(){(async()=>{for(let e of Object.keys(this.props.cachedAlbums))await this.props.loadAlbum({id:e})})(),(async()=>{for(let e of Object.keys(this.props.cachedPlaylists))await this.props.loadPlaylist({id:e})})(),(async()=>{for(let e of Object.keys(this.props.cachedShows))await this.props.loadShow({id:e})})(),D.A.log({type:"cdp",eventName:"screen_view",customAttributes:{screen_view_name:Je.bv.downloads}})}render(){return s.createElement("section",{className:"user-section"},s.createElement("div",{className:"container clearfix"},s.createElement("div",{className:"user-section-title"},le.A.isAllowed("revamp2023")?s.createElement(Ze.A,{title:(0,L.WI)("desktopapp_title_Xdownloads_web","desktopapp_title_Xdownloads_web",{sprintf:[(0,q.A)(this.props.all.length)],count:this.props.all.length})}):s.createElement("h1",{className:"heading-1"},(0,L.WI)("desktopapp_title_Xdownloads_web","desktopapp_title_Xdownloads_web",{sprintf:[(0,q.A)(this.props.all.length)],count:this.props.all.length})),this._renderActions())),this._renderAll(),this._renderAlbums(),this._renderPlaylists(),this._renderShows())}_renderActions(){return s.createElement("div",{className:"action-top-page"},s.createElement("div",{className:"btn-group user-search"},s.createElement(Ke.D,{size:"small",onChange:this._onChangeSearch,placeholder:(0,L.AP)("Rechercher")})))}_renderAll(){if(""===this.state.filter&&0!==this.props.all.length)return null;const e=this.props.all.map((e=>({...e,context:(0,ae.Pe)(je.Ay.parser.type(e),se.z6)})));return s.createElement("div",{className:"container clearfix"},s.createElement(de.A,{data:e,filter:this.state.filter,pageContext:O.CONTEXT_PAGE_PROFILE_TAB_DOWNLOADS}))}_renderAlbums(){return""!==this.state.filter||0===this.props.albums.length?null:s.createElement("div",{className:"container clearfix"},s.createElement(Ze.A,{title:(0,L.AP)("favoritessidebar_title_albums_web"),mb:"spacing.xl"}),s.createElement(de.A,{context:(0,ae.Pe)(m.Ay.Album,se.z6),data:this.props.albums,pageContext:O.CONTEXT_PAGE_PROFILE_TAB_DOWNLOADS}))}_renderPlaylists(){return""!==this.state.filter||0===this.props.playlists.length?null:s.createElement("div",{className:"container clearfix"},le.A.isAllowed("revamp2023")?s.createElement(Ze.A,{title:(0,L.AP)("Playlists"),mb:"spacing.xl"}):s.createElement("div",{className:"user-section-title top-title clearfix"},s.createElement("h2",{className:"heading-2"},(0,L.AP)("Playlists"))),s.createElement(de.A,{context:(0,ae.Pe)(m.Ay.Playlist,se.z6),data:this.props.playlists,pageContext:O.CONTEXT_PAGE_PROFILE_TAB_DOWNLOADS}))}_renderShows(){return""!==this.state.filter||0===this.props.shows.length?null:s.createElement("div",{className:"container clearfix"},le.A.isAllowed("revamp2023")?s.createElement(Ze.A,{title:(0,L.AP)("Podcasts"),mb:"spacing.xl"}):s.createElement("div",{className:"user-section-title top-title clearfix"},s.createElement("h2",{className:"heading-2"},(0,L.AP)("Podcasts"))),s.createElement(de.A,{context:(0,ae.Pe)(m.Ay.Show,se.z6),data:this.props.shows,pageContext:O.CONTEXT_PAGE_PROFILE_TAB_DOWNLOADS}))}_onChangeSearch(e){this.setState({query:e,filter:(0,Ye.A)(e.toLowerCase().trim())})}}$e.defaultProps={cachedAlbums:{},cachedPlaylists:{},cachedShows:{}};const qe=(0,l.Ng)((({entities:e,user:t,cache:a})=>{const{all:s,albums:l,playlists:r,shows:n}=(0,re.w1)(a,e,(0,h.F6)(t));return{userID:t.id,cachedAlbums:a.album,cachedPlaylists:a.playlist,cachedShows:a.show,all:s,albums:l,playlists:r,shows:n}}),{loadAlbum:ne.eQ,loadPlaylist:ie.vW,loadShow:oe.A5})($e);a("Dk60");var Qe=a("M3gt"),Ve=a("8m9I"),et=a("AfN5"),tt=a("STEc");const at={TITLE:{SIZE:tt.uq.Full},ARTIST:{SIZE:tt.uq.PercentXs},PARENT:{BREAKPOINT:tt.x1.md,SIZE:tt.uq.PercentXs},DATE:{BREAKPOINT:tt.x1.md,SIZE:tt.uq.xl},DURATION:{SIZE:tt.uq.sm},SELECT:{ALIGN:tt.uP.Right,SIZE:tt.uq.sm}};var st,lt,rt,nt=a("xCFc"),it=a("BP9I"),ot=a("1Uwb"),ct=a("XLml"),dt=a("fSLK"),mt=a("/G5K"),pt=a("pQlO"),ut=a("r4LN"),ht=a("wkd/"),At=a("LGn+"),Et=a("tgyz"),_t=a("CxZw"),yt=a("SehT");const bt=(0,s.memo)((0,ze.S2)((({data:e,index:t,style:a})=>{const{context:l,container:r,loadingStatus:i,shouldExplicitBeHidden:o}=(0,nt.$A)(),{playerStatus:c,play:d,isItemLoadedInPlayer:p}=(0,Et.A)(l,r,i.isFullyFetched,!0),u=e.toDisplay[t],h=u.item.hasExplicitLyrics&&o,A=(0,s.useCallback)(((t,a)=>{d({playIndex:a,playItems:e.toPlay,isTrackActive:t})}),[e.toPlay,d]),E=(0,s.useCallback)((t=>{d({notify:!1,playIndex:t,playItems:e.toPlay,playLyrics:!0})}),[e.toPlay,d]);return s.createElement(ot.A.Row,{style:a,uuid:u.uuid,id:u.item.id,index:u.index,isActive:p(u.item)&&c.isSameContext,isReadable:u.item.right===_t.A.READABLE,isRestrictedByExplicit:h,type:u.item.type,isDraggable:!0},s.createElement(At.A,{size:at.TITLE.SIZE},s.createElement(At.A.Play,{ariaLabel:(0,L.AP)("generic_action_playsongXbyartistX_web",{sprintf:[u.item.title,(0,n.A)(u,"item.artists[0].name","")]}),hasExplicitCover:u.item.parent.hasExplicitCover,onPlayItems:A,pictureUrl:u.item.cover(je.r4).url}),st||(st=s.createElement(At.A.Download,null)),s.createElement(At.A.PlayableLabel,{hasExplicitLyrics:u.item.hasExplicitLyrics,label:u.item.title,onPlayItems:A,tooltipText:(0,yt.Y)(u.item,o)}),s.createElement(ot.A.IconGroup,null,s.createElement(At.A.ShowLyrics,{item:u.item,lyricsId:u.item.lyricsId,onPlayLyrics:E}),lt||(lt=s.createElement(At.A.AddToFeedback,null)),s.createElement(At.A.OpenContextMenu,{item:u.item}))),s.createElement(ot.A.CellBody,{size:at.ARTIST.SIZE},s.createElement(ut.A,{links:u.item.artists.map((e=>({...e,type:m.Ay.Artist})))})),s.createElement(ot.A.CellBody,{breakpoint:at.PARENT.BREAKPOINT,size:at.PARENT.SIZE},s.createElement(ut.A,{links:[{...u.item.parent,type:m.Ay.Album}]})),s.createElement(ot.A.CellBody,{breakpoint:at.DATE.BREAKPOINT,size:at.DATE.SIZE},s.createElement(mt.A,{date:1e3*u.item.date})),s.createElement(ot.A.CellBody,{size:at.DURATION.SIZE},s.createElement(pt.A,{duration:u.item.duration})),s.createElement(ot.A.CellBody,{align:at.SELECT.ALIGN,size:at.SELECT.SIZE},rt||(rt=s.createElement(ht.A,null))))}),(({index:e,data:t})=>({item:m.Ay.Track,itemIndex:e,itemId:t.toDisplay[e].item.id}))),dt.t7);var gt,ft,Pt,Tt,wt=a("ZH8F"),vt=a("dalA"),St=a("3AbJ"),It=a("ftFY"),Ct=a("7u2F");const Nt=({context:e,isFullyFetched:t,items:a,nextFetchDataIndex:l,onFetch:r,userId:i,shouldExplicitBeHidden:o=!1,total:c})=>{const d={id:i,type:et.Kk.HISTORY},m=(0,s.useRef)(null),{loadingStatus:p,fetchNext:u,fetchAll:h}=(0,St.A)(r,i,t,l,e),{manageItems:A,tableItems:E}=(0,It.A)(i,a,e,{fetchAll:h,generateId:e=>`${e.id}-${(0,n.A)(e,"legacy.TRACK_NUMBER","")}`}),{playerStatus:_,play:y}=(0,Et.A)(e,d,t,!0),b=(0,Ct.A)(E,e,h);(0,vt.A)(wt.g.PLAY,(()=>{y({playItems:E.toPlay})}),e);const g=(0,nt.Ay)({container:d,context:e,loadingStatus:p,manageItems:A,playerStatus:_,select:b,shouldExplicitBeHidden:o});return s.createElement(nt.ru,{value:g},s.createElement(ot.A,{tableRef:m,rowCount:c},s.createElement(ot.A.Header,null,s.createElement(ot.A.CellHead,{size:at.TITLE.SIZE},(0,L.AP)("datagrid_title_trackUPP_web")),s.createElement(ot.A.CellHead,{size:at.ARTIST.SIZE},(0,L.AP)("datagrid_title_artistUPP_web")),s.createElement(ot.A.CellHead,{breakpoint:at.PARENT.BREAKPOINT,size:at.PARENT.SIZE},(0,L.AP)("datagrid_title_albumUPP_web")),s.createElement(ot.A.CellHead,{breakpoint:at.DATE.BREAKPOINT,size:at.DATE.SIZE},(0,L.AP)("datagrid_title_dateUPP_web")),s.createElement(ot.A.CellHead,{ariaLabel:(0,L.AP)("sortingmenu_title_duration_web"),size:at.DURATION.SIZE},gt||(gt=s.createElement(Ve.m,null))),s.createElement(ot.A.CellHead,{align:at.SELECT.ALIGN,size:at.SELECT.SIZE},ft||(ft=s.createElement(it.A,null)))),s.createElement(ot.A.Body,null,s.createElement(Qe.A,{isItemLoaded:e=>e<a.length-v.Hs,itemCount:E.toDisplay.length,loadMoreItems:u,threshold:v.Hs},(({onItemsRendered:e,ref:t})=>s.createElement(ct.A,{onItemsRendered:e,tableRef:m,items:E,ref:t},bt))),Pt||(Pt=s.createElement(ot.A.RowLoader,null)))),0===E.toDisplay.length&&(Tt||(Tt=s.createElement(ot.A.EmptyContent,null))))};var Rt,xt=a("sAMA"),Lt=a("Fzox"),Ft=a("Bhnp"),Dt=a("thsB");const Ot=({id:e})=>{const[t,a]=(0,s.useState)(null),[l,r]=(0,s.useState)(!0),n=(0,Lt.j)(),i=(0,Lt.G)((e=>(0,h.Uw)(e.user)===xt.g)),o=(0,Lt.G)(Ft.JS),c=(0,s.useCallback)((({start:e,nb:t})=>n((0,Dt.FB)(e,t))),[n]);if((0,s.useEffect)((()=>(x.A.ready(x.A.user.userReady,(()=>{c({start:0,nb:v.ww}).catch(a).finally((()=>{r(!1)}))})),()=>{(0,Dt.w8)()})),[c]),t)throw t;if(l)return Rt||(Rt=s.createElement("div",{className:"loved-loader"},s.createElement(S.A,null)));const d=(0,L.AP)("profilepagetab_title_listeninghistory_web"),m={ID:e,TYPE:se.pB};return s.createElement(ze.OJ,{value:{page:"favorite_playlists_listening_history"}},s.createElement("div",{className:"container"},s.createElement(Ze.A,{title:d})),s.createElement("div",{className:"container"},s.createElement(Nt,{context:m,isFullyFetched:o.HAS_FULLY_LOADED_SONGS,items:o.data,onFetch:c,nextFetchDataIndex:o.NEXT_FETCH_DATA_INDEX,shouldExplicitBeHidden:i,total:o.NB_SONG,userId:e})))};var kt=a("G4qV"),Mt=a("nLzw"),Ut=a("hTBE"),Bt=a("rA75");const Gt={[Bt.R.PlaylistPersonal]:(e,t)=>Number(e.PARENT_USER_ID)===t,[Bt.R.PlaylistFavorite]:(e,t)=>{const a=Number(e.PARENT_USER_ID)===t,s=(0,G.C5)(c.A.getState().entities,{id:e.PLAYLIST_ID});return!a&&!s},[Bt.R.PlaylistCollaborative]:e=>(0,G.C5)(c.A.getState().entities,{id:e.PLAYLIST_ID})};var zt=a("WBQ7"),Wt=a("YVUD"),Xt=a("0CJU"),Yt=a("hz5U"),jt=a("GkjM");const Kt=({cover:e,title:t,url:a})=>{const l=Yt.A.getImageSrc("misc",e,264,264,"none");return s.createElement(s.Fragment,null,s.createElement(Xt.A,{type:"generic",redirectUrl:a,context:(0,ae.yh)(m.Ay.Episode),alt:t,imgSrc:l,width:264,height:264,bordered:!0}),s.createElement("div",{className:"thumbnail-caption"},s.createElement("div",{className:"heading-4"},s.createElement(jt.A,{to:a},t))))};var Jt=a("Fg+i");const $t=({id:e})=>{const t=(0,L.AP)("favorites_title_latestepisodes_web"),a=Jt.Zo;return s.createElement(Kt,{cover:a,title:t,url:`/profile/${e}/podcasts/${Jt.eb.latest}`})},qt=({id:e})=>{const t=(0,L.AP)("favorites_title_inprogress_web"),a=Jt.lC;return s.createElement(Kt,{cover:a,title:t,url:`/profile/${e}/podcasts/${Jt.eb.resume}`})};a("aRRr");const aa=({title:e,description:t,children:a})=>s.createElement("div",{className:"GA4MM"},s.createElement("div",{className:"MYpMR"},e),t&&s.createElement("div",{className:"aCUH2"},t),a&&s.createElement("div",{className:"Wxxal"},a)),sa=({query:e})=>s.createElement(aa,{title:(0,L.AP)("emptystate_title_noresultsforXsearchterm_web",{sprintf:[e]})});var la=a("55Ip");const ra=({isMe:e})=>e?s.createElement(aa,{title:(0,L.AP)("emptystate_title_nofavoritealbums_web"),description:(0,L.AP)("emptystate_text_discoverouralbumselection_web")},s.createElement(pe.$n,{as:la.N_,to:(0,F.jd)("/channels/new")},(0,Te.A)((0,L.AP)("generic_action_addalbumsUPP_web"),!0))):s.createElement(aa,{title:(0,L.AP)("emptystate_title_nofavoritealbums_web")}),na=({isMe:e})=>e?null:s.createElement(aa,{title:(0,L.AP)("emptystate_title_nofavoriteartistsyet_web")}),ia=()=>s.createElement(aa,{title:(0,L.AP)("emptystate_title_nofollowersyet_web")}),oa=()=>s.createElement(aa,{title:(0,L.AP)("emptystate_title_notfollowninganyoneyet_web")}),ca=({isMe:e})=>e?s.createElement(aa,{title:(0,L.AP)("emptystate_title_nofavoritemixes_web"),description:(0,L.AP)("emptystate_text_discoverourselectionofmixes_web")},s.createElement(pe.$n,{as:la.N_,to:(0,F.jd)("/channels/mixes")},(0,Te.A)((0,L.AP)("generic_action_addmixesUPP_web"),!0))):s.createElement(aa,{title:(0,L.AP)("emptystate_title_nofavoritemixes_web")}),da=({isMe:e})=>e?null:s.createElement(aa,{title:(0,L.AP)("emptystate_title_nofavoriteplaylistsyet_web")}),ma=({isMe:e})=>e?null:s.createElement(aa,{title:(0,L.AP)("emptystate_title_nofavoritepodcasts_web")});a("W8Tb");var pa=a("kSUS"),ua=a("OZl/"),ha=a("tYAi"),Aa=a("chf7");const[Ea,_a,ya]=(0,Aa.q6)({name:"FilterContext"}),ba=({isDisabled:e,activeFilter:t,onFilterChange:a})=>{const l=_a();return 0===l.length?null:s.createElement(ha.Ay,{selectedKey:t,onChange:a,isDisabled:e,items:l})};var ga,fa=a("VkUI");const Pa=({id:e})=>s.createElement("div",{className:"action-curator"},s.createElement(pe.$n,{size:"small",leftIcon:ga||(ga=s.createElement(Ie.c,null)),onClick:()=>fa.default.open(`/lightbox/curators/edit_playlist/${e}`)},(0,L.AP)("Taguer par genre et moods")));let va=function(e){return e.Search="search",e.Filter="filter",e.Sorter="sorter",e.EditPlaylistsTags="edit_playlists_tags",e}({});const Sa=({id:e,isMe:t,type:a,actions:l,onFilterChange:r,onSortChange:n,onQueryChange:i,filter:o=Bt.R.None,sort:c="",query:d=""})=>{const[m,p]=(0,s.useState)(o),u=(0,pa.A)((e=>{const t=e.target.value,a=""!==t?Bt.R.None:m;""!==t&&""===d&&p(o),i(t),a!==o&&r(a)}),300),h=t&&le.A.isAllowed("curator_feature")&&l.includes(va.EditPlaylistsTags),A=l.includes(va.Search),E=l.includes(va.Sorter),_=l.includes(va.Filter);return s.createElement("div",{className:"HAQXJ"},A&&s.createElement("div",{className:"jU4En"},s.createElement(Ke.D,{onChange:u,placeholder:(0,L.AP)("Rechercher"),size:"small"})),_&&s.createElement(ba,{activeFilter:o,onFilterChange:r,isDisabled:""!==d}),E&&s.createElement(ua.A,{type:a,activeSort:c,onSortChange:n,align:ha.FQ,isDisabled:""!==d}),h&&s.createElement(Pa,{id:e}))},Ia=JSON.parse('{"type":"album","actions":{"search":{"fields":["ALB_TITLE","ART_NAME"]},"sorter":{"default":"DATE_CREATE","settings_key":"sort_profile_album"}}}'),Ca=JSON.parse('{"type":"artist","actions":{"search":{"fields":["ART_NAME"]},"filter":{"default":"","fields":["GENRES"]},"sorter":{"default":"DATE_CREATE","settings_key":"sort_profile_artist"}}}'),Na=JSON.parse('{"type":"user","actions":{"search":{"fields":["BLOG_NAME"]}}}'),Ra=JSON.parse('{"type":"user","actions":{"search":{"fields":["BLOG_NAME"]}}}'),xa=JSON.parse('{"type":"playlist","actions":{"edit_playlists_tags":{},"filter":{"default":""},"search":{"fields":["TITLE"]},"sorter":{"default":"DATE_CREATE","settings_key":"sort_profile_playlist"}}}'),La=JSON.parse('{"type":"radio","actions":{"search":{"fields":["TITLE"]}}}'),Fa=JSON.parse('{"type":"show","actions":{"search":{"fields":["SHOW_NAME"]},"sorter":{"default":"DATE_FAVORITE","settings_key":"sort_profile_show"}}}');var Da=a("8iEq");const Oa={[He.E6.albums]:Ia,[He.E6.artists]:Ca,[He.E6.followers]:Na,[He.E6.following]:Ra,[He.E6.playlists]:xa,[He.E6.radios]:La,[He.E6.shows]:Fa},ka=e=>(0,n.A)(Oa,`[${e}].type`),Ma=e=>(0,n.A)(Oa,`[${e}].actions.filter.fields`,Bt.R.None),Ua=e=>(0,n.A)(Oa,`[${e}].actions.sorter.default`,Da.cT),Ba=e=>(0,n.A)(Oa,`[${e}].actions.sorter.settings_key`),Ga=(e,t)=>({[He.E6.home]:{label:(0,L.AP)("profilepagetab_title_highlights_web")},[He.E6.loved]:{label:(0,L.AP)("favoritessidebar_title_favoritetracks_web"),type:m.Ay.Song},[He.E6.downloads]:{label:(0,L.AP)("desktopapp_title_downloads_web"),disabled:!e||!t},[He.E6.playlists]:{label:(0,L.AP)("favoritessidebar_title_playlists_web"),type:m.Ay.Playlist},[He.E6.albums]:{label:(0,L.AP)("favoritessidebar_title_albums_web"),type:m.Ay.Album},[He.E6.artists]:{label:(0,L.AP)("favoritessidebar_title_artists_web"),type:m.Ay.Artist},[He.E6.history]:{label:(0,L.AP)("profilepagetab_title_listeninghistory_web"),disabled:!e},[He.E6.shows]:{url:He.E6.podcasts,label:(0,L.AP)("favoritessidebar_title_podcasts_web"),disabled:!le.A.isAllowed("talk"),type:m.Ay.Show},[He.E6.personal_song]:{label:(0,L.AP)("profilepagetab_title_mymp3s_web"),disabled:!e},[He.E6.following]:{label:(0,L.AP)("profilepagetab_title_following_web")},[He.E6.followers]:{label:(0,L.AP)("profilepagetab_title_followers_web")}}),Ha=e=>{switch(e){case He.E6.albums:return O.CONTEXT_PAGE_PROFILE_TAB_ALBUMS;case He.E6.artists:return O.CONTEXT_PAGE_PROFILE_TAB_ARTISTS;case He.E6.followers:return O.CONTEXT_PAGE_PROFILE_TAB_FOLLOWERS;case He.E6.following:return O.CONTEXT_PAGE_PROFILE_TAB_FOLLOWING;case He.E6.playlists:return O.CONTEXT_PAGE_PROFILE_TAB_PLAYLISTS;case He.E6.radios:return O.CONTEXT_PAGE_PROFILE_TAB_RADIOS;case He.E6.shows:return O.CONTEXT_PAGE_PROFILE_TAB_SHOWS;default:return O.CONTEXT_PAGE_PROFILE}},za=e=>{switch(e){case He.E6.albums:return(0,ae.Pe)(m.Ay.Album,se.z6);case He.E6.artists:return(0,ae.Pe)(m.Ay.Artist,se.z6);case He.E6.playlists:return(0,ae.Pe)(m.Ay.Playlist,se.z6);case He.E6.radios:return(0,ae.Pe)(m.Ay.Radio,se.z6);case He.E6.shows:return(0,ae.Pe)(m.Ay.Show,se.z6);default:return`unknown_profile_tab_${e}`}};var Wa,Xa,Ya,ja=a("6dJ7");const Za=(0,kt.Ad)(kt.UI,Mt.A);class Ka extends s.Component{constructor(e,t){super(e,t),this._filter=Za(((...e)=>e),(([e,t,a,s,l,r])=>this._search(((e,t=Bt.R.None,{user_id:a=0,fields:s=[]}={})=>t===Bt.R.None?e:Gt[t]?e.filter((e=>Gt[t](e,a))):s.includes("GENRES")?e.filter((e=>!e.GENRES||!e.GENRES.data||e.GENRES.data.find((({GENRE_ID:e})=>e===t)))):e)((0,Ut.A)(l,e,r),t,a),s)));const a=zt.default.get(Ba(e.tab),Ua(e.tab));var s;this.state={search:"",activeFilter:(s=e.tab,(0,n.A)(Oa,`[${s}].actions.filter.default`,Bt.R.None)),selectedSort:(0,Ut.v)(a)&&e.isMe?a:Ua(e.tab)},this._onFilterChanged=this._onFilterChanged.bind(this),this._onSearchChanged=this._onSearchChanged.bind(this),this._onSortChanged=this._onSortChanged.bind(this)}render(){const{id:e,items:t,tab:a}=this.props,{activeFilter:l,search:r,selectedSort:n}=this.state;if(void 0===t.data)return null;const i=this._filter(n,l,{user_id:e,fields:Ma(a)},r.toLocaleLowerCase(),t.data,ka(a)),o=i.length,c=this._renderPlaceholder(i);return s.createElement(ze.OJ,{value:{page:`favorite_${a}`}},s.createElement("section",{className:"user-section"},s.createElement("div",{className:"container"},s.createElement("div",{className:"user-section-title clearfix"},this._renderTabTitle(o),this._renderActions())),c?s.createElement("div",{className:"container"},c):s.createElement(Wt.A,{id:e,type:"profile",data:i,total:o,progressiveDisplay:!0,pageContext:Ha(a),gridAttributes:{placeHolder:!1,context:za(a),prependElement:this._renderPrependElement()}})))}_renderTabTitle(e){const t={sprintf:[(0,q.A)(e)],count:e},a={[He.E6.albums]:(0,L.WI)("%s album","% albums",t),[He.E6.artists]:(0,L.WI)("%s artiste","%s artistes",t),[He.E6.followers]:(0,L.WI)("%s follower","%s followers",t),[He.E6.following]:(0,L.WI)("%s following","%s following",t),[He.E6.playlists]:(0,L.WI)("%s playlist","%s playlists",t),[He.E6.radios]:(0,L.WI)("%s mix","%s mix",t),[He.E6.shows]:(0,L.WI)("%s podcast","%s podcasts",t)};return le.A.isAllowed("revamp2023")?s.createElement(Ze.A,{title:a[this.props.tab],style:{float:"left",lineHeight:"32px"}}):s.createElement("h1",{className:"heading-1"},a[this.props.tab])}_renderActions(){const{id:e,isMe:t,items:a,tab:l}=this.props;if(a.data.length<1)return null;const{selectedSort:r}=this.state,i=(e=>Object.keys((0,n.A)(Oa,`[${e}].actions`)))(l);if(0===i.length)return null;const{activeFilter:o,search:c}=this.state;return s.createElement(Sa,{id:e,isMe:t,actions:i,type:ka(l),filter:o,sort:r,query:c,onFilterChange:this._onFilterChanged,onSortChange:this._onSortChanged,onQueryChange:this._onSearchChanged,key:`tab_actions_${l}`})}_renderPrependElement(){const{id:e,isMe:t,tab:a}=this.props,{search:l,activeFilter:r}=this.state;if(""===l&&r===Bt.R.None)return a===He.E6.playlists&&t?Wa||(Wa=s.createElement(Fe,{key:"CreatePlaylist"})):a===He.E6.shows&&t?[s.createElement($t,{id:e,key:Jt.eb.latest}),s.createElement(qt,{id:e,key:Jt.eb.resume})]:a===He.E6.artists&&t?s.createElement(Me,{key:"AddArtist",callbackLink:`/profile/me/${He.E6.artists}`}):void 0}_renderPlaceholder(e){const{isMe:t,tab:a}=this.props,{search:l}=this.state,r=void 0!==this._renderPrependElement();if(!(e.length>0||r)){if(""!==l)return s.createElement(sa,{query:l});switch(a){case He.E6.albums:return s.createElement(ra,{isMe:t});case He.E6.artists:return s.createElement(na,{isMe:t});case He.E6.followers:return Xa||(Xa=s.createElement(ia,null));case He.E6.following:return Ya||(Ya=s.createElement(oa,null));case He.E6.radios:return s.createElement(ca,{isMe:t});case He.E6.playlists:return s.createElement(da,{isMe:t});case He.E6.shows:return s.createElement(ma,{isMe:t});default:return}}}_onFilterChanged(e){this.setState({activeFilter:e}),(0,Je.h4)({action:Je.dJ.FILTER_CLICKED,payload:{path:this.props.tab,filter_name:e,filter_type:"filter"}})}_onSortChanged(e){this.setState({selectedSort:e}),this.props.isMe&&zt.default.set(Ba(this.props.tab),e),(0,Je.h4)({action:Je.dJ.FILTER_CLICKED,payload:{path:this.props.tab,filter_name:e,filter_type:"sort"}})}_onSearchChanged(e){this.setState({search:e}),e&&(0,Je.h4)({action:Je.dJ.FILTER_CLICKED,payload:{path:this.props.tab,filter_name:"search",filter_type:"filter"}})}_search(e,t){const{tab:a}=this.props,s=(e=>(0,n.A)(Oa,`[${e}].actions.search.fields`))(a);return s?e.filter((e=>s.some((a=>{let s=e[a]||"";return e&&e.TYPE&&Number(e.TYPE)===ja.S7&&(s=(0,L.AP)("Coups de coeur")),(0,Ye.A)(s.toLowerCase()).indexOf(t)>-1}),!1))):e}}const Ja=Ka;var $a,qa,Qa,Va=a("Rap7"),es=a("iphN"),ts=a("Jfek"),as=a("1h7S"),ss=a("9MQu"),ls=a("KJ1h"),rs=a("Eiyd"),ns=a("C53p");const is=({id:e,context:t})=>{const a=(0,l.d4)((t=>(0,G.lS)(t.entities,{id:e,currentUserId:t.user.id}))),r=(0,l.d4)((e=>(0,B.pp)(e.feedbacks,m.Ay.Song,!1))),n=(0,l.d4)((e=>(0,h.Jt)(e.user))),i={NB_SONG:r,PICTURE_TYPE:a.PICTURE_TYPE,PLAYLIST_PICTURE:a.PLAYLIST_PICTURE,TITLE:a.TITLE},o=(0,as.Ay)({containerData:i,context:t,id:e,isDownloadable:n,isShareable:!0,type:m.Ay.Playlist,shareType:ts.Gb.playlist});return s.createElement(as.PK.Provider,{value:o},s.createElement(ss.e,{size:"medium",gap:le.A.isAllowed("revamp2023")?"spacing.xs":"12px",spacing:0,"data-testid":"toolbar"},$a||($a=s.createElement(rs.A,null)),qa||(qa=s.createElement(ns.A,null)),Qa||(Qa=s.createElement(ls.A,null))))};var os=a("TDRX");const cs=({isMe:e})=>e?s.createElement(aa,{title:(0,L.AP)("emptystate_title_notracksyet_web"),description:(0,L.AP)("emptystate_text_findtrackstoaddhere_web")},s.createElement(pe.$n,{as:la.N_,to:(0,F.jd)("/channels/explore")},(0,L.AP)("playlistpage_action_addtracks_web"))):s.createElement(aa,{title:(0,L.AP)("emptystate_title_notracksyet_web")});var ds,ms,ps=a("1Pdy"),us=a("3R0U"),hs=a("zCrf"),As=a("ISNy");const Es=()=>{const[e,t]=(0,s.useState)(null),[a,l]=(0,s.useState)(!0),[r,n]=(0,s.useState)(0),i=(0,Lt.j)(),o=(0,Lt.G)((e=>(0,h.G8)(e.user))),c=(0,Lt.G)((e=>(0,B.pp)(e.feedbacks,m.Ay.Song,!1))),d=(0,Lt.G)(As.VL),p=(0,Lt.G)((e=>(0,re._B)(e.cache,{id:o,type:m.Ay.Playlist}))),A=(0,Lt.G)((e=>(0,h.Uw)(e.user)===xt.g)),E={ID:o,TYPE:(0,ae.Us)(m.Ay.Playlist)},_=(0,s.useCallback)((async({nb:e,start:t})=>{await i((0,hs.bm)({start:t,nb:e},{cacheUsage:p?us.u.READ_ONLY:us.u.NONE})),n(t+e)}),[i,p]),y=(0,s.useCallback)((({order:e})=>i((0,u.rc)(m.Ay.Song,e))),[i]);if((0,s.useEffect)((()=>(x.A.ready(x.A.user.userReady,(()=>{i((0,u.G5)(m.Ay.Song)).then((()=>_({start:0,nb:v.ww}))).catch(t).finally((()=>{l(!1)}))})),()=>{(0,hs.w8)()})),[_,i]),(0,vt.A)(wt.g.FILTER,(()=>{(0,Je.h4)({action:Je.dJ.FILTER_CLICKED,payload:{path:"loved",filter_name:"search",filter_type:"filter"}})}),E),e)throw e;if(a)return ds||(ds=s.createElement("div",{className:"loved-loader"},s.createElement(S.A,null)));const b={total:c,data:d.slice(0,r)},g=(0,L.WI)("%s coup de cÅur","%s coups de cÅur",{sprintf:[(0,q.A)(b.total)],count:b.total}),f=[ps.Rj.Add,ps.Rj.Delete,ps.Rj.Reorder];return s.createElement(ze.OJ,{value:{page:"favorite_tracks"}},s.createElement("div",{className:"container"},s.createElement(os.a,{mb:"spacing.l"},s.createElement(Ze.A,{title:g})),s.createElement("div",{className:"loved-heading"},s.createElement(is,{context:E,id:o}),s.createElement(Va.A,{context:E,isDisabled:b.total<=0,classname:"profile-tracklist-filter"}))),s.createElement("div",{className:"container"},b.total>0?s.createElement(es.A,{context:E,hasFilter:!1,isFullyFetched:r>=b.total,isPersonalFavoritesSongs:!0,items:b.data,nextFetchDataIndex:r,onFetch:_,onReorder:y,options:f,playlistId:o,shouldExplicitBeHidden:A,total:b.total}):ms||(ms=s.createElement(cs,{isMe:!0}))))},_s=a("DjLa").WR.PERSONAL_SONGS,ys={TITLE:{SIZE:tt.uq.Full},ARTIST:{SIZE:tt.uq.PercentXs},PARENT:{BREAKPOINT:tt.x1.md,SIZE:tt.uq.PercentXs},DURATION:{SIZE:tt.uq.sm},SELECT:{ALIGN:tt.uP.Right,SIZE:tt.uq.sm}};var bs,gs,fs;const Ts=s.memo((({data:e,index:t,style:a})=>{const l=e.toDisplay[t],{context:r,container:i,loadingStatus:o,shouldExplicitBeHidden:c}=s.useContext(nt.Gt),{playerStatus:d,play:p,isItemLoadedInPlayer:u}=(0,Et.A)(r,i,o.isFullyFetched),h=l.item.hasExplicitLyrics&&c,A=(t,a)=>{p({playIndex:a,playItems:e.toPlay,isTrackActive:t})};return s.createElement(ot.A.Row,{style:a,uuid:l.uuid,id:l.item.id,index:l.index,isActive:u(l.item)&&d.isSameContext,isReadable:l.item.right===_t.A.READABLE,isRestrictedByExplicit:h,type:l.item.type,isDraggable:!0},s.createElement(At.A,{size:ys.TITLE.SIZE},s.createElement(At.A.Play,{ariaLabel:(0,L.AP)("generic_action_playsongXbyartistX_web",{sprintf:[l.item.title,(0,n.A)(l,"item.artists[0].name","")]}),hasExplicitCover:l.item.parent.hasExplicitCover,onPlayItems:A,pictureUrl:l.item.cover(je.r4).url}),bs||(bs=s.createElement(At.A.Download,null)),s.createElement(At.A.PlayableLabel,{hasExplicitLyrics:l.item.hasExplicitLyrics,label:l.item.title,onPlayItems:A,tooltipText:(0,yt.Y)(l.item,c)}),s.createElement(ot.A.IconGroup,null,gs||(gs=s.createElement(At.A.AddToFeedback,null)),s.createElement(At.A.Edit,{item:l.item}),s.createElement(At.A.OpenContextMenu,{item:l.item}))),s.createElement(ot.A.CellBody,{size:ys.ARTIST.SIZE},s.createElement(ut.A,{links:l.item.artists.map((e=>({...e,type:m.Ay.Artist})))})),s.createElement(ot.A.CellBody,{breakpoint:ys.PARENT.BREAKPOINT,size:ys.PARENT.SIZE},s.createElement(ut.A,{links:[{...l.item.parent,type:m.Ay.Album}]})),s.createElement(ot.A.CellBody,{size:ys.DURATION.SIZE},s.createElement(pt.A,{duration:l.item.duration})),s.createElement(ot.A.CellBody,{align:ys.SELECT.ALIGN,size:ys.SELECT.SIZE},fs||(fs=s.createElement(ht.A,null))))}),dt.t7);var ws,vs,Ss,Is;const Cs=({context:e,isFullyFetched:t,items:a,nextFetchDataIndex:l,onFetch:r,userId:n,shouldExplicitBeHidden:i=!1,total:o})=>{const c={id:n,type:et.Kk.PERSONAL_SONG},d=(0,s.useRef)(null),{loadingStatus:m,fetchNext:p,fetchAll:u}=(0,St.A)(r,n,t,l,e),{manageItems:h,tableItems:A}=(0,It.A)(n,a,e,{fetchAll:u,sortStorageKey:_s}),{playerStatus:E,play:_}=(0,Et.A)(e,c,t),y=(0,Ct.A)(A,e,u),b=(0,s.useCallback)((()=>{r({id:n,start:0,nb:2e3})}),[r,n]);(0,vt.A)(wt.g.PLAY,(()=>{_({playItems:A.toPlay})}),e),(0,vt.A)(wt.g.FILTER,(e=>{h.action.filter(e.query||"")}),e),(0,s.useEffect)((()=>(x.A.subscribe(x.A.user.sendPersonalSong,b),()=>{x.A.unsubscribe(x.A.user.sendPersonalSong,b)})),[b]);const g=(0,nt.Ay)({container:c,context:e,loadingStatus:m,manageItems:h,playerStatus:E,select:y,shouldExplicitBeHidden:i});return s.createElement(nt.ru,{value:g},s.createElement(ot.A,{tableRef:d,rowCount:o},s.createElement(ot.A.Header,null,s.createElement(ot.A.CellHead,{size:ys.TITLE.SIZE,sortPath:"item.title"},(0,L.AP)("datagrid_title_trackUPP_web")),s.createElement(ot.A.CellHead,{size:ys.ARTIST.SIZE,sortPath:"item.artist.name"},(0,L.AP)("datagrid_title_artistUPP_web")),s.createElement(ot.A.CellHead,{breakpoint:ys.PARENT.BREAKPOINT,size:ys.PARENT.SIZE,sortPath:"item.parent.name"},(0,L.AP)("datagrid_title_albumUPP_web")),s.createElement(ot.A.CellHead,{ariaLabel:(0,L.AP)("sortingmenu_title_duration_web"),size:ys.DURATION.SIZE,sortPath:"item.duration"},ws||(ws=s.createElement(Ve.m,null))),s.createElement(ot.A.CellHead,{align:ys.SELECT.ALIGN,size:ys.SELECT.SIZE},vs||(vs=s.createElement(it.A,null)))),s.createElement(ot.A.Body,null,s.createElement(Qe.A,{isItemLoaded:e=>e<a.length-v.Hs,itemCount:A.toDisplay.length,loadMoreItems:p,threshold:v.Hs},(({onItemsRendered:e,ref:t})=>s.createElement(ct.A,{onItemsRendered:e,tableRef:d,items:A,ref:t},Ts))),Ss||(Ss=s.createElement(ot.A.RowLoader,null)))),0===A.toDisplay.length&&(Is||(Is=s.createElement(ot.A.EmptyContent,null))))};var Ns=a("MRGC"),Rs=a("N67Q"),xs=a("jERP");const Ls=()=>s.createElement(Rs.A,null,s.createElement(xs.A,{accept:"audio/mp3,audio/mpeg",type:"audio",directory:"user",action:"sendPersonalSong",multiFile:!0},s.createElement(pe.$n,{fontFamily:"body"},(0,L.AP)("Envoyer vos mp3"))));var Fs,Ds;const Os=({id:e,context:t})=>{const a=(0,l.d4)((e=>(0,Ns.Vz)(e))),r=(0,as.Ay)({containerData:a,context:t,id:e,type:t.TYPE});return s.createElement(as.PK.Provider,{value:r},s.createElement(ss.e,{size:"medium",gap:le.A.isAllowed("revamp2023")?"spacing.xs":"12px",spacing:0,"data-testid":"toolbar"},Fs||(Fs=s.createElement(rs.A,null)),Ds||(Ds=s.createElement(Ls,null))))};var ks,Ms=a("K5vB"),Us=a("Kgcv");const Bs=({id:e})=>{const[t,a]=(0,s.useState)(null),[l,r]=(0,s.useState)(!0),i=(0,Lt.j)(),o=(0,Lt.G)((e=>(0,h.Uw)(e.user)===xt.g)),c=(0,Lt.G)(Ns.Vz),d=(0,s.useCallback)((({start:e,nb:t})=>i((0,Us.Zi)(e,t))),[i]);if((0,s.useEffect)((()=>(x.A.ready(x.A.user.userReady,(()=>{d({start:0,nb:v.ww}).catch(a).finally((()=>{r(!1)}))})),()=>{(0,Us.w8)()})),[d]),t)throw t;if(l)return ks||(ks=s.createElement("div",{className:"loved-loader"},s.createElement(S.A,null)));const m=(0,n.A)(c,"NB_SONG",0),p=(0,L.WI)("%s MP3","%s MP3",{sprintf:[(0,q.A)(m)],count:m}),u={ID:e,TYPE:se.EB};return s.createElement(s.Fragment,null,s.createElement("div",{className:"container"},s.createElement(os.a,{mb:"spacing.l"},s.createElement(Ze.A,{title:p})),s.createElement("div",{className:"loved-heading"},s.createElement(Ms.AG,{value:{onSuccess:()=>i((0,Us.vQ)(0,2e3)),onError:()=>(0,Ae.A)({body:(0,L.AP)("Une erreur est survenue, merci de rÃ©essayer plus tard.")})}},s.createElement(Os,{context:u,id:e})),s.createElement(Va.A,{context:u,isDisabled:m<=0,classname:"profile-tracklist-filter"}))),s.createElement("div",{className:"container"},s.createElement(Cs,{context:u,isFullyFetched:c.HAS_FULLY_LOADED_SONGS,items:c.data,onFetch:d,nextFetchDataIndex:c.NEXT_FETCH_DATA_INDEX,shouldExplicitBeHidden:o,total:m,userId:e})))};var Gs,Hs,zs,Ws,Xs,Ys=a("rOn+"),js=a("Ye48");const Zs=({id:e,context:t})=>{const a=(0,l.d4)((t=>(0,G.lS)(t.entities,{id:e,currentUserId:t.user.id}))),r=(0,l.d4)((e=>(0,h.Jt)(e.user))),n=(0,as.Ay)({containerData:a,context:t,id:e,isDownloadable:r,isLoveable:!a.IS_PRIVATE,isShareable:!a.IS_PRIVATE,type:m.Ay.Playlist,shareType:ts.Gb.playlist});return s.createElement(as.PK.Provider,{value:n},s.createElement(ss.e,{size:"medium",gap:le.A.isAllowed("revamp2023")?"spacing.xs":"12px",spacing:0,"data-testid":"toolbar"},Gs||(Gs=s.createElement(rs.A,null)),Hs||(Hs=s.createElement(Ys.A,null)),zs||(zs=s.createElement(ns.A,null)),Ws||(Ws=s.createElement(ls.A,null)),Xs||(Xs=s.createElement(js.A,null))))};var Ks,Js,$s=a("A2sV");const qs=({id:e,userId:t})=>{var a,l;const[r,n]=(0,s.useState)(null),[i,o]=(0,s.useState)(!0),c=(0,Lt.j)(),d=(0,Lt.G)((e=>(0,h.Uw)(e.user)===xt.g)),p=(0,Lt.G)((t=>(0,G.lS)(t.entities,{id:e,currentUserId:(0,h.F6)(t.user)}))),u=(0,s.useCallback)((({start:t,nb:a})=>c((0,ie.vW)({id:e,start:t,nb:a}))),[c,e]),{data:A}=(0,$s.x87)({variables:{userId:t}});if((0,s.useEffect)((()=>(x.A.ready(x.A.user.userReady,(()=>{u({start:0,nb:v.ww}).catch(n).finally((()=>{o(!1)}))})),()=>{(0,ie.w8)()})),[u]),r)throw r;if(i)return Ks||(Ks=s.createElement("div",{className:"loved-loader"},s.createElement(S.A,null)));const E=null!==(a=null==A||null===(l=A.user)||void 0===l?void 0:l.favorites.estimatedTracksCount)&&void 0!==a?a:0,_=(0,L.WI)("%s coup de cÅur","%s coups de cÅur",{sprintf:[(0,q.A)(E)],count:E}),y={ID:e,TYPE:(0,ae.Us)(m.Ay.Playlist)};return s.createElement(ze.OJ,{value:{page:"favorite_tracks"}},s.createElement("div",{className:"container"},s.createElement(os.a,{mb:"spacing.l"},s.createElement(Ze.A,{title:_})),s.createElement("div",{className:"loved-heading"},s.createElement(Zs,{context:y,id:e}),s.createElement(Va.A,{context:y,isDisabled:p.NB_SONG<=0,classname:"profile-tracklist-filter"}))),s.createElement("div",{className:"container"},p.NB_SONG>0?s.createElement(es.A,{context:y,hasFilter:!1,isFullyFetched:p.HAS_FULLY_LOADED_SONGS,items:p.SONGS,nextFetchDataIndex:p.NEXT_FETCH_DATA_INDEX,onFetch:u,playlistId:e,shouldExplicitBeHidden:d,total:p.NB_SONG}):Js||(Js=s.createElement(cs,{isMe:!1}))))};var Qs,Vs,el,tl;class al extends s.Component{constructor(e){super(e),this.state={data:e.data},this._onTabClick=this._onTabClick.bind(this),this._onFavoriteChanged=this._onFavoriteChanged.bind(this),this._tabsNotToLog=[He.E6.personal_song,He.E6.followers,He.E6.following]}getChildContext(){return{userId:this.props.id,isMe:this.props.isMe,data:this.state.data||{}}}static getDerivedStateFromProps(e){return{data:e.data}}componentDidMount(){const{tab:e}=this.props;x.A.subscribe(x.A.navigation.tabChange,((e,t)=>{this._onTabClick(t)}),"profile"),x.A.subscribe(x.A.user.addFavorite,this._onFavoriteChanged,"profile"),x.A.subscribe(x.A.user.deleteFavorite,this._onFavoriteChanged,"profile"),this._tabsNotToLog.includes(e)||D.A.log({type:"cdp",eventName:"screen_view",customAttributes:{screen_view_name:He.Xw[e]}})}componentDidUpdate(e){const{tab:t}=this.props;e.tab===t||this._tabsNotToLog.includes(t)||D.A.log({type:"cdp",eventName:"screen_view",customAttributes:{screen_view_name:He.Xw[t]}})}componentWillUnmount(){x.A.unsubscribeAll("profile")}render(){return s.createElement("div",{className:"naboo-catalog",id:"page_profile"},this._renderHeader(),s.createElement("div",{className:"naboo-catalog-content-wrapper"},s.createElement("div",{className:"naboo-catalog-content"},this._renderTabContent())))}_renderHeader(){const{id:e,nbFollowers:t,nbFollowing:a,isDeleted:l,isFollowed:r,isHidden:n,isPersonal:i,tab:o,onFollowToggle:c}=this.props;return l?null:s.createElement(te,{id:e,nbFollower:t,nbFollowing:a,isDeleted:l,isFollowed:r,isPersonal:i,tabList:this._getTabList(),activeTab:o,isHiddenUser:n,onFollowToggle:c})}_renderTabContent(){const{id:e,lovedTracksId:t,isHidden:a,isMe:l,tab:r,isLoading:n}=this.props,i=this.state.data;if(!l&&a)return this._renderPlaceholder();if(!He.pw.includes(r)){if(n)return Qs||(Qs=s.createElement(S.A,null));if(!i)return null}switch(r){case He.E6.home:return s.createElement("div",{role:"tabpanel"},s.createElement(Xe,{id:e,data:i,isMe:l}));case He.E6.downloads:return Vs||(Vs=s.createElement("div",{role:"tabpanel"},s.createElement(qe,null)));case He.E6.loved:return s.createElement("div",{role:"tabpanel"},l?el||(el=s.createElement(Es,null)):s.createElement(s.Suspense,{fallback:null},s.createElement(qs,{id:t,userId:String(e)})));case He.E6.personal_song:return s.createElement("div",{role:"tabpanel"},s.createElement(Bs,{id:e}));case He.E6.history:return s.createElement("div",{role:"tabpanel"},s.createElement(Ot,{id:e}));default:return s.createElement("div",{role:"tabpanel"},s.createElement(Ea,{value:this._getFilterContext()},s.createElement(Ja,{id:e,key:`profile_${r}`,tab:r,items:i,isMe:l})))}}_renderPlaceholder(){const{isDeleted:e}=this.props,t=e?(0,L.AP)("Ce profil a Ã©tÃ© supprimÃ©."):(0,L.AP)("Ce profil est privÃ©."),a=(0,R.A)({"naboo-offline":e});return s.createElement("div",{className:"placeholders-container"},s.createElement("div",{className:a},tl||(tl=s.createElement("div",{className:"placeholders-img private"})),s.createElement("div",{className:"placeholders-title"},t)))}_onFavoriteChanged(e,t){const{isMe:a,tab:s}=this.props;if(!a)return;const l="USER.addFavorite"===e.namespace?"add":"remove";s===He.E6.home?this._handleFavoriteChangeOnHome(l,t):this._handleFavoriteChangeOnDedicatedTab(l,t)}_onTabClick(e){const{id:t,history:a}=this.props;let s=`/profile/${t}`;e.id!==He.E6.home&&(s+=`/${e.url||e.id}`),a.push((0,F.jd)(s))}_getFilterContext(){const{tab:e,genres:t}=this.props;return e===He.E6.playlists?[{key:Bt.R.None,label:(0,L.AP)("filtertagplaylists_title_all_web")},{key:Bt.R.PlaylistPersonal,label:(0,L.AP)("filtertagplaylists_title_personal_web")},{key:Bt.R.PlaylistFavorite,label:(0,L.AP)("filtertagplaylists_title_added_web")},{key:Bt.R.PlaylistCollaborative,label:(0,L.AP)("filtertagplaylists_title_collaborative_web")}]:(null==t?void 0:t.length)>0?(e=>[{key:Bt.R.None,label:(0,L.AP)("filtertagartists_title_all_web")},...e.map((({GENRE_ID:e,GENRE_NAME:t})=>({key:e,label:t})))])(t):[]}_getTabList(){const{isMe:e,userHasDownload:t}=this.props,a=Ga(e,t);let s=[];return Object.keys(a).forEach((e=>{s.push({...a[e],id:e,action:this._onTabClick})})),s}_handleFavoriteChangeOnHome(e,t){const{type:a}=t,s=`${a}s`,l=(0,n.A)(this.state,`data.[${s}].data`);if(!l)return;const r=this._updateFavoriteList(l,e,t);this.setState({data:{...this.state.data,[s]:{...this.state.data[s],data:r,total:r.length}}})}_updateFavoriteList(e,t,a){const{id:s,type:l}=a,r=m.vn[l];return"add"===t?e.find((e=>String(e[r])===String(s)))?[...e]:[a,...e]:e.filter((e=>String(e[r])!==String(s)))}_handleFavoriteChangeOnDedicatedTab(e,t){const{type:a}=t;let s;switch(a){case m.Ay.User:s=He.E6.following;break;case m.Ay.Song:return;default:s=`${a}s`}if(this.props.tab!==s)return;const l=(0,n.A)(this.state,"data.data");if(!l)return;const r=this._updateFavoriteList(l,e,t);this.setState({data:{...this.state.data,data:r,total:r.length}})}}al.childContextTypes={userId:C().number,isMe:C().bool,data:C().object},al.defaultProps={data:null,feedbackType:null,isHiddenUser:!1};const sl=(0,N.y)((0,l.Ng)((({user:e})=>({userHasDownload:(0,h.Jt)(e)})))(al));var ll,rl,nl,il=a("yJX9");let ol=(0,p.Ay)({event:"updatepage",pagename:"profile",pagecategory:"profile"})((rl=class extends s.Component{constructor(e){super(e),this.state={error:null},this._handleFollowToggle=()=>{this.setState((e=>{const t=!e.isFollowed;return{isFollowed:t,nbFollowers:t?e.nbFollowers+1:Math.max(e.nbFollowers-1,0)}}))};const{appState:t,match:{params:a}}=e;this._formatAndPushDataToStore=this._formatAndPushDataToStore.bind(this),e.appState&&Object.keys(e.appState).length&&this._formatAndPushDataToStore(e.appState,a.tab),this.state={data:e.appState||null,isFollowed:!!t&&!1!==(0,n.A)(e,"appState.DATA.FOLLOW",!1),nbFollowers:t?(0,n.A)(e,"appState.DATA.NB_FOLLOWER",0):0,isFetching:!1}}componentDidMount(){const{match:{params:e}}=this.props;this._hasDataToDisplayProfile()||this._fetchProfile(e.id,e.tab)}componentDidUpdate(e){const{id:t,tab:a}=this.props.match.params;e.match.params.tab===a&&e.match.params.id===t||this._fetchProfile(t,a)}componentWillUnmount(){o.A.cancel(this._fetchPageApiRef)}render(){const{data:e,isFetching:t,nbFollowers:a,isFollowed:l}=this.state,r=this._hasDataToDisplayProfile();if(this.state.error)throw this.state.error;if(t&&!1===r)return nl||(nl=s.createElement(S.A,null));if(!r)return null;const i=(e=>"podcasts"===e?He.E6.shows:He.E6[e])(this.props.match.params.tab)||He.E6.home,o=(0,n.A)(e,`TAB[${i}]`),c=(0,n.A)(e,"TAB.genre_filters.data"),d={id:Number(this.props.match.params.id),tab:i,genres:c,data:o,lovedTracksId:(0,n.A)(e,"DATA.USER.LOVEDTRACKS_ID"),isHidden:!e.DATA.IS_PUBLIC||e.DATA.IS_BLOCKED||"2"===e.DATA.USER.ACTIVATION,isDeleted:"2"===e.DATA.USER.ACTIVATION,isPersonal:e.DATA.IS_PERSONNAL,nbFollowers:a,nbFollowing:e.DATA.NB_FOLLOWING,isFollowed:l,isLoading:t,isMe:this.props.isMe,onFollowToggle:this._handleFollowToggle};return s.createElement(sl,d)}_getFeedbackItemTypeByTabKey(e){return(0,n.A)(Ga[e],"type",null)}_formatAndPushDataToStore(e,t){const{match:a,isMe:s}=this.props,l=t?e.TAB:e.TAB.home;l&&Object.keys(l).forEach((e=>{l[e].data&&(l[e].data=l[e].data.map((e=>({...e,partial:!0}))))}));const n=Object.keys(l||{}).length>0?(0,r.S8)(l,T):{},o=(0,i.A)(e,"DATA.USER")?(0,r.S8)(e.DATA.USER,w):{};s&&Object.keys(l).forEach((e=>{const t=this._getFeedbackItemTypeByTabKey(e);if(t&&l[e].data){let s=l[e].data;t===m.Ay.Playlist&&(s=l[e].data.filter((e=>String(e.PARENT_USER_ID)!==String(a.params.id)))),c.A.dispatch((0,u.G8)(il.Z.favorites,t,d.A.normalize(s,t)))}})),c.A.dispatch({type:"profile/FETCHED_TAB",data:{entities:{...n.entities,...o.entities},tab:t||He.E6.home}})}_fetchProfile(e,t){const a={user_id:e,tab:t||He.E6.home,nb:v.XQ};this.setState({isFetching:!0}),this._fetchPageApiRef=o.A.call({method:"deezer.pageProfile",data:a,success:e=>{this.setState({data:e,isFollowed:!1!==(0,n.A)(e,"DATA.FOLLOW",!1),nbFollowers:(0,n.A)(e,"DATA.NB_FOLLOWER",0),isFetching:!1}),this._formatAndPushDataToStore(e,t)},error:e=>{this.setState({error:e,isFetching:!1})}})}_hasDataToDisplayProfile(){return(0,i.A)(this.state,"data.DATA.USER")}},rl.displayName="profile",rl.defaultProps={appState:void 0},ll=rl))||ll;const cl=(0,l.Ng)((({user:e},{match:t})=>({isMe:Number(t.params.id)===(0,h.F6)(e)})))(ol)},U9ZG:(e,t,a)=>{a.d(t,{A:()=>N});var s,l,r,n=a("q1tI"),i=a("Ty5D"),o=a("TRpf"),c=a("9MQu"),d=a("TDRX"),m=a("HmE0"),p=a("3H/6"),u=a("EPmj"),h=a("ZUSG"),A=a("5Loq"),E=a("Wp0Y"),_=a("5G9X"),y=a("LjZa"),b=a("tZCQ"),g=a("TqF5"),f=a("0oT0"),P=a("2EvD"),T=a("Jfek"),w=a("eerp"),v=a("g1Fm"),S=a("cFUB"),I=a("AfN5");class C extends n.Component{constructor(e,t){super(e,t),this._onEdit=this._onEdit.bind(this),this._onShare=this._onShare.bind(this),this._onGoToAccount=this._onGoToAccount.bind(this)}shouldComponentUpdate(e){return this.props.id!==e.id||this.props.type!==e.type||this.props.action.length!==e.action.length}render(){return b.A.isAllowed("revamp2023")?n.createElement(c.e,{as:"ul",size:"medium",gap:"spacing.xs",spacing:"0"},this.props.action.map((e=>"function"==typeof this["_render"+(0,v.A)(e)]?n.createElement(d.a,{as:"li",key:e},this["_render"+(0,v.A)(e)]()):null))):n.createElement("ul",{className:"list-actions"},this.props.action.map((e=>"function"==typeof this["_render"+(0,v.A)(e)]?n.createElement("li",{className:"list-actions-item",key:e},this["_render"+(0,v.A)(e)]()):null)))}_renderFavorite(){const{context:e,id:t,type:a}=this.props;return n.createElement(f.A,{id:t,type:a,action:S.Hj.FAVORITE,context:e})}_renderPlay(){const{id:e,type:t,context:a}=this.props,s=t===_.Ay.Song?{radio:!0,forceAsFirstTrack:!0}:{};return n.createElement(f.A,{action:S.Hj.PLAY,color:S.cW.PRIMARY,context:a,dzPlayerOptions:s,id:e,type:t===_.Ay.Song?I.Kk.TRACK_MIX:t,wordingType:S.Hn.FULL})}_renderShuffle(){const{id:e,type:t,context:a}=this.props;return n.createElement(f.A,{id:e,type:t,action:S.Hj.SHUFFLE,color:S.cW.PRIMARY,wordingType:S.Hn.FULL,context:a})}_renderShare(){return n.createElement(m.K0,{icon:s||(s=n.createElement(u.l,null)),onClick:this._onShare,variant:"ghost","aria-label":(0,E.AP)("Partager")})}_renderEdit(){return n.createElement(p.m,{label:(0,E.AP)("Editer")},n.createElement(m.K0,{"aria-haspopup":!0,"aria-label":(0,E.AP)("generic_action_edit_web"),icon:l||(l=n.createElement(h.r,null)),onClick:this._onEdit,variant:"ghost"}))}_renderOptions(){const{context:e,data:t,id:a,type:s}=this.props,l={anchor:n.createElement(m.K0,{"aria-haspopup":!0,"aria-label":(0,E.AP)("generic_action_viewmenu_web"),icon:r||(r=n.createElement(A.j,null)),variant:"ghost"}),context:e,id:String(a),data:t,placement:"right",type:s};return n.createElement(P.A,l)}_onShare(){const{id:e,data:t,context:a,type:s}=this.props;this.props.openModal({name:T.DN,props:{componentType:T.Wg.directShareMasthead,context:a,data:t,id:e,type:(0,w.A)(s)}})}_onEdit(){this.props.edit()}_onGoToAccount(){this.props.history.push("/account")}}C.defaultProps={data:{},action:["favorite","share","options"],edit:y.A};const N=(0,i.y)((0,o.Ng)(null,{openModal:g.qf})(C))},"X/JG":(e,t,a)=>{a.d(t,{A:()=>S});var s,l,r,n,i=a("+9dH"),o=a("17x9"),c=a.n(o),d=a("q1tI"),m=a("TRpf"),p=a("kSUS"),u=a("juqV"),h=a("Wp0Y"),A=a("H/eQ"),E=a("LOQS"),_=a("HmE0"),y=a("hIIJ"),b=a("sCpb"),g=a("fsGD"),f=a("vF4p"),P=a("6vqc"),T=a("RSbz"),w=a("nN8/");class v extends d.Component{constructor(e){super(e),this._initAds=this._initAds.bind(this),this._debouncedCheckItems=this._debouncedCheckItems.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this.state={itemIndex:0,itemWidth:0,containerWidth:0,displayedItemCount:0,hasControlLeft:!1,hasControlRight:!0,mouseIn:!1},this._nodeRef=d.createRef()}getChildContext(){return{layout:g.Pl}}componentDidMount(){this.props.data.length>0&&(this._checkItems(),A.A.subscribe(A.A.layout.adsBackground,this._initAds),A.A.subscribe(A.A.layout.resize,this._debouncedCheckItems),this._setAutoAnimate())}componentDidUpdate(e,t){const{mouseIn:a}=this.state,{data:s,related:l}=this.props;t.mouseIn!==a&&(a?clearTimeout(this._intervalAutoAnimate):this._setAutoAnimate()),(e.data.length!==s.length||e.related!==l&&s.length>0)&&this._checkItems()}componentWillUnmount(){clearTimeout(this._timeoutRef),this._debounceRef&&this._debounceRef.cancel(),this.props.autoAnimate&&clearTimeout(this._intervalAutoAnimate),A.A.unsubscribe(A.A.layout.adsBackground,this._initAds),A.A.unsubscribe(A.A.layout.resize,this._debouncedCheckItems)}render(){const{itemIndex:e,itemWidth:t}=this.state,{children:a,related:s,hasMoreItems:l}=this.props,r=e*("rtl"===this.props.langDirection?1:-1)*t,n={transform:`translateX(${r}px)`,msTransform:`translateX(${r}px)`,WebkitTransform:`translateX(${r}px)`},i={};""!==s.target&&""!==s.label&&l&&(i.label=s.label,i.target=s.target);const o=d.Children.map(a,(e=>d.isValidElement(e)?d.cloneElement(e,{viewMore:i}):e));return d.createElement("div",{className:"carousel",ref:this._nodeRef},d.createElement("div",{className:"container"},this._renderHeadings()),d.createElement("div",{className:"container"},d.createElement("div",{className:"carousel-wrapper"},d.createElement("div",{className:"carousel-inner",style:n,onMouseEnter:this._onMouseOver,onMouseLeave:this._onMouseOut},o))))}_renderHeadings(){const{alignment:e,enrichedTitle:t}=this.props,a=(0,u.A)("channel-headings",{"is-centered":"center"===e});return d.createElement("div",{className:a},t?this._renderEnrichedTitle():this._renderTitle(),this._renderControls())}_renderTitle(){const{title:e,related:t,subtitle:a,target:s}=this.props;if(""===e)return null;const l=t.target||s;return d.createElement(w.Mk.Consumer,null,(({dynamicContentlogAction:t})=>d.createElement(y.A,{href:void 0!==l&&""!==l?l:void 0,title:e,subtitle:a,onClick:()=>this._onClickViewAll(t)})))}_renderEnrichedTitle(){const{related:e,target:t,enrichedTitle:a}=this.props,s=e.target||t;return d.createElement(b.A,{href:void 0!==s&&""!==s?s:void 0,enrichedTitle:a})}_onClickViewAll(e){const{module_id:t,pageContext:a,tab:s}=this.props;e({action:w.D$.VIEW_ALL_CLICKED,payload:{module_id:t}}),null!=a&&a.includes("profile_")&&E.A.log({type:"cdp",eventName:"view_all_clicked",customAttributes:{section_name:f.Xw[s],screen_view_name:"profile_recently_played"===a?f.Xw.home:f.Xw[a.replace("profile_","")]}})}_shouldDisplayControls(){const{hasControlLeft:e,hasControlRight:t}=this.state;return e||t}_renderControlRight(){return this._shouldDisplayControls()?d.createElement("div",{className:"carousel-control carousel-next"},d.createElement(_.K0,{"aria-label":(0,h.AP)("Suivant"),isDisabled:!this.state.hasControlRight,icon:"ltr"===this.props.langDirection?s||(s=d.createElement(P.v,null)):l||(l=d.createElement(T.Y,null)),onClick:this._onSlide.bind(this,"right",!0),variant:"ghost"})):null}_renderControlLeft(){return this._shouldDisplayControls()?d.createElement("div",{className:"carousel-control carousel-prev"},d.createElement(_.K0,{"aria-label":(0,h.AP)("PrÃ©cÃ©dent"),isDisabled:!this.state.hasControlLeft,icon:"ltr"===this.props.langDirection?r||(r=d.createElement(T.Y,null)):n||(n=d.createElement(P.v,null)),onClick:this._onSlide.bind(this,"left",!0),variant:"ghost"})):null}_renderControls(){if(!this.props.data.length)return null;let e={};return this.props.autoAnimate&&(e={onMouseEnter:this._onMouseOver,onMouseLeave:this._onMouseOut}),d.createElement("div",(0,i.A)({className:"carousel-controls"},e),this._renderControlLeft(),this._renderControlRight())}_onAutoAnimation(){const{hasControlLeft:e,hasControlRight:t,mouseIn:a}=this.state;!a&&t?this._onSlide("right",t):!a&&e&&this._processNewState(0)}_onMouseOver(){this.setState({mouseIn:!0})}_onMouseOut(){this.setState({mouseIn:!1})}_onSlide(e,t){if(t){const{itemIndex:t,displayedItemCount:a}=this.state,s=t+("left"===e?-1:1)*a;s!==t&&this._processNewState(s)}}_measureContainerWidth(){return this._nodeRef.current?this._nodeRef.current.querySelector(".carousel-inner").getBoundingClientRect().width:0}_checkItems(){if(!this._nodeRef.current)return;const e=this._nodeRef.current.getElementsByClassName("thumbnail-col");if(!e||0===e.length)return;const t=this._measureContainerWidth(),a="margin"+("rtl"===this.props.langDirection?"Right":"Left"),s=e[0].offsetWidth+parseInt(window.getComputedStyle(e[0])[a],10),l=Math.min(e.length,Math.ceil(t/s));this.setState({containerWidth:t,displayedItemCount:l,itemWidth:s},(()=>{this._processNewState(this.state.itemIndex)}))}_debouncedCheckItems(){this._debounceRef=(0,p.A)((()=>{this._checkItems()}),300),this._debounceRef()}_processNewState(e){if(!this._nodeRef.current)return;const t=this._nodeRef.current.getElementsByClassName("thumbnail-col"),{displayedItemCount:a}=this.state;e=Math.min(t.length-a,Math.max(0,e)),this.setState({itemIndex:e,hasControlLeft:e>0,hasControlRight:e+a<t.length})}_initAds(){this._checkItems()}_setAutoAnimate(){this.props.autoAnimate&&(this._intervalAutoAnimate=setInterval((()=>{this._onAutoAnimation()}),6e3))}}v.childContextTypes={layout:c().string},v.defaultProps={title:"",subtitle:"",target:"",section_id:"",hasMoreItems:!1,related:{target:"",label:""},options:[],alignment:"center",autoAnimate:!1,context:""};const S=(0,m.Ng)((({user:e})=>({langDirection:e.DIRECTION})))(v)},I36q:(e,t,a)=>{a.d(t,{d:()=>s});let s=function(e){return e.Welcome="welcome",e.Improve="improve",e}({})},"JKL/":(e,t,a)=>{a.d(t,{A:()=>r});var s=a("q1tI"),l=a("TDRX");const r=({children:e,className:t=""})=>s.createElement(l.a,{mt:"spacing.xl",mb:"spacing.2xl",className:t},e)},sCpb:(e,t,a)=>{a.d(t,{A:()=>p});var s=a("q1tI"),l=a("CdHq"),r=a("mmFw"),n=a("pVdW"),i=a("y7xR"),o=a("9OcB"),c=a("GkjM"),d=a("hz5U"),m=a("5G9X");const p=({enrichedTitle:e,href:t})=>{var a;let p;if(null!==(a=e.pictures[0])&&void 0!==a&&a.md5){const t=d.A.getCoverType(e.type);p=d.A.getImageSrc(t,e.pictures[0].md5,48,48,"none")}return s.createElement(l.s,{direction:"row",align:"center"},s.createElement(c.A,{to:t,me:"spacing.s"},e.type===m.Ay.Artist||e.type===m.Ay.User?s.createElement(r.eu,{src:p,name:e.title,size:"size.xl",variant:"neutral","data-testid":"dynamic_page_section_image"}):s.createElement(o.A,{src:p,type:e.type,alt:e.title,size:"size.xl","data-testid":"dynamic_page_section_image"})),s.createElement(l.s,{direction:"column",w:"100%"},s.createElement(n.E,{variant:"body.s.default",mb:"spacing.xs",color:"text.neutral.secondary.default","data-testid":"dynamic_page_section_lead_in",noOfLines:1,maxW:"90%"},e.lead_in),s.createElement(i.D,{variant:"heading.m",noOfLines:1,maxW:"90%","data-testid":"dynamic_page_section_title"},s.createElement(c.A,{to:t,_hover:{textDecoration:"underline"},_active:{textDecoration:"underline"},_focus:{textDecoration:"underline"}},e.title))))}},lpJY:(e,t,a)=>{a.d(t,{A:()=>s});const s=a("lG1H").A},"6vRd":(e,t,a)=>{a.d(t,{K:()=>c,r:()=>o}),a("/eM8"),a("EV0h"),a("gS5K");var s=a("nrKQ"),l=a("Vd8Q"),r=a("Wp0Y"),n=a("fkXJ");const i=`//${l.default.get("host_website_ssl")}/profile/me`,o=async(e,t,a)=>{const l=await s.A.callAsync({method:"libraryimport.getTMMAccessToken",data:{}}).catch((e=>{throw e})),r=await fetch("https://www.tunemymusic.com/api/AuthenticateUser.php",{method:"POST",cache:"default",body:JSON.stringify({deezer_access_token:l,deezer_user_id:e,deezer_user_name:t,deezer_redirect_url:a?"deezer://reload":i})}).catch((e=>{throw e}));if(!r.ok||200!==r.status)throw new Error("TMM: response error");const n=await r.json().catch((e=>{throw e}));try{const e=new URL(n.migration_url);return e.searchParams.append("mode","deezer"),e.href}catch(e){throw new Error("TMM: migration url not valid")}},c=()=>{(0,n.A)({body:(0,r.AP)("libraryimporterdismiss_text_transferstillavailableinsettings_web")}),s.A.callAsync({method:"libraryimport.flagTMMAsDismissed"}).catch((e=>{throw e}))}},eerp:(e,t,a)=>{a.d(t,{A:()=>l});const s={song:0,track:0,album:1,artist:2,playlist:3,collaborativePlaylist:3,radio:4,smart_radio:6,smartradio:6,sradio:6,show:7,episode:8};function l(e){return s[e]}}}]);