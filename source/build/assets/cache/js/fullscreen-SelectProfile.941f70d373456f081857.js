"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[6224],{"1EyH":(e,t,r)=>{r.d(t,{BB:()=>n,Sx:()=>s,UC:()=>i});const s=e=>/[\u2000-\u2BFF]/.test(e),n=e=>/[\u{10000}-\u{10FFFF}]/u.test(e),i=e=>!!e.match(/^[_0-9a-z-+]+[_.0-9a-z-+]*@([0-9a-z-]+\.)+[a-z]{2,13}$/i)},EYlq:(e,t,r)=>{r.d(t,{u:()=>n});var s=r("Wp0Y");const n=e=>{switch(e){case"invalid_msisdn":return(0,s.AP)("errormessage_text_invalidphonenumber_web");case"sms_login_limit":return(0,s.AP)("SMScoderesentconfirmationscreen_text_allattemptsused_web");case"internal_error":case"swap_limit":default:return(0,s.AP)("errormessage_text_anerroroccurredpleasetryagain_web");case"invalid_code":case"invalid_code_wrong":return(0,s.AP)("errormessage_text_invalidcode_web");case"code_too_short":return(0,s.AP)("errormessage_text_codeincomplete_web");case"code_too_long":return(0,s.AP)("errormessage_text_codetoomanydigits_web");case"phone_already_used":return(0,s.AP)("Ce numéro est déjà utilisé.")}}},FFEP:(e,t,r)=>{r.d(t,{X:()=>n});var s=r("nKUr");const n=(0,r("5sYN").w)({displayName:"LockIcon",viewBox:"0 0 24 24",pathSmall:[(0,s.jsx)("path",{d:"M13.5 14a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M17.683 8H15.5c0-2.569-1.252-4-3.5-4S8.5 5.431 8.5 8H6.315c-.412 0-.762.26-.832.62A29.453 29.453 0 0 0 5 13.68a29.99 29.99 0 0 0 .5 5.7c.07.36.42.62.831.62H17.7c.412 0 .762-.26.832-.62.631-2.94.622-7.87-.017-10.76-.07-.36-.42-.62-.832-.62ZM9.83 8c0-1.087.266-1.73.578-2.087.288-.33.763-.583 1.592-.583.83 0 1.304.253 1.592.583.312.356.578 1 .578 2.087H9.83Zm7.472 1.33H6.71a28.173 28.173 0 0 0-.378 4.362 29.07 29.07 0 0 0 .392 4.978h10.594c.477-2.649.47-6.736-.015-9.34Z",clipRule:"evenodd"})],pathMedium:[(0,s.jsx)("path",{d:"M10.53 13.436c.32-.29.8-.436 1.47-.436.585 0 1.048.134 1.38.402.409.33.62.862.62 1.598 0 .672-.14 1.172-.46 1.504-.321.332-.821.496-1.54.496-.658 0-1.138-.144-1.463-.436-.369-.33-.537-.85-.537-1.564 0-.708.16-1.231.53-1.564Z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M3.878 7H7c0-3.853 1.789-6 5-6 3.21 0 5 2.147 5 6h3.119c.587 0 1.088.347 1.188.827.913 3.853.926 10.426.025 14.346-.1.48-.6.827-1.189.827H3.904c-.588 0-1.088-.347-1.188-.827-.426-2.066-.739-4.786-.714-7.6.025-2.573.313-4.84.689-6.746.1-.48.6-.827 1.188-.827ZM9 7c0-1.65.386-2.63.832-3.165C10.232 3.357 10.87 3 12 3c1.13 0 1.769.357 2.168.835C14.614 4.371 15 5.35 15 7H9Zm10.512 2c.642 3.38.653 8.563.02 12H4.527A35.994 35.994 0 0 1 4 14.592c.02-2.09.224-3.964.505-5.592h15.006Z",clipRule:"evenodd"})]});n.defaultProps={fill:"currentColor",boxSize:"24px",display:"block","data-testid":"LockIcon"}},H9G8:(e,t,r)=>{r.d(t,{CZ:()=>d,Ee:()=>u,Hf:()=>o,In:()=>h,RQ:()=>m,SY:()=>l,U9:()=>_,aS:()=>p,jQ:()=>a,qb:()=>c,r_:()=>E,vM:()=>A});var s=r("Wp0Y"),n=r("5U+Y"),i=r("guCc");class a extends Error{constructor(e){super(e),this.name=i.U.FORM_ERROR}}class o extends a{constructor(){super((0,s.AP)("formerrormessage_text_emailaddressformatnotvalid_web")),this.name=i.U.EMAIL_NOT_VALID}}class l extends a{constructor(e){super((0,s.AP)("errormessage_text_domainnnamenotallowed_web",{sprintf:[e]})),this.name=i.U.EMAIL_DOMAIN_NOT_VALID}}class c extends a{constructor(){super((0,s.AP)("errormessage_title_accountalrdyassociatedwithemail_web")),this.name=i.U.EMAIL_ALREADY_USED}}class d extends a{constructor(){super((0,s.WI)("formerrormessage_text_passwordnotenoughchars_web","formerrormessage_text_passwordnotenoughchars_web",{sprintf:[n.wz],count:n.wz})),this.name=i.U.PASSWORD_TOO_SHORT}}class u extends a{constructor(){super((0,s.WI)("formerrormessage_text_passwordtoomanychars_web","formerrormessage_text_passwordtoomanychars_web",{sprintf:[n.K9],count:n.K9})),this.name=i.U.PASSWORD_TOO_LONG}}class m extends a{constructor(){super((0,s.AP)("errormessage_text_passwordnbeginendwithspace_web")),this.name=i.U.PASSWORD_HAS_TRAILLING_WHITESPACE}}class _ extends a{constructor(){super((0,s.WI)("formerrormessage_text_usernamenotenoughchars_web","formerrormessage_text_usernamenotenoughchars_web",{sprintf:[n.D6],count:n.D6})),this.name=i.U.BLOGNAME_TOO_SHORT}}class p extends a{constructor(){super((0,s.WI)("formerrormessage_text_usernametoomanychars_web","formerrormessage_text_usernametoomanychars_web",{sprintf:[n.d0],count:n.d0})),this.name=i.U.BLOGNAME_TOO_LONG}}class h extends a{constructor(){super((0,s.AP)("errormessage_text_usernamecannotcontainsemojis_web")),this.name=i.U.BLOGNAME_HAS_SPECIAL_CHARS}}class E extends a{constructor(e){super((0,s.WI)("agerestrictionerrormessage_text_mustbeXyearsentervaliddate_web","agerestrictionerrormessage_text_mustbeXyearsentervaliddate_web",{sprintf:[e],count:e})),this.name=i.U.MIN_LEGAL_AGE}}class A extends a{constructor(){super((0,s.AP)("errormessage_text_ageisinvalid_web")),this.name=i.U.AGE_INVALID}}},"YG/N":(e,t,r)=>{r.d(t,{A:()=>h});var s=r("WKgy"),n=r("q1tI"),i=r("juqV");var o=r("TRpf"),l=r("DVo4"),c=r("nxAS");const d=(0,o.Ng)(null,{closeScreen:c.Fn})((({customClose:e,closeScreen:t})=>{const r=e||t;return n.createElement(l.J,{position:"absolute",top:"8px",insetInlineEnd:"8px",size:"lg",onClick:r,zIndex:2})}));var m=r("+9dH"),_=r("TDRX");s.A.addReducers({modal:c.Ay});const h={Body:({className:e,children:t})=>{const r=(0,i.A)("full-screen-body",e);return n.createElement("div",{className:r},t)},Close:d,Footer:({className:e,children:t})=>{const r=(0,i.A)("full-screen-footer",e);return n.createElement("div",{className:r},t)},Header:({className:e,children:t,...r})=>{const s=(0,i.A)("full-screen-header",e);return n.createElement(_.a,(0,m.A)({as:"h1",className:s},r),t)}}},guCc:(e,t,r)=>{r.d(t,{U:()=>s,m:()=>n});let s=function(e){return e.AGE_INVALID="FORM_ERROR_AGE_INVALID",e.BLOGNAME_HAS_SPECIAL_CHARS="FORM_ERROR_BLOGNAME_HAS_SPECIAL_CHARS",e.BLOGNAME_TOO_LONG="FORM_ERROR_BLOGNAME_TOO_LONG",e.BLOGNAME_TOO_SHORT="FORM_ERROR_BLOGNAME_TOO_SHORT",e.EMAIL_ALREADY_USED="FORM_ERROR_EMAIL_ALREADY_USED",e.EMAIL_DOMAIN_NOT_VALID="FORM_ERROR_EMAIL_DOMAIN_NOT_VALID",e.EMAIL_NOT_VALID="FORM_ERROR_EMAIL_NOT_VALID",e.FORM_ERROR="FORM_ERROR",e.MIN_LEGAL_AGE="FORM_ERROR_MIN_LEGAL_AGE",e.PASSWORD_HAS_TRAILLING_WHITESPACE="FORM_ERROR_PASSWORD_HAS_TRAILLING_WHITESPACE",e.PASSWORD_TOO_LONG="FORM_ERROR_PASSWORD_TOO_LONG",e.PASSWORD_TOO_SHORT="FORM_ERROR_PASSWORD_TOO_SHORT",e}({}),n=function(e){return e[e.TOO_WEAK=0]="TOO_WEAK",e[e.WEAK=1]="WEAK",e[e.MEDIUM=2]="MEDIUM",e[e.STRONG=3]="STRONG",e}({})},mbHV:(e,t,r)=>{r.d(t,{l:()=>h});var s=r("nKUr"),n=r("p1Zg"),i=r("rqZt"),a=r("8XH8"),o=r("E3wd"),l=r("q1tI"),c=r("8EFB"),d=r("xi32"),u=r("D9nb");const m=(0,d.R)((function(e,t){const{children:r,placeholder:n,className:i,...a}=e;return(0,s.jsxs)(u.B.select,{...a,ref:t,className:(0,c.cx)("chakra-select",i),children:[n&&(0,s.jsx)("option",{value:"",children:n}),r]})}));m.displayName="SelectField";var _=r("OllG"),p=r("Qc6l");const h=(0,d.R)(((e,t)=>{const r=(0,p.o)("Select",e),{rootProps:l,placeholder:c,icon:d,color:h,height:E,h:A,minH:f,minHeight:I,iconColor:b,iconSize:S,...v}=(0,n.M)(e),[L,w]=(0,a.l)(v,i.GF),R=(0,_.t)(w),C={width:"100%",height:"fit-content",position:"relative",color:h},M={paddingEnd:"2rem",...r.field,_focus:{zIndex:"unset",...r.field?._focus}};return(0,s.jsxs)(u.B.div,{className:"chakra-select__wrapper",__css:C,...L,...l,children:[(0,s.jsx)(m,{ref:t,height:A??E,minH:f??I,placeholder:c,...R,__css:M,children:e.children}),(0,s.jsx)(g,{"data-disabled":(0,o.s)(R.disabled),...(b||h)&&{color:b||h},__css:r.icon,...S&&{fontSize:S},children:d})]})}));h.displayName="Select";const E=e=>(0,s.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,s.jsx)("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),A=(0,u.B)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),g=e=>{const{children:t=(0,s.jsx)(E,{}),...r}=e,n=(0,l.cloneElement)(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return(0,s.jsx)(A,{...r,className:"chakra-select__icon-wrapper",children:(0,l.isValidElement)(t)?n:null})};g.displayName="SelectIcon"},oDDZ:(e,t,r)=>{r.r(t),r.d(t,{SelectProfile:()=>Oe,default:()=>Te}),r("WpbS");var s=r("q1tI"),n=r("TRpf"),i=r("Ty5D"),a=r("lXQd"),o=r("RGaU"),l=r("WmA5"),c=r("u7vQ"),d=r("Wp0Y"),u=r("TqF5"),m=r("2qhg"),_=r("xobL"),p=r("aHAS"),h=r("70bL"),E=r("fkXJ");let A=function(e){return e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Success=2]="Success",e[e.Error=3]="Error",e}({});var g,f,I,b,S=r("D+Zh"),v=r("nrKQ"),L=r("34sk"),w=r("nxAS"),R=r("r2u9"),C=r("YG/N"),M=r("+9dH"),y=r("K5vB"),P=r("Qx5r"),N=r("ZUSG"),O=r("FFEP"),x=r("eTJY");const T=e=>e.showEditIcon?s.createElement("div",{className:"select-profile-account-picture-icon-center"},e.useTrashIcon?g||(g=s.createElement(P.u,{size:"medium"})):f||(f=s.createElement(N.r,{size:"medium"}))):e.showLockIcon?I||(I=s.createElement("div",{className:"select-profile-account-picture-icon-border"},s.createElement(O.X,null))):e.isMe?b||(b=s.createElement("div",{className:"select-profile-account-picture-icon-border is-me"},s.createElement(x.S,null))):null;T.defaultProps={showEditIcon:!1,showLockIcon:!1,isMe:!1,useTrashIcon:!1},T.displayName="AccountIcon";const D=T;var U,k=r("QOhT"),F=r("hz5U"),B=r("5G9X"),V=r("6VLJ");const G=e=>{var t;return s.createElement("div",{className:"select-profile-account-picture-wrapper","data-testid":"account-editor-picture"},s.createElement("div",{className:"select-profile-account-picture"},s.createElement(k.A,{id:Number(e.userId),type:B.Ay.User,imgSrc:null!==(t=e.updatedUserImage)&&void 0!==t?t:F.A.getImageSrc(B.Ay.User,e.userPicture,120,120),width:120,height:120,coverLink:!1,uploadCover:e.allowUpload?V.B.on:V.B.off,rounded:!0}),e.isMe&&!e.showEditIcon?U||(U=s.createElement("div",{className:"select-profile-account-picture-is-me"})):null),s.createElement(D,{showEditIcon:e.showEditIcon,showLockIcon:e.showLockIcon,isMe:e.isMe,useTrashIcon:e.useTrashIcon}))};G.defaultProps={allowUpload:!1,showEditIcon:!1,showLockIcon:!1,isMe:!1,updatedUserImage:void 0,useTrashIcon:!1},G.displayName="AccountPicture";const H=G,W=(0,r("D9nb").B)("div",{baseStyle:{m:"auto",w:"80",textAlign:"start"}});var X=r("FVVF"),Y=r("pVdW"),K=r("HmE0"),z=r("tZCQ");const j=e=>{let t=(0,d.AP)("genderoption_text_unknown_web");"F"===e.user.SEX?t=(0,d.AP)("genderoption_text_female_web"):"M"===e.user.SEX?t=(0,d.AP)("genderoption_text_male_web"):"NonBinary"===e.user.SEX&&z.A.isAllowed("gender_nonbinary")&&(t=(0,d.AP)("genderoption_text_nonbinary_web"));const r=e.user.BIRTHDAY?(new Date).getFullYear()-new Date(e.user.BIRTHDAY).getFullYear():0;return s.createElement(W,{"data-testid":"account-editor-sub-account"},s.createElement(X.T,{alignItems:"center",spacing:"4"},s.createElement(Y.E,{color:"text.neutral.secondary.default"},e.user.BLOG_NAME),s.createElement(Y.E,{color:"text.neutral.secondary.default"},t,`, ${(0,d.WI)("%s an","%s ans",{count:r,sprintf:[r]})}`),s.createElement(K.$n,{variant:"outline",onClick:e.onCancel,"data-testid":"subaccount-cancel-btn"},(0,d.AP)("generic_action_cancel_web")),s.createElement(K.$n,{variant:"ghost",onClick:()=>e.onRemove(e.user),"data-testid":"subaccount-remove-btn"},(0,d.AP)("Retirer"))))};var Z=r("80JK"),q=r("8WIx"),$=r("XkdG"),J=r("jysG"),Q=r("mbHV"),ee=r("PF77"),te=r("Votb"),re=r("CdHq"),se=r("H9G8"),ne=r("zerP"),ie=r("5U+Y"),ae=r("X6oL");function oe(e,t){switch(t.type){case"update_blogname":{const{isValid:r,message:s}=(e=>{try{return(0,ne.iE)(t.value),{isValid:!0,message:""}}catch(e){return e instanceof se.jQ?{isValid:!1,message:e.message}:{isValid:!1,message:""}}})((()=>(0,ne.iE)(t.value)));return{...e,blogname:{value:t.value,isValid:r,error:s}}}case"update_kid":return{...e,isKid:{value:t.value,error:"",isValid:!0}};case"update_gender":return{...e,gender:{value:t.value,isValid:!0,error:""}};case"update_age":{if(!t.value)return{...e,age:{value:t.value,isValid:!1,error:(0,d.AP)("familyprofileswitcheraddprofile_text_pleaseselectage_web")}};const r={value:t.value,isValid:!0,error:""};return t.value<ie.fB?{...e,age:r,isKid:{value:!0,error:"",isValid:!0},hideExplicitConsent:!0}:{...e,age:r,isKid:{value:!1,error:"",isValid:!0},hideExplicitConsent:!1}}default:return{...e,...t.value}}}const le=({user:e,...t})=>{const{trackEvent:r}=(0,ae.z1)(),n=z.A.isAllowed("gender_nonbinary")?(0,d.AP)("genderscreen_title_identity_web"):(0,d.AP)("Genre"),{state:i,dispatch:a,isExplicitLevelEditable:o,isFormValid:l,isNew:c}=(e=>{var t,r;const n=!parseInt(e.USER_ID,10),[i,a]=(0,s.useReducer)(oe,{blogname:{value:e.BLOG_NAME||"",isValid:!0,error:""},isKid:{value:e.IS_KID||!1,isValid:!0,error:""},gender:{value:e.SEX||"F",isValid:!0,error:""},age:{value:e.BIRTHDAY?(new Date).getFullYear()-new Date(e.BIRTHDAY).getFullYear():18,isValid:!0,error:""},kidsConsent:{value:!n,isValid:!0,error:""},hideExplicitConsent:null!==(t=e.EXTRA_FAMILY.TOGGLE_EXPLICIT_CONTROL)&&void 0!==t&&t}),o=i.blogname.value.length>0&&i.blogname.isValid&&i.age.isValid&&i.gender.isValid&&(i.age.value>=ie.fB||i.kidsConsent.value);return{state:i,dispatch:a,isExplicitLevelEditable:!i.isKid.value||!n&&null!==(r=e.EXTRA_FAMILY.IS_EXPLICIT_LEVEL_EDITABLE)&&void 0!==r&&r,isFormValid:o,isNew:n}})(e),u=i.hideExplicitConsent||i.isKid.value;return s.createElement(W,{"data-testid":"account-editor-sub-profile"},s.createElement(X.T,{alignItems:"start",spacing:"4"},s.createElement(Z.MJ,{isRequired:!0,isInvalid:!i.blogname.isValid},s.createElement(q.l,null,(0,d.AP)("Username")),s.createElement($.p,{"data-testid":"subprofile-edit-username",onChange:e=>a({type:"update_blogname",value:e.target.value}),value:i.blogname.value}),s.createElement(J.Wt,null,i.blogname.error)),s.createElement(Z.MJ,{isRequired:!0,isInvalid:!i.gender.isValid},s.createElement(q.l,{htmlFor:"subprofile-edit-gender"},n),s.createElement(Q.l,{id:"subprofile-edit-gender",onChange:e=>a({type:"update_gender",value:e.target.value}),value:i.gender.value},s.createElement("option",{value:"F"},(0,d.AP)("genderoption_text_female_web")),s.createElement("option",{value:"M"},(0,d.AP)("genderoption_text_male_web")),z.A.isAllowed("gender_nonbinary")&&s.createElement("option",{value:"NonBinary"},(0,d.AP)("genderoption_text_nonbinary_web"))),s.createElement(J.Wt,null,i.gender.error)),s.createElement(Z.MJ,{isRequired:!0,isInvalid:!i.age.isValid},s.createElement(q.l,{htmlFor:"subprofile-edit-age"},(0,d.AP)("Age")),s.createElement(Q.l,{id:"subprofile-edit-age","data-testid":"subprofile-edit-age",onChange:e=>a({type:"update_age",value:parseInt(e.target.value,10)}),value:i.age.value},[...Array(99)].map(((e,t)=>{const r=t+1;return s.createElement("option",{key:r,value:r},r)}))),s.createElement(J.Wt,null,i.age.error)),s.createElement(ee.S,{"data-testid":"subprofile-toggle-explicit",isChecked:u,isDisabled:!o,onChange:e=>{a({type:"state",value:{hideExplicitConsent:e.target.checked}}),r({event:"click",eventlabel:e.target.checked?"allow-explicit-content":"block-explicit-content"})}},(0,d.AP)("settingspage_title_hideexplicitcontent_web")),s.createElement(ee.S,{isChecked:i.isKid.value,onChange:e=>a({type:"update_kid",value:e.target.checked}),"data-testid":"subprofile-toggle-kid",isDisabled:t.currentUserIsKid||i.age.value<ie.fB},(0,d.AP)("familyprofileswitcheraddprofile_title_kidprofile_web")),i.age.value<ie.fB&&s.createElement(s.Fragment,null,s.createElement(Z.MJ,{isInvalid:!i.kidsConsent.isValid},s.createElement(ee.S,{isChecked:i.kidsConsent.value,"data-testid":"subprofile-toggle-kid-consent",onChange:e=>a({type:"state",value:{kidsConsent:{value:e.target.checked,isValid:!0,error:""}}}),isDisabled:t.currentUserIsKid},(0,d.AP)("familyprofileminorconsent_title_gdpchildconsent_web")),s.createElement(J.Wt,null,i.kidsConsent.error)),s.createElement(Y.E,{color:"text.neutral.secondary.default",fontSize:"11px",sx:{"> a":{color:"text.neutral.primary.default"}},dangerouslySetInnerHTML:{__html:(0,d.WI)("familyprofileminorconsent_text_termsandconditions_web","familyprofileminorconsent_text_termsandconditions_web",{count:ie.fB,sprintf:[ie.fB,'target="_blank" href="/legal/cgu"']})}})),s.createElement(te.z,{spacing:"8",w:"100%",justifyContent:"center"},s.createElement(K.$n,{variant:"outline",onClick:t.onCancel,"data-testid":"subprofile-cancel-btn"},(0,d.AP)("generic_action_cancel_web")),s.createElement(K.$n,{onClick:()=>{var r;l&&t.onSave({userId:e.USER_ID,isPersonalDataEditable:null!==(r=e.EXTRA_FAMILY.IS_PERSONAL_DATA_EDITABLE)&&void 0!==r&&r,blogname:i.blogname.value,isKid:i.isKid.value,gender:i.gender.value,age:i.age.value,kidsConsent:i.kidsConsent.value,isExplicitLevelEditable:o,forceExplicitLevel:u})},isLoading:t.formLoading,isDisabled:Boolean(t.formLoading)||!l,"data-testid":"subprofile-save-btn"},c?(0,d.AP)("Créer"):(0,d.AP)("Enregistrer"))),!c&&e.EXTRA_FAMILY.IS_DELETABLE&&s.createElement(re.s,{w:"100%",justifyContent:"center"},s.createElement(K.$n,{margin:"auto",variant:"ghost",onClick:()=>t.onRemove(e),"data-testid":"subprofile-remove-btn"},(0,d.AP)("Supprimer")))))},ce=({user:e,...t})=>{var r;const[n,i]=(0,s.useState)(void 0),[a,o]=(0,s.useState)(void 0),l=!parseInt(e.USER_ID,10),c=null!==(r=e.EXTRA_FAMILY.IS_PERSONAL_DATA_EDITABLE)&&void 0!==r&&r;let u=(0,d.AP)("familymembermanager_title_managemember_web");c&&(u=(0,d.AP)("familyprofileswitchereditprofile_title_editprofile_web")),l&&(u=(0,d.AP)("familyprofileswitcheraddprofile_title_newprofile_web"));const m={user:e,...t,onSave:e=>{n?(o(e),n.action(e.userId)):t.onSave(e)}};return s.createElement(s.Fragment,null,s.createElement(C.A.Header,null,u),s.createElement(C.A.Body,null,s.createElement(y.AG,{value:{onDisplay:(e,t)=>{i({imageData:e,action:t})},onSuccess:()=>{a&&t.onSave({...a,pictureUpdated:!0})},onError:()=>{(0,E.A)({body:(0,d.AP)("errormessage_text_anerroroccurredpleasetryagain_web")}),a&&t.onSave(a)}}},!l&&s.createElement(H,{allowUpload:c,userPicture:e.USER_PICTURE,updatedUserImage:null==n?void 0:n.imageData,userId:e.USER_ID})),c?s.createElement(le,(0,M.A)({},m,{formLoading:!!a})):s.createElement(j,m)))};var de;const ue=e=>s.createElement("div",{key:"select-profile-account-loader-animation",className:"select-profile-account-loader-animation"},de||(de=s.createElement("div",{className:"select-profile-account-loader-spinner"})),s.createElement("img",{alt:"",className:"select-profile-account-loader-picture",src:F.A.getImageSrc("user",e.userPicture,120,120)}),s.createElement("p",null,(0,d.AP)("familyprofileswitcherloading_text_settingupprofile_web")));ue.displayName="AccountLoader";const me=ue;var _e=r("U7Z4"),pe=r("TDRX"),he=r("YIja"),Ee=r("juqV");const Ae=e=>e.EXTRA_FAMILY.IS_PERSONAL_DATA_EDITABLE||e.EXTRA_FAMILY.IS_DELINKABLE||e.EXTRA_FAMILY.IS_EXPLICIT_LEVEL_EDITABLE,ge=e=>{const{account:t,isInactive:r,isMe:n,onEdit:i,onPick:a,isEditionMode:o,useTrashIcon:l,index:c}=e,d=t.EXTRA_FAMILY,u=Ae(t),m=(0,Ee.A)("select-profile-account-item",{inactive:r,disable:r||o&&!u}),_=(0,Ee.A)("select-profile-account-item-type",{"main-account":n&&!u});return s.createElement("div",{"data-testid":`select-profile-account-item-${c}`,className:m,onClick:()=>o?i(t):r?void 0:a(t)},s.createElement(H,{showEditIcon:o&&u,showLockIcon:!d.IS_LOGGABLE_AS,isMe:n,userId:t.USER_ID,userPicture:t.USER_PICTURE,useTrashIcon:l}),s.createElement("p",{className:"select-profile-account-item-name"},t.BLOG_NAME),s.createElement("p",{className:_},d.CAPTION))};ge.defaultProps={isInactive:!1,useTrashIcon:!1},ge.displayName="AccountItem";const fe=ge;var Ie,be,Se;function ve({childs:e,currentUserId:t=0,isManagementActivated:r=!1,hasNoChildAccountSelected:n,hasParent:i,offerActive:a,onAdd:o,onEdit:l,onPick:c,remainingAccountsCount:u,maxChildren:m=0,offerName:_,displaySuccessProfileChange:p,isOffline:h}){const[E,A]=(0,s.useState)(!1),g=!n&&e.reduce(((e,t)=>e||Ae(t)),!1),f=!h&&u>=1&&a&&g&&!i,I=g&&a;return s.createElement(s.Fragment,null,s.createElement(C.A.Header,null,E?(0,d.AP)("settingspage_title_members_web"):n?(0,d.AP)("familyprofileswitcherloginpage_title_welcomebackselectyourprofile_web"):(0,d.AP)("settingspage_title_members_web")),s.createElement(C.A.Body,null,s.createElement(X.T,{spacing:"spacing.xl",alignItems:"center"},s.createElement(we,{displaySuccessProfileChange:p,isOffline:h,maxChildren:m,offerActive:a,offerName:_,remainingAccountsCount:u}),s.createElement(re.s,{flexWrap:"wrap",justifyContent:"center"},e.map(((e,n)=>{const i=!e.PARENT_ID,o={isInactive:u<0&&!i||!a&&!i||h,isMe:t===Number(e.USER_ID),onPick:c,onEdit:l,isEditionMode:E,account:e,useTrashIcon:!r,index:n};return s.createElement(fe,(0,M.A)({key:e.USER_ID},o))})),f&&s.createElement(Le,{onAdd:o,remainingAccountsCount:u})),I&&s.createElement(Re,{isEditMode:E,isOffline:h,toggleEditMode:()=>A(!E)}))))}function Le({onAdd:e,remainingAccountsCount:t}){const r=(0,d.AP)("settingspage_title_members_web"),n={count:t,sprintf:[t]},i=(0,d.WI)("familymemberselector_text_Xmembersremaining_web","familymemberselector_text_Xmembersremaining_web",n);return s.createElement("div",{"data-testid":"select-profile-account-picker-adder-picture",className:"select-profile-account-picker-adder",onClick:e},Ie||(Ie=s.createElement("div",{className:"select-profile-account-picker-adder-picture"})),s.createElement("div",{className:"select-profile-account-picker-adder-label"},r),s.createElement("div",{className:"select-profile-account-picker-adder-remaining"},i))}function we({displaySuccessProfileChange:e,isOffline:t,maxChildren:r,offerActive:n,offerName:i,remainingAccountsCount:a}){const o={maxW:"830px",textAlign:"start"};return n?a<0&&null!=r?s.createElement(he.N,(0,M.A)({icon:!0,status:"error"},o),(0,d.WI)("warningmessage_text_onlyuptoXmemberswithXplan_web","warningmessage_text_onlyuptoXmemberswithXplan_web",{count:r,sprintf:[r,i]}),Se||(Se=s.createElement("br",null)),(0,d.AP)("warningmessage_text_removeextramembers_web")):0===a&&!0===e?s.createElement(he.N,(0,M.A)({icon:!0,status:"success"},o),(0,d.AP)("successmessage_text_allmemberaccountsactive_web")):t?s.createElement(he.N,(0,M.A)({status:"warning"},o),(0,d.AP)("Il semble que vous êtes hors-ligne")):void 0:s.createElement(_e.Fc,(0,M.A)({status:"warning"},o),be||(be=s.createElement(_e._0,null)),s.createElement(pe.a,{flex:"1",me:"spacing.m"},s.createElement(_e.XL,null,(0,d.AP)("familyresubbanner_title_whynoaccesstoprofiles_web")),s.createElement(_e.TN,{display:"block"},(0,d.AP)("familyresubbanner_text_younolongersubtomultiprofileplan_web")," ",(0,d.AP)("familyresubbanner_text_togetprofilesbackresubscribe_web"))),s.createElement(K.$n,{variant:"onContent",as:"a",href:"/offers",target:"_blank"},(0,d.AP)("Voir les offres")))}function Re({isEditMode:e,isOffline:t,toggleEditMode:r}){return e?s.createElement(K.$n,{key:"cancel",onClick:r,"data-testid":"accountpicker-cancel-btn",isDisabled:t},(0,d.AP)("generic_action_cancel_web")):s.createElement(K.$n,{key:"manage",onClick:r,"data-testid":"accountpicker-manage-btn",isDisabled:t},(0,d.AP)("familymemberselector_title_managemembers_web"))}const Ce=({error:e})=>{const t=(0,n.wA)();return s.createElement(s.Fragment,null,s.createElement(C.A.Header,null,(0,d.AP)("Erreur")),s.createElement(C.A.Body,{className:"select-profile-alert"},s.createElement(he.N,{status:"error"},e),s.createElement("div",{className:"select-profile-alert-button-ctn"},s.createElement(K.$n,{onClick:()=>{t((0,w.Fn)())}},(0,d.AP)("generic_action_close_web")))))};var Me,ye=r("e2eG"),Pe=r("LOxp"),Ne=r("G04z");class Oe extends s.Component{constructor(...e){super(...e),this.state={editUserId:null,isSelectedAccountLoading:!1,selectedAccount:null,isEditing:!1,displaySuccessProfileChange:!1},this._renderClose=()=>this.props.allowScreenClose?s.createElement(C.A.Close,{customClose:this.props.closeScreen}):null,this._onOpenMemberType=()=>{this.props.openModal({name:"FAMILY_MEMBER_TYPE",size:"small",props:{onSendInvitation:()=>this._onSendInvitation(),onCreateProfile:()=>this._onToggleEditing()}})},this._onSendInvitation=()=>{this.props.openModal({name:"FAMILY_SEND_INVITATION",size:"small"})},this._onIsEditingId=({USER_ID:e,EXTRA_FAMILY:t})=>{if(!t.IS_PERSONAL_DATA_EDITABLE&&!t.IS_DELINKABLE)return;const r=this.props.childList.reduce(((t,r)=>e===r.USER_ID?r:t),{USER_PICTURE:"",USER_ID:e});r.PARENT_ID?this._onToggleEditing(e):this._goToMainAccountSettings(e)},this._onCancelEdit=()=>{this._onToggleEditing()},this._onSaveMember=e=>{e.userId?e.isPersonalDataEditable?this._updateSubProfile(e):this._updateSubAccount(e):this._createSubProfile(e)},this._onToggleEditing=(e=null)=>{const{isEditing:t}=this.state;return this.setState({isEditing:!t,editUserId:e})},this._goToMainAccountSettings=e=>{const t=Number(e);if(t===this.props.currentUserId)return this.props.selectChildAccount(t),this.props.closeScreen(),void this.props.history.push("/account");this.setState({isSelectedAccountLoading:!0,selectedAccount:e}),m.default.loginMulti(t,(e=>{e?this.setState({alert:this._getErrorMessage(e)}):(this.props.history.push("/account"),this.props.fetchUserData((()=>{this.props.selectChildAccount(t),this.props.closeScreen()})))}))},this._switchToProfile=e=>{if(this.props.isOnline)if((0,a.A)(e,"EXTRA_FAMILY.IS_LOGGABLE_AS",!1)){if(this.setState({isSelectedAccountLoading:!0,selectedAccount:this.props.childList.reduce(((t,r)=>e.USER_ID===r.USER_ID?r:t),{USER_PICTURE:"",USER_ID:e.USER_ID})}),this._isSameUserById(e.USER_ID))return this.props.selectChildAccount(e.USER_ID),void this.props.closeScreen();c.Ay.control.pause(),c.Ay.control.stop(),c.Ay.setEmptyPlayer(),(0,Ne.u)().logout(),m.default.loginMulti(e.USER_ID,(t=>{if(t)return void this.setState({alert:this._getErrorMessage(t)});const r=this.props.userLang;this.props.selectChildAccount(e.USER_ID),this.props.fetchUserData((()=>{const e=Pe.r.some((e=>this.props.history.location.pathname.startsWith(e)))?this.props.history.location.pathname:null;r===this.props.userLang?(ye.A.init(),this.props.closeScreen(),e?l.A.push(e):l.A.push("/",`home-${Math.floor(1e9*Math.random())}`)):m.default.refreshPageAfterLogin({type:"refresh",link:e||`/${this.props.userLang}`})}))}))}else(0,E.A)({body:(0,d.AP)("familymemberselectorerrormessage_text_thismemberusesadifferentlogin_web")});else(0,E.A)({body:(0,d.AP)("Il semble que vous êtes hors-ligne")})},this._createSubProfile=e=>{const{pendingAction:t}=this.state;if(!this.isCreateAllowed||t)return;const r=e.blogname.trim();r.length<2?this.setState({errorMessage:(0,d.AP)("Votre pseudo doit comporter au moins 2 caractères.")}):r.length>50?this.setState({errorMessage:(0,d.AP)("Votre pseudo ne doit pas dépasser 50 caractères.")}):(this.setState({pendingAction:!0,errorMessage:""}),this.props.createChildAccount({blogName:r,isKid:e.isKid,sex:e.gender,age:e.age,kidsConsent:e.kidsConsent,forceExplicitLevel:e.forceExplicitLevel},(()=>{this.setState({pendingAction:!1,displaySuccessProfileChange:!1}),this._onToggleEditing()}),(()=>{(0,E.A)({body:(0,d.AP)("errormessage_text_anerroroccurredpleasetryagain_web"),status:A.Error}),this.setState({pendingAction:!1,displaySuccessProfileChange:!1}),this._onToggleEditing()})))},this._updateSubProfile=e=>{const{pendingAction:t}=this.state;if(t)return;const r={userId:e.userId,forceExplicitLevel:e.forceExplicitLevel},s=e.blogname.trim();if(s.length<2)return void this.setState({errorMessage:(0,d.AP)("Votre pseudo doit comporter au moins 2 caractères.")});if(s.length>50)return void this.setState({errorMessage:(0,d.AP)("Votre pseudo ne doit pas dépasser 50 caractères.")});r.blogName=s,r.sex=e.gender,r.isKid=e.isKid,r.kidsConsent=e.kidsConsent,r.isExplicitLevelEditable=e.isExplicitLevelEditable,r.birthday=(new Date).getFullYear()-e.age+"-01-01",this.setState({pendingAction:!0,errorMessage:""});const{currentUserIsKid:n}=this.props,i=n!==e.isKid&&this._isSameUserById(e.userId);this.props.updateFamilySubProfile(r).then((()=>{i?R.Ay.reloadApp():(this._isSameUserById(e.userId)&&this.props.fetchUserData(),e.pictureUpdated&&this.props.fetchChildAccount(),this._updatedMember())})).catch(this._errorNotification)},this._updateSubAccount=e=>{const{pendingAction:t}=this.state;t||(this.setState({pendingAction:!0,errorMessage:""}),this.props.updateFamilySubAccount({userId:e.userId,forceExplicitLevel:e.forceExplicitLevel}).then(this._updatedMember).catch(this._errorNotification))},this._updatedMember=()=>{this._onCancelEdit(),this.setState({pendingAction:!1})},this._removeMember=e=>{const{pendingAction:t}=this.state;this._isSameUserById(e.USER_ID)||t||this.props.openModal({name:"DELETE_CHILD_CONFIRM",size:"small",props:{cancel:this.props.closeModal,confirm:()=>{this._removeMemberConfirmed(e),this.props.closeModal()},isDeletable:e.EXTRA_FAMILY.IS_DELETABLE,blogNameToMatch:e.BLOG_NAME,offerName:this.props.offerName}})},this._removeMemberConfirmed=({USER_ID:e,BLOG_NAME:t,EXTRA_FAMILY:r})=>{this._onCancelEdit(),r.IS_DELETABLE?this.props.deleteFamilyMember({id:e}).then((()=>this._removeMemberValidated(t,r.IS_DELETABLE))).catch(this._errorNotification):this.props.unlinkFamilyMember({id:e}).then((()=>this._removeMemberValidated(t))).catch(this._errorNotification)},this._removeMemberValidated=(e,t=!1)=>{const r=0===this.props.remainingAccountsCount?{pendingAction:!1,displaySuccessProfileChange:!0}:{pendingAction:!1};this.setState(r),t?(0,E.A)({body:(0,d.AP)("successmessage_text_userXdeletedfromyourplanX_web",{sprintf:[e,this.props.offerName]})}):(0,E.A)({body:(0,d.AP)("successmessage_text_userXremovedfromyourplanX_web",{sprintf:[e,this.props.offerName]})})},this._errorNotification=e=>{let t=(0,d.AP)("Une erreur est survenue, merci de réessayer plus tard.");e instanceof S.Dr&&(t="Votre ordinateur semble être hors ligne. Nous essayons de vous reconnecter."),(0,E.A)({body:t})}}componentDidMount(){this.props.fetchChildAccount()}componentWillUnmount(){v.A.cancel()}get isCreateAllowed(){return this.props.childList.length-1<this.props.maxChildren}get editUser(){const e={USER_ID:0,USER_PICTURE:"",EXTRA_FAMILY:{IS_PERSONAL_DATA_EDITABLE:!0,IS_DELETABLE:!1,IS_DELINKABLE:!1,IS_EXPLICIT_LEVEL_EDITABLE:!0,TOGGLE_EXPLICIT_CONTROL:!1}};return this.state.editUserId?this.props.childList.reduce(((e,t)=>Number(this.state.editUserId)===Number(t.USER_ID)?t:e),e):e}render(){if(this.state.alert)return this._renderAlert();if(this.state.isSelectedAccountLoading&&this.state.selectedAccount)return s.createElement("div",{className:"select-profile"},s.createElement(me,{userPicture:this.state.selectedAccount.USER_PICTURE||""}));if(!this.props.childListLoaded)return s.createElement("div",{className:"select-profile-loading"},this._renderClose(),s.createElement(C.A.Header,null,(0,d.AP)("familymemberselector_title_familymembers_web")),Me||(Me=s.createElement(o.k,null)));if(this.state.isEditing&&this.props.isOnline)return s.createElement("div",{className:"select-profile"},this._renderClose(),s.createElement(ce,{currentUserIsKid:this.props.currentUserIsKid,currentUserId:this.props.currentUserId,onCancel:this._onCancelEdit,onRemove:this._removeMember,onSave:this._onSaveMember,user:this.editUser}));const e=this.props.isManagementActivated?this._onIsEditingId:this._removeMember;return s.createElement("div",{className:"select-profile"},this._renderClose(),s.createElement(ve,{childs:this.props.childList,currentUserId:this.props.hasPreselectedMember?this.props.currentUserId:null,hasNoChildAccountSelected:this.props.hasNoChildAccountSelected,hasParent:this.props.hasParent,isManagementActivated:this.props.isManagementActivated,offerActive:this.props.offerActive,isOffline:!this.props.isOnline,onAdd:this._onOpenMemberType,onPick:this._switchToProfile,onEdit:e,remainingAccountsCount:this.props.remainingAccountsCount,userCountry:this.props.userCountry,maxChildren:this.props.maxChildren,offerName:this.props.offerName,displaySuccessProfileChange:this.state.displaySuccessProfileChange}))}_renderAlert(){return s.createElement(s.Fragment,null,this._renderClose(),s.createElement(Ce,{error:this.state.alert||""}))}_getErrorMessage(e){"object"!=typeof e&&(e={});const t=e.payload||{},r=e.message||"";return t.message?t.message:r}_isSameUserById(e){return isNaN(e)||Number(e)===this.props.currentUserId}}Oe.defaultProps={isManagementActivated:!0,redirectLink:"/",hasPreselectedMember:!0,allowScreenClose:!0,maxChildren:0};const xe={closeModal:u.Oo,openScreen:w.J2,createChildAccount:p.SC,deleteFamilyMember:p.MZ,unlinkFamilyMember:p.So,fetchChildAccount:p.C9,updateFamilySubProfile:p.tj,updateFamilySubAccount:p.l8,openModal:u.qf,selectChildAccount:p.me,fetchUserData:p.Sk,initializeFeedbacksAction:L.Hq},Te=(0,i.y)((0,n.Ng)((e=>({childListLoaded:Boolean(e.user.child),childList:(0,_.TW)(e.user),currentUserId:(0,_.F6)(e.user),currentUserIsKid:(0,_.zI)(e.user),hasNoChildAccountSelected:(0,_.In)(e.user),hasParent:(0,_.p7)(e.user),maxChildren:e.user.USER.MULTI_ACCOUNT.MAX_CHILDREN,offerActive:e.user.USER.MULTI_ACCOUNT.ACTIVE,userCountry:(0,_.JJ)(e.user),userLang:(0,_.OI)(e.user),remainingAccountsCount:(0,_.KU)(e.user),isOnline:(0,h.sc)(e),offerId:(0,_.id)(e.user),offerName:(0,_.Ck)(e.user)})),xe)(Oe))},zerP:(e,t,r)=>{r.d(t,{$O:()=>h,A$:()=>d,BE:()=>_,Hx:()=>E,PJ:()=>u,iE:()=>p,sR:()=>m}),r("WpbS"),r("/eM8");var s=r("nrKQ"),n=r("1EyH"),i=r("kSUS"),a=r("guCc"),o=r("H9G8"),l=r("5U+Y"),c=r("EYlq");const d=async(e,t=!1)=>{if(e=e.trim(),!(0,n.UC)(e))throw new o.Hf;const r=await s.A.callAsync({method:"deezer.emailCheck",data:{EMAIL:e}});if(!r.domain_validity)throw new o.SY(r.domain);if(r.availability)return t&&r.suggestion?{success:!0,suggestion:r.suggestion}:{success:!0};throw new o.qb},u=(0,i.A)(((e,t,r,s)=>d(e,t).then(r).catch(s)),400),m=e=>{const t=[/.*[A-Z]+.*/,/.*[a-z]+.*/,/.*[0-9]+.*/,/.*[^A-Za-z0-9]+.*/];if([/.*[0-9]+.*/,/.*[a-zA-Z]+.*/,/^.{8,}$/].reduce(((t,r)=>t&&r.test(e)),!0)){const r=t.reduce(((t,r)=>t+(r.test(e)?1:0)),0);return r>3?a.m.STRONG:r>2?a.m.MEDIUM:r>1?a.m.WEAK:a.m.TOO_WEAK}return a.m.TOO_WEAK},_=e=>{if(e!==e.trim())throw new o.RQ;if(e.length>l.K9)throw new o.Ee;if(e.length<l.wz)throw new o.CZ;return!0},p=e=>{if((e=e.trim()).length<l.D6)throw new o.U9;if(e.length>l.d0)throw new o.aS;if((0,n.Sx)(e)||(0,n.BB)(e))throw new o.In;return!0},h=e=>{if("string"==typeof e){if(!/^\d+$/.test(e.toString()))throw new o.vM;e=parseInt(e,10)}if(e<l.fB)throw new o.r_(l.fB);if(e>l.D3)throw new o.vM;return!0},E=e=>{if(0===e.length)throw new o.jQ((0,c.u)("invalid_code"));if(e.length<6)throw new o.jQ((0,c.u)("code_too_short"));if(e.length>6)throw new o.jQ((0,c.u)("code_too_long"));return!0}}}]);