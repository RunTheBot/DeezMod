"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[9133],{"/YxT":(t,e,i)=>{i.d(e,{z:()=>o});var n=i("+9dH"),s=i("Nlia");const r=["scopes"],o=(t,e,i=" ")=>{const{scopes:o}=e,a=(0,s.A)(e,r),c=o?((t,e=" ")=>"string"==typeof t?t:t.join(e))(o,i):t.scope;return(0,n.A)({},t,a,{scope:c})}},ALjf:(t,e,i)=>{i.r(e),i.d(e,{AppleAuth:()=>k});var n=i("+9dH"),s=i("Nlia"),r=i("/0+J"),o=i("MVPB"),a=i("4OMY"),c=i("/YxT"),l=(0,a.A)("sdkLoadingPromise"),d=(0,a.A)("addAppleSDK");class u{get hasInit(){var t;return void 0!==(null==(t=window.AppleID)?void 0:t.auth)}constructor(t){Object.defineProperty(this,l,{writable:!0,value:null}),this.config=void 0,Object.defineProperty(this,d,{writable:!0,value:(t="apple-jssdk")=>(0,o.A)(this,l)[l]?(0,o.A)(this,l)[l]:document.getElementById(t)?Promise.resolve():((0,o.A)(this,l)[l]=new Promise((e=>{const i=document.createElement("script");i.id=t,i.src="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js",document.head.appendChild(i),i.onload=()=>{e()}})),(0,o.A)(this,l)[l])}),this.signin=t=>AppleID.auth.signIn((0,n.A)({},this.config,t)),this.config={scope:"name email",clientId:"com.deezer.Deezer.client",state:"apple jssdk init state",domain:"",redirectURI:"https://www.deezer.com/applesignin"},t&&this.setConfig(t)}setConfig(t){t.redirectURI||(t.redirectURI=`${location.origin}/applesignin`),this.config=(0,c.z)(this.config,t," ")}init({addScript:t=!0}){var e=this;return(0,r.A)((function*(){t&&(yield(0,o.A)(e,d)[d]()),AppleID.auth.init((0,n.A)({},e.config,{usePopup:!0}))}))()}}var p=i("LZ+A"),h=i("V26n"),A=i("f/uw");let f=function(t){return t.AUTH="apple.auth",t.UNLINK_ACCOUNT="apple.unlinkAccount",t.LINK_ACCOUNT="apple.linkAccount",t}({});class g extends A.q{constructor(t){var e;super(t),e=this,this.connect=function(){var t=(0,r.A)((function*(t){try{return yield e.api.call({method:f.AUTH,data:t})}catch(t){throw(0,h.e)(t)}}));return function(e){return t.apply(this,arguments)}}(),this.unlinkAccount=(0,r.A)((function*(){try{return yield e.api.call({method:f.UNLINK_ACCOUNT,data:{}})}catch(t){throw(0,h.e)(t)}})),this.linkAccount=function(){var t=(0,r.A)((function*(t){try{return yield e.api.call({method:f.LINK_ACCOUNT,data:t})}catch(t){throw(0,h.e)(t)}}));return function(e){return t.apply(this,arguments)}}()}}const v=["grant_type","code"];var m=(0,a.A)("sdk"),y=(0,a.A)("api"),w=(0,a.A)("tokenCache"),I=(0,a.A)("getToken");class k{constructor(t,e){Object.defineProperty(this,I,{value:b}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:void 0}),this.setConfig=t=>{(0,o.A)(this,m)[m].setConfig(t)},this.unlinkAccount=()=>(0,o.A)(this,y)[y].unlinkAccount(),(0,o.A)(this,y)[y]=new g(t),(0,o.A)(this,m)[m]=new u(e)}assertSDKIsInitialized(t){if(!t.hasInit)throw new p.Pw("apple")}buildBlogname(t,e){if(t&&e)return`${t} ${e}`}init({host:t,addScript:e=!0}){return(0,o.A)(this,m)[m].init({addScript:e,host:t})}signin(t={}){var e=this;return(0,r.A)((function*(){let{grant_type:i="authorization_code",code:r}=t,a=(0,s.A)(t,v);e.assertSDKIsInitialized((0,o.A)(e,m)[m]);const c=yield(0,o.A)(e,I)[I]();return(0,o.A)(e,y)[y].connect((0,n.A)({},c,a,{code:null!=r?r:c.code,grant_type:i,domain:(0,o.A)(e,m)[m].config.domain}))}))()}linkAccount(t){var e=this;return(0,r.A)((function*(){e.assertSDKIsInitialized((0,o.A)(e,m)[m]);const i=yield(0,o.A)(e,I)[I]();return yield(0,o.A)(e,y)[y].linkAccount((0,n.A)({},i,t)),!0}))()}}function b(){return _.apply(this,arguments)}function _(){return(_=(0,r.A)((function*(){return(0,o.A)(this,w)[w]?(0,o.A)(this,w)[w]:(0,o.A)(this,m)[m].signin().then((t=>{var e,i;return(0,o.A)(this,w)[w]={identity_token:t.authorization.id_token,code:t.authorization.code,blog_name:this.buildBlogname(null==(e=t.user)?void 0:e.name.firstName,null==(i=t.user)?void 0:i.name.lastName)},(0,o.A)(this,w)[w]}))}))).apply(this,arguments)}},"LZ+A":(t,e,i)=>{i.d(e,{Pw:()=>s,_$:()=>r,fH:()=>o,lR:()=>n});class n extends Error{}class s extends n{constructor(t){super(`You must init ${t} sdk before using it`)}}class r extends n{constructor(t){super(t.message),this.payload=void 0,this.response=void 0,this.name=t.name,this.response=t.response,this.payload=t.payload}}class o extends Error{constructor(...t){super(...t),this.message="popup_closed_by_user"}}},V26n:(t,e,i)=>{i.d(e,{e:()=>s});var n=i("LZ+A");const s=t=>new n._$(t)},"f/uw":(t,e,i)=>{i.d(e,{q:()=>n});class n{constructor(t){this.api=void 0,this.api=t}}}}]);