"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[7960],{"1EyH":(e,t,a)=>{a.d(t,{BB:()=>r,Sx:()=>n,UC:()=>s});const n=e=>/[\u2000-\u2BFF]/.test(e),r=e=>/[\u{10000}-\u{10FFFF}]/u.test(e),s=e=>!!e.match(/^[_0-9a-z-+]+[_.0-9a-z-+]*@([0-9a-z-]+\.)+[a-z]{2,13}$/i)},"6vRd":(e,t,a)=>{a.d(t,{K:()=>c,r:()=>o}),a("/eM8"),a("EV0h"),a("gS5K");var n=a("nrKQ"),r=a("Vd8Q"),s=a("Wp0Y"),i=a("fkXJ");const l=`//${r.default.get("host_website_ssl")}/profile/me`,o=async(e,t,a)=>{const r=await n.A.callAsync({method:"libraryimport.getTMMAccessToken",data:{}}).catch((e=>{throw e})),s=await fetch("https://www.tunemymusic.com/api/AuthenticateUser.php",{method:"POST",cache:"default",body:JSON.stringify({deezer_access_token:r,deezer_user_id:e,deezer_user_name:t,deezer_redirect_url:a?"deezer://reload":l})}).catch((e=>{throw e}));if(!s.ok||200!==s.status)throw new Error("TMM: response error");const i=await s.json().catch((e=>{throw e}));try{const e=new URL(i.migration_url);return e.searchParams.append("mode","deezer"),e.href}catch(e){throw new Error("TMM: migration url not valid")}},c=()=>{(0,i.A)({body:(0,s.AP)("libraryimporterdismiss_text_transferstillavailableinsettings_web")}),n.A.callAsync({method:"libraryimport.flagTMMAsDismissed"}).catch((e=>{throw e}))}},"86Vu":(e,t,a)=>{a.r(t),a.d(t,{default:()=>Kt});var n,r,s=a("q1tI"),i=a("nrKQ"),l=a("X6oL"),o=a("TRpf"),c=a("Ty5D"),d=a("Wp0Y"),u=a("Vd8Q"),p=a("xobL"),m=a("FSqQ"),h=a("MTsA"),g=a("y8BT"),_=(a("/eM8"),a("D9nb")),E=a("eOc8"),A=a("6jI4"),b=a("TDRX"),v=a("pVdW"),f=a("y7xR"),y=a("HmE0"),w=a("80JK"),S=a("8WIx"),P=a("XkdG"),C=a("NgX8"),D=a("SYyZ"),x=a("GHTP"),k=a("YIja"),T=a("mbHV");const N=({title:e,children:t,...a})=>s.createElement(b.a,a,s.createElement(f.D,{as:"h2",variant:"heading.l"},e),n||(n=s.createElement(A.c,{mt:"spacing.m",mb:"spacing.l"})),t),I=({title:e,children:t,...a})=>s.createElement(b.a,a,s.createElement(f.D,{as:"h3",variant:"heading.m"},e),r||(r=s.createElement(A.c,{mt:"spacing.m",mb:"spacing.l"})),t);I.defaultProps={maxW:"container.sm",mx:"auto",w:"100%"};var R=a("TqF5");const L=({requestStatus:e,email:t,onUpdateStatus:a})=>{const n=(0,o.wA)(),r=e=>e?e.available&&null!=e&&e.requested?(0,d.AP)("requestmydatamessage_text_alreadyrequestedwaitXdays_web",{sprintf:[30],count:30}):null!=e&&e.requested&&!e.available?(0,d.AP)("requestmydatamessage_text_alreadysentandbeingprocessed_web"):void 0:"";return s.createElement(C.m,{label:r(e),"aria-label":r(e)},s.createElement(y.$n,{variant:"outline",onClick:()=>n((0,R.qf)({name:"REQUEST_MY_DATA",props:{email:t,cb:a}})),isDisabled:Boolean(e&&e.requested)},(0,d.AP)("settingspage_title_mypersonaldata_web")))};var M=a("H/eQ"),U=a("tZCQ"),O=a("pxP/"),q=a("Vsul"),F=a("Jpjb"),z=a("exUT"),B=a("WLHJ"),V=a("p1TQ"),G=a("PbG0");const W=e=>({method:B.K.APPLE,...e});var K=a("WrS5"),j=a("WKgy"),$=a("rVxF"),H=a("IZLt");const X=(0,V.e7)("apple"),J=()=>{if(!X.apple)throw new Error("LegacyAuth - Apple not found, have you called init with apple as a param?");return X.apple},Q=async()=>{try{const e=await J().unlinkAccount();(0,V.s5)(e)}catch(t){var e;(0,V.kL)(t,W({intent:G.d6.Link})),"user_using_apple_email"===t.response.error.DATA_ERROR&&(j.A.dispatch((0,R.Oo)()),j.A.dispatch((0,R.qf)({name:K.b.THIRD_PARTY_CONFIRM_APPLE_UNLINK,size:"small",props:{email:t.response.payload.email,method:B.K.APPLE,confirmCallback:Q}})));const a=t;new H.A({error:null!==(e=a.message)&&void 0!==e?e:a.name,journey_type:"unlink-apple",gateway_method:"apple.unlinkAccount",server_payload:a}).send()}};var ee=a("fkXJ"),te=a("aHAS"),ae=a("QOhT"),ne=a("K5vB"),re=a("ZUSG"),se=a("2Av+"),ie=a("Ae9q"),le=a("JlHZ"),oe=a("lASK"),ce=a("+9dH"),de=a("PBDT"),ue=a("ZDlI");const pe=({children:e})=>{const t=U.A.isAllowed("revamp2023")?{border:"solid 1px",borderColor:"border.neutral.primary.default"}:{shadow:"lg"};return s.createElement(de.o,{w:"100%",h:"100%",p:"spacing.xl"},s.createElement(ue.m,(0,ce.A)({background:"background.neutral.secondary.default",borderRadius:"lg",maxW:"container.lg",padding:"spacing.xl"},t),e))},me=({range:e,start:t=1,type:a,onChange:n,value:r})=>s.createElement(T.l,{id:`birthday-${a}`,w:"100%",onChange:n,value:r},Array.from(Array(e).keys()).map((e=>(e+=t,s.createElement("option",{key:`${a}-${e}`,value:e},e))))),he=(e,t)=>new Date(e,t,0).getDate(),ge=({initialDate:e,onChange:t})=>{var a,n,r;const[i,l,o]=e?e.split("-"):[],[c,u]=(0,s.useState)(null!==(a=parseInt(o,10))&&void 0!==a?a:1),[p,m]=(0,s.useState)(null!==(n=parseInt(l,10))&&void 0!==n?n:1),[h,g]=(0,s.useState)(null!==(r=parseInt(i,10))&&void 0!==r?r:1900),_=e=>a=>{const n={day:c,month:p,year:h};n[e]=parseInt(a.target.value,10);const r=he(n.year,n.month);n.day>r&&(n.day=r),u(n.day),m(n.month),g(n.year);const s=`${n.year}-${n.month}-${n.day}`;t(s)};return s.createElement(E.B,{direction:"row",alignItems:"center",w:"100%"},s.createElement(w.MJ,null,s.createElement(S.l,{htmlFor:"birthday-day"},(0,d.AP)("Date de naissance")),s.createElement(E.B,{direction:"row",alignItems:"center",w:"100%"},s.createElement(me,{type:"day",range:he(h,p),onChange:_("day"),value:c}),s.createElement(me,{type:"month",range:12,onChange:_("month"),value:p}),s.createElement(me,{type:"year",start:1900,range:(new Date).getFullYear()-1900,onChange:_("year"),value:h}))))};var _e,Ee,Ae,be,ve,fe,ye,we,Se,Pe=a("hz5U"),Ce=a("QKMO"),De=a("1EyH"),xe=a("3nMj"),ke=a("G04z");const Te=(0,_.B)(E.B);Te.defaultProps={alignItems:"center",direction:"column",mx:"auto",spacing:"spacing.xl",w:"100%"};let Ne=(0,l.Ay)()(_e=class extends s.Component{constructor(e){super(e),this.state={mail:e.userEmail,picture:e.data.USER_DATA.USER_PICTURE,confirmUpdate:!1,errorPayload:null,requestStatus:null},this._dayRef=s.createRef(),this._monthRef=s.createRef(),this._yearRef=s.createRef(),this._blogNameRef=s.createRef(),this._languageRef=s.createRef(),this._onSave=this._onSave.bind(this),this._onChangePicture=this._onChangePicture.bind(this),this._openConsentModal=this._openConsentModal.bind(this),this._onToggleFacebook=this._onToggleFacebook.bind(this),this._onToggleGoogle=this._onToggleGoogle.bind(this),this._onToggleApple=this._onToggleApple.bind(this),this._onUserRequestData=this._onUserRequestData.bind(this),this._onRequestData=this._onRequestData.bind(this)}componentDidMount(){M.A.subscribe(M.A.user.updatePicture,this._onChangePicture),i.A.call({method:"user.getDataExportStatus",data:{USER_ID:this.props.userID},success:e=>{this.setState({requestStatus:e})},catch:()=>{this.setState({requestStatus:{requested:!1,available:!1}})}})}componentWillUnmount(){i.A.cancel(this._fetchApiRef),M.A.unsubscribe(M.A.user.updatePicture,this._onChangePicture)}render(){return s.createElement(pe,null,s.createElement(N,{title:(0,d.AP)("Mes informations")},s.createElement(E.B,{direction:"column",maxW:"container.sm",mx:"auto",spacing:"spacing.xl",w:"100%"},this._renderSubscription(),this._renderCredentials(),this._renderProfileMigration(),this._renderLinkAccount(),this._renderPublicInformations(),this._renderPrivateInformations(),this._renderMessage())),!this.props.isSubProfile&&(Ee||(Ee=s.createElement(A.c,{mt:"spacing.m",mb:"spacing.l"}))),!1)}_renderSubscription(){const{MANAGE_SUBSCRIPTION:e,OFFER_NAME:t}=this.props.data;let a;if(this.props.hasParent){const e=this.props.isSubAccount?(0,d.AP)("deezerfamilyprofilemigration_text_yourindependentaccountpartofuserXplanX_web",{sprintf:[t,this._getParentName()]}):(0,d.AP)("Votre profil est rattaché au compte de %s.",{sprintf:[this._getParentName()]});a=s.createElement(b.a,{color:"text.neutral.secondary.default",fontSize:"sm"},s.createElement(v.E,{"data-testid":"offer-name",textAlign:"center"},t),s.createElement(v.E,{textAlign:"center"},e))}else{const e=(0,d.AP)("planrenaming_text_youreenjoyingplanX_web",{sprintf:["free"===t?(0,d.AP)("deezerplans_title_deezerfree_web"):t]});a=s.createElement(v.E,{fontSize:"sm",textAlign:"center",color:"text.neutral.secondary.default","data-testid":"offer-name"},e)}return s.createElement(E.B,{direction:"column",spacing:"spacing.xl",alignItems:"center"},s.createElement(b.a,{borderRadius:"full",overflow:"hidden",flex:"none"},s.createElement(ne.AG,{value:{onSuccess:this._onChangePicture,onError:this._onChangePictureError}},s.createElement(ae.A,{id:this.props.userID,type:"user",imgSrc:Pe.A.getImageSrc("user",this.state.picture,125,125),bordered:!1,forceImmediateUpload:!0,width:125,height:125,uploadCover:"on",coverLink:!1,alt:this.props.userName}))),s.createElement(E.B,{direction:"column"},s.createElement(f.D,{as:"h3",variant:"heading.l",textAlign:"center"},this.props.data.USER_DATA.BLOG_NAME),a),!this.props.hasParent&&e&&s.createElement(y.$n,{variant:"outline",onClick:this._onOpenSubscription},(0,d.AP)("Gérer mon abonnement")))}_renderCredentials(){return this.props.hasParent&&!this.props.isSubAccount||!this.props.userEmail?null:s.createElement(I,{title:(0,d.AP)("Connexion"),className:"account-credentials"},s.createElement(Te,null,s.createElement(w.MJ,null,s.createElement(S.l,null,(0,d.AP)("Votre E-mail :")),s.createElement(E.B,{direction:"row",alignItems:"center"},s.createElement(P.p,{value:this.state.mail,isDisabled:!0,w:"100%"}),!U.A.isAllowed("disable_change_email")&&s.createElement(C.m,{label:(0,d.AP)("Modifier"),"aria-label":(0,d.AP)("Modifier")},s.createElement(y.K0,{variant:"outline","aria-label":(0,d.AP)("Modifier"),onClick:this._onOpenModal.bind(this,"mail"),icon:Ae||(Ae=s.createElement(re.r,null))})))),s.createElement(w.MJ,null,s.createElement(S.l,null,(0,d.AP)("Votre mot de passe :")),s.createElement(E.B,{direction:"row",alignItems:"center"},be||(be=s.createElement(P.p,{isDisabled:!0,w:"100%",value:"*****"})),!U.A.isAllowed("disable_change_password")&&s.createElement(C.m,{label:(0,d.AP)("Modifier"),"aria-label":(0,d.AP)("Modifier")},s.createElement(y.K0,{variant:"outline","aria-label":(0,d.AP)("Modifier"),onClick:this._onOpenModal.bind(this,"pwd"),icon:ve||(ve=s.createElement(re.r,null))}))))))}_renderLinkAccount(){return this.props.isSubProfile,null}_renderProfileMigration(){return this.props.isSubProfileMigrationAllowed,null}_renderConnectAction(){const{userFacebookId:e,userGoogleId:t,userAppleId:a}=this.props,n=e?(0,d.AP)("generic_action_unlinksocialaccountX_web",{sprintf:["Facebook"]}):(0,d.AP)("generic_action_connectwithsocialaccountX_web",{sprintf:["Facebook"]}),r=t?(0,d.AP)("generic_action_unlinksocialaccountX_web",{sprintf:["Google"]}):(0,d.AP)("generic_action_connectwithsocialaccountX_web",{sprintf:["Google"]}),i=a?(0,d.AP)("generic_action_unlinksocialaccountX_web",{sprintf:["Apple"]}):(0,d.AP)("generic_action_connectwithsocialaccountX_web",{sprintf:["Apple"]});return s.createElement(E.B,{alignItems:"center",direction:"row",mx:"auto",spacing:"spacing.m"},s.createElement(E.B,{direction:"column",spacing:"spacing.m",alignItems:"center"},s.createElement(v.E,{variant:"body.m.default"},n),s.createElement(y.K0,{variant:"outline","aria-label":n,icon:fe||(fe=s.createElement(se.i,null)),onClick:this._onToggleFacebook})),s.createElement(E.B,{direction:"column",spacing:"spacing.m",alignItems:"center"},s.createElement(v.E,{variant:"body.m.default"},r),s.createElement(y.K0,{variant:"outline","aria-label":r,icon:ye||(ye=s.createElement(ie.N,null)),onClick:this._onToggleGoogle})),s.createElement(E.B,{direction:"column",spacing:"spacing.m",alignItems:"center"},s.createElement(v.E,{variant:"body.m.default"},i),s.createElement(y.K0,{variant:"outline","aria-label":i,icon:we||(we=s.createElement(le.Y,null)),onClick:this._onToggleApple})))}_renderPublicInformations(){return s.createElement(I,{title:(0,d.AP)("Informations Deezer visibles par les internautes"),className:"account-public"},s.createElement(Te,null,s.createElement(w.MJ,null,s.createElement(S.l,{htmlFor:"sexe_m",mb:"3"},U.A.isAllowed("gender_nonbinary")?(0,d.AP)("genderscreen_title_iidentifyas_web"):(0,d.AP)("Genre")),s.createElement(D.z,{defaultValue:this.props.data.USER_DATA.SEX},s.createElement(E.B,{direction:"row",alignItems:"center",spacing:"6"},s.createElement("label",{htmlFor:"sexe_m"},s.createElement(x.s,{id:"sexe_m",name:"sex",value:"M",type:"radio"},(0,d.AP)("genderoption_text_male_web"))),s.createElement("label",{htmlFor:"sexe_f"},s.createElement(x.s,{id:"sexe_f",name:"sex",value:"F",type:"radio"},(0,d.AP)("genderoption_text_female_web"))),U.A.isAllowed("gender_nonbinary")&&s.createElement("label",{htmlFor:"sexe_nb"},s.createElement(x.s,{id:"sexe_nb",name:"sex",value:"NonBinary",type:"radio"},(0,d.AP)("genderoption_text_nonbinary_web")))))),s.createElement(w.MJ,null,s.createElement(S.l,{htmlFor:"blog_name"},(0,d.AP)("Pseudo")),s.createElement(P.p,{id:"blog_name",name:"blog_name",ref:this._blogNameRef,type:"text",defaultValue:this.props.data.USER_DATA.BLOG_NAME,w:"100%"}))))}_renderPrivateInformations(){var e,t;return s.createElement(s.Fragment,null,s.createElement(I,{title:(0,d.AP)("Informations privées"),className:"account-private"},s.createElement(Te,null,s.createElement(E.B,{direction:"row"},!this.props.isKid&&s.createElement(y.$n,{variant:"outline",onClick:this._openConsentModal},(0,d.AP)("trackingconsent_action_opensettings_web")),s.createElement(L,{requestStatus:this.state.requestStatus,email:this.state.mail,onUpdateStatus:this._onUserRequestData})),s.createElement(ge,{initialDate:this.props.data.USER_DATA.BIRTHDAY,onChange:e=>this.setState({date:e})}),null,s.createElement(b.a,null,s.createElement(y.$n,{onClick:this._onSave},(0,d.AP)("Enregistrer"))))),(null===(e=this.state.requestStatus)||void 0===e?void 0:e.available)&&s.createElement(I,{title:(0,d.AP)("requestmydatasettings_text_downloaddescription_web",{sprintf:[(0,xe.A)(null===(t=this.state)||void 0===t||null===(t=t.requestStatus)||void 0===t?void 0:t.created_at,{},30)]})},s.createElement(b.a,null,s.createElement(y.$n,{variant:"outline",leftIcon:Se||(Se=s.createElement(oe.m,null)),onClick:this._onRequestData},(0,d.AP)("Télécharger")))))}_renderMessage(){if(!this.state.confirmUpdate)return null;let e,t;switch(this.state.confirmUpdate){case"success":t="success",e=(0,d.AP)("Vos données ont été mises à jour.");break;case"min_legal_age":t="error",e=(0,d.WI)("formerrormessage_text_accountcreationagerestriction_web","formerrormessage_text_accountcreationagerestriction_web",{sprintf:[this.state.errorPayload.age],count:this.state.errorPayload.age});break;case"blogname_not_valid":case"no_emoji_blogname":t="error",e=(0,d.AP)("errormessage_text_usernamecannotcontainsemojis_web");break;case"pwd_updated":t="success",e=(0,d.AP)("Votre mot de passe a été modifié avec succès.");break;case"email_updated":t="success",e=(0,d.AP)("Votre adresse email a été mise à jour.");break;default:t="error",e=(0,d.AP)("Vos données n'ont pas été mises à jour.")}return s.createElement(k.N,{status:t},e)}_renderSelectLanguage(){for(var e=[],t=this.props.data.LANGUAGES,a=0,n=t.length;a<n;a++)e.push(s.createElement("option",{key:a,value:t[a].code},t[a].label));return s.createElement(T.l,{id:"language",ref:this._languageRef,defaultValue:this.props.userLang,w:"100%"},e)}_renderSelectDate(e){const t=this._yearRef.current?this._yearRef.current.value:1900,a=this._monthRef.current?this._monthRef.current.value:1;for(var n={day:{start:1,end:new Date(t,a,0).getDate()},month:{start:1,end:12},year:{start:1900,end:(new Date).getFullYear()-1}},[r,i,l]=this.props.data.USER_DATA.BIRTHDAY.split("-"),o={year:r,month:i,day:l},c=[],d=n[e].start,u=n[e].end;d<=u;d++)c.push(s.createElement("option",{key:d,value:(0,Ce.A)(d,2)},(0,Ce.A)(d,2)));return s.createElement(T.l,{id:"birthday",ref:this[`_${e}Ref`],defaultValue:o[e],w:"100%"},c)}_onSave(){const{valid:e,errorCode:t}=this._verifyFormFields();if(!e)return void this.setState({confirmUpdate:t,errorPayload:t});const a=document.querySelector('input[name="sex"]:checked')?document.querySelector('input[name="sex"]:checked').value:"",n=this._languageRef.current?this._languageRef.current.value.trim():"",r=n&&n!==this.props.userLang,s={USER_DATA:{}};this.state.date&&(s.USER_DATA.BIRTHDAY=this.state.date),a.length>0&&a!==this.props.data.USER_DATA.SEX&&(s.USER_DATA.SEX=a),this._blogNameRef.current.value.trim()&&this._blogNameRef.current.value.trim()!==this.props.userName&&(s.USER_DATA.BLOG_NAME=this._blogNameRef.current.value.trim()),r&&(s.LANG=n),this._fetchApiRef=i.A.call({method:"user.update",data:s,success:e=>{r&&(O.A.href=`/lang?lang=${n}&redirect=/account`),this.props.updateUserName(this._blogNameRef.current.value.trim()),this.setState({confirmUpdate:e?"success":"error"})},error:e=>{var t;new H.A({error:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:null==e?void 0:e.name,journey_type:"update-user-infos",gateway_method:"user.update",server_payload:e}).send(),this.setState({confirmUpdate:e.message||"error",errorPayload:e.payload||null})}})}_onToggleFacebook(){if(!this.props.userFacebookId)return z.A.linkAccount({profile_migration:this.props.isSubProfile}),void this._onLogMigration("facebook");z.A.unlinkAccount({profile_migration:this.props.isSubProfile})}_onToggleGoogle(){if(!this.props.userGoogleId)return this._onLogMigration("google"),void F.A.linkAccount({profile_migration:this.props.isSubProfile});F.A.unlinkAccount()}_onToggleApple(){if(!this.props.userAppleId)return this._onLogMigration("apple"),void(async e=>{try{const t=await J().linkAccount(e);(0,V.V7)(t,null==e?void 0:e.profile_migration)}catch(r){var t,a,n;(0,$.O)(r)&&((0,V.kL)(new $.A(r),W({intent:G.d6.Link})),new H.A({error:null!==(t=null!==(a=null===(n=r.payload)||void 0===n?void 0:n.status)&&void 0!==a?a:r.message)&&void 0!==t?t:r.name,journey_type:null!=e&&e.profile_migration?"family-convert-independent":"link-apple",gateway_method:"apple.linkAccount",server_payload:r}).send())}})({profile_migration:this.props.isSubProfile});j.A.dispatch((0,R.qf)({name:K.b.THIRD_PARTY_CONFIRM_UNLINK,size:"small",props:{method:B.K.APPLE,confirmCallback:Q}}))}_onLogMigration(e){this.props.isSubProfileMigrationAllowed&&this.props.tracking.trackEvent({eventaction:"convert-independent-account",eventcategory:"family-account-management",event:"click",eventlabel:e})}_onOpenSubscription(){(0,q.A)("/account/subscription")}async _onOpenModal(e){const t=await this._getIsSecuredSessionRequired();"mail"===e&&(null==t?void 0:t.change_email)||"pwd"===e&&(null==t?void 0:t.change_password)?this._openCodeRequest(e):this._openCredentialsUpdate(e),"mail"===e&&M.A.subscribeOnce(M.A.user.updateEmail,((e,t)=>{this.setState({mail:t.email,confirmUpdate:"email_updated"}),(0,ke.u)().identify({email:t.email})})),"pwd"===e&&M.A.subscribeOnce(M.A.user.updatePassword,(()=>{this.setState({confirmUpdate:"pwd_updated"})}))}_getIsSecuredSessionRequired(){return new Promise(((e,t)=>{i.A.call({method:"user.isSecuredSessionRequired",data:{USER_ID:this.props.userID},success:t=>{e(t)},error:e=>{t(e)}})}))}_downloadData(){i.A.call({method:"user.getDataExportLink",success:e=>{e.link&&window.open(e.link)},catch:e=>{var t;new H.A({error:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:null==e?void 0:e.name,journey_type:"request-data-download",gateway_method:"user.getDataExportLink",server_payload:null==e?void 0:e.response}).send(),(0,ee.A)({body:(0,d.AP)("errormessage_text_anerroroccurredpleasetryagain_web")})}})}async _onRequestData(){const e=await this._getIsSecuredSessionRequired();null!=e&&e.data_request?this._openCodeRequest("dl_data",this._downloadData):this._downloadData()}_onUserRequestData(){this.setState({requestStatus:{requested:!0,available:!1}})}_onChangePicture(e){this.setState({picture:e}),this.props.updateUserPicture(e)}_onChangePictureError(){(0,ee.A)({body:(0,d.AP)("Une erreur est survenue, merci de réessayer plus tard.")})}_verifyFormFields(){let e,t=!0;const a=this._blogNameRef.current.value.trim();return((0,De.Sx)(a)||(0,De.BB)(a))&&(t=!1,e="no_emoji_blogname"),{valid:t,errorCode:e}}_openCodeRequest(e,t){this.props.openModal({name:"CODE_REQUEST",props:{email:this.state.mail,requestType:e,...t&&{cb:t}},size:"small"})}_openCredentialsUpdate(e){this.props.openModal({name:"mail"===e?"UPDATE_EMAIL":"UPDATE_PASSWORD",size:"small"})}_getParentName(){return""===this.props.data.PARENT_USER_DATA.FIRSTNAME&&""===this.props.data.PARENT_USER_DATA.LASTNAME?this.props.data.PARENT_USER_DATA.BLOG_NAME:`${this.props.data.PARENT_USER_DATA.FIRSTNAME} ${this.props.data.PARENT_USER_DATA.LASTNAME}`}_openConsentModal(){window.consentScreenApi&&window.consentScreenApi.openPreferences(3,"purposes")}})||_e;const Ie=(0,o.Ng)((({user:e})=>({userEmail:(0,p.hS)(e),userID:e.id,userLang:e.SETTING_LANG,userName:(0,p.Mn)(e),userFacebookId:(0,p.$u)(e),userGoogleId:(0,p.md)(e),userAppleId:(0,p.NK)(e),isKid:(0,p.zI)(e),hasParent:(0,p.p7)(e),isSubAccount:(0,p.m0)(e),isSubProfile:(0,p.W$)(e),isSubProfileMigrationAllowed:(0,p.Q6)(e)})),{openModal:R.qf,closeModal:R.Oo,updateUserPicture:te.Ff,updateUserName:te.Km})(Ne);var Re=a("PF77");class Le extends s.Component{constructor(...e){super(...e),this.state={updatedOptin:null,showNotif:!1}}render(){return s.createElement(pe,null,s.createElement(E.B,{direction:"column",spacing:"spacing.xl",className:"account-wrapper"},this._renderSocial(),this._renderSettings()))}_renderSocial(){return null}_renderSettings(){return s.createElement(N,{title:(0,d.AP)("Je souhaite :")},s.createElement(E.B,{as:"form",direction:"column",className:"form-horizontal"},s.createElement(Re.S,{isChecked:!this.props.userSettings.global.social,onChange:this._onChangeSetting.bind(this,"global","social"),isDisabled:this.props.isKid,size:"sm"},this.props.data.USER_SETTINGS_LABEL.global.social),this._renderPopupUnload()))}_renderPopupUnload(){return null}async _onChangeSetting(e,t,a){a.preventDefault();const n=!this.props.userSettings[e][t];await this.props.updateSettings({[e]:{[t]:Number(n)}})}}const Me=(0,o.Ng)((({user:e})=>({userSettings:e.USER.SETTING,isKid:(0,p.zI)(e)})),{updateSettings:te.Xx})(Le);var Ge,Ue=a("QqEF"),Oe=a("TnRy"),qe=a("LmGy"),Fe=a("wAmb"),ze=a("Qx5r"),Be=a("g1Fm"),Ve=a("Caim");const We={"device_android_mobile.png":a.p+"images/device/device_android_mobile.ab12a24585dea551e56d.png","device_android_tablet.png":a.p+"images/device/device_android_tablet.20bf3a3be0d8bd4ce72d.png","device_ipad.png":a.p+"images/device/device_ipad.0e255db9c2d9a4aeba29.png","device_iphone.png":a.p+"images/device/device_iphone.0df04eb92efd7e29338c.png"};class Ke extends s.Component{constructor(...e){super(...e),this.state={deletedDevices:[]}}componentWillUnmount(){i.A.cancel(this._fetchApiRef)}get devices(){return(this.props.data.USER_DEVICE_SERIALS?this.props.data.USER_DEVICE_SERIALS.data:[]).filter((e=>!this.state.deletedDevices.includes(e.USER_DEVICE_SERIAL_ID)))}render(){return s.createElement(pe,null,0===this.devices.length?this._renderPlaceholder():this._renderDevice())}_renderPlaceholder(){return s.createElement(E.B,{direction:"column"},s.createElement(v.E,{fontSize:"sm"},(0,d.AP)("Vous n'avez actuellement aucun appareil connecté à ce compte.")),s.createElement(v.E,{color:"text.neutral.secondary.default",fontSize:"xs"},(0,d.AP)("Pour en ajouter un, connectez-vous avec votre appareil sur l'application Deezer.")))}_renderDevice(){return s.createElement("div",null,s.createElement(N,{title:(0,d.AP)("Votre compte Deezer est actuellement relié aux appareils suivants :")},s.createElement(Ue.X,null,s.createElement(Oe.N,null,this.devices.map(((e,t)=>{if(t>=this.props.data.MAX_NB_DEVICES)return null;let a=e.DEVICE_NAME?(0,Be.A)(e.DEVICE_NAME):(0,Be.A)(e.NAME);e.DEVICE_OS&&(a+=` - ${e.DEVICE_OS}`);const n=(0,Ve.A)(new Date(e.DATE.replace(" ","T")).getTime()/1e3,!0,"/",!1),r=e.LAST_CONNECTION?`${(0,d.AP)("Dernière connexion")} ${(0,Ve.A)(new Date(e.LAST_CONNECTION.replace(" ","T")).getTime()/1e3,!0,"/",!1)}`:"";return s.createElement(qe.Tr,{key:e.DEVICE_SERIAL},s.createElement(Fe.Td,null,s.createElement("img",{src:We[e.PICTURE],alt:e.DEVICE_OS})),s.createElement(Fe.Td,null,s.createElement(v.E,{variant:"body.2xs.default"},a),s.createElement(v.E,{variant:"body.2xs.default"},(0,d.AP)("Ajouté le %s",{sprintf:[n]})),s.createElement(v.E,{variant:"body.2xs.default"},r)),s.createElement(Fe.Td,null,s.createElement(C.m,{label:(0,d.AP)("Supprimer l'appareil"),"aria-label":(0,d.AP)("Supprimer l'appareil")},s.createElement(y.K0,{variant:"outline","aria-label":(0,d.AP)("Supprimer l'appareil"),onClick:this._onRemoveDevice.bind(this,e.USER_DEVICE_SERIAL_ID),icon:Ge||(Ge=s.createElement(ze.u,null))}))))}))))),s.createElement(v.E,{pt:"spacing.m",variant:"body.2xs.default",className:"device-limit",dangerouslySetInnerHTML:{__html:(0,d.WI)("Votre compte Deezer ne peut être relié qu'à un seul appareil.","Votre compte Deezer peut être relié à %s appareils maximum.",{sprintf:['<strong class="nb-device-limit">'+this.props.data.MAX_NB_DEVICES+"</strong>"],count:this.props.data.MAX_NB_DEVICES})}}))}_onRemoveDevice(e){confirm((0,d.AP)("Voulez-vous réellement supprimer cet appareil ?"))&&(this._fetchApiRef=i.A.call({method:"device.deleteSerial",data:{serial:e},success:t=>{if(t){const{deletedDevices:t}=this.state;this.setState({deletedDevices:[...t,e]})}}}))}}const je=Ke;var $e=a("FVVF"),He=a("CdHq"),Xe=a("LjZa"),Je=a("7sx+"),Qe=a("r2u9");const Ye="UPDATED_IS_OPEN_AT_LOGIN",Ze={isOpenAtLogin:!0,isOpenAsHidden:!1};var et=a("shsj"),tt=a("oh0j"),at=a("G3sm");const nt={updateSetting:te.bB},rt=(0,o.Ng)((({user:e})=>({active:(0,p.AU)(e)})),nt)((e=>{const{active:t,updateSetting:a}=e;return s.createElement("div",{className:"explicit-settings-container"},s.createElement(w.MJ,null,s.createElement(He.s,{alignItems:"center"},s.createElement(S.l,{mb:"0",color:"text.neutral.primary.default"},(0,d.AP)("Notifications de bureau")),s.createElement(tt.d,{className:"setting-input-item",isChecked:t,onChange:()=>a(!t)})),s.createElement(at.e,{fontSize:"xs",mt:0},(0,d.AP)("Afficher une notification sur le bureau lorsqu'un nouveau titre commence."))))}));var st,it=a("CyAC"),lt=a("sAMA"),ot=a("U7Z4");class ct extends s.Component{constructor(e){super(e),this.handleChangeFirstLevel=this.handleChangeFirstLevel.bind(this),this.handleChangeSecondLevel=this.handleChangeSecondLevel.bind(this),this.setExplicitLevel=this.setExplicitLevel.bind(this),this.state={isExplicitToggle:!1}}setExplicitLevel(e,t,a){return{EXPLICIT_CONTENT_LEVEL:e?t:a}}handleChangeFirstLevel(e){this.props.updateUserExplicitLevel(this.setExplicitLevel(e,lt.Nq,lt.Mt)),this.setState({isExplicitToggle:!0})}handleChangeSecondLevel(e){this.props.updateUserExplicitLevel(this.setExplicitLevel(e,lt.g,lt.Nq)),this.setState({isExplicitToggle:!0})}render(){return s.createElement(s.Fragment,null,this._renderFirstLevel(),this._renderSecondLevel(),this._renderToggleInformation())}_renderFirstLevel(){const{userLevel:e,availableLevels:t}=this.props;if(!(0,it.ek)(lt.Mt,t))return null;const a=e!==lt.Mt;return s.createElement("div",{className:"explicit-settings-container"},s.createElement(w.MJ,null,s.createElement(He.s,{alignItems:"center"},s.createElement(S.l,{mb:"0",color:"text.neutral.primary.default"},(0,d.AP)("settingspage_title_donotrecommendexplicitcontent_web")),this._renderCheckbox(a,this.handleChangeFirstLevel)),s.createElement(at.e,{fontSize:"xs",mt:0},(0,d.AP)("settingspage_subtitle_explicitcontentexcludedfromreco_web"))))}_renderSecondLevel(){const{userLevel:e}=this.props;if(e===lt.Mt)return null;const t=e===lt.g;return s.createElement("div",{className:"explicit-settings-container"},s.createElement(w.MJ,null,s.createElement(He.s,{alignItems:"center"},s.createElement(S.l,{mb:"0",color:"text.neutral.primary.default"},(0,d.AP)("settingspage_title_hideexplicitcontent_web")),this._renderCheckbox(t,this.handleChangeSecondLevel)),s.createElement(at.e,{fontSize:"xs",mt:0},(0,d.AP)("settingspage_subtitle_explicitcontentnotrecoplayablesearchable_web"))))}_renderToggleInformation(){const{isExplicitToggle:e}=this.state;return e?s.createElement(ot.Fc,{mt:4,"data-testid":"explicit-update-delay-info"},st||(st=s.createElement(ot._0,null)),s.createElement(ot.TN,null,(0,d.AP)("warningmessage_text_updatemighttakeafewhours_web"))):null}_renderCheckbox(e,t){const{isEditableExplicitLevel:a}=this.props,n=s.createElement(tt.d,{isChecked:e||!a,isDisabled:!a,onChange:e=>{var a;return t(null==e||null===(a=e.target)||void 0===a?void 0:a.checked)}});return a?n:s.createElement(C.m,{label:(0,d.AP)("infomessage_text_explicitcontentturnedoffbyadmin_web",{sprintf:[(0,d.AP)("deezerplans_title_deezerfamily_web")]})},n)}}const dt={updateUserExplicitLevel:te.xf},ut=(0,o.Ng)((e=>({userLevel:(0,p.Uw)(e.user),availableLevels:(0,p.n3)(e.user),isEditableExplicitLevel:(0,p.Kw)(e.user)})),dt)(ct);var pt,mt;const ht=(0,o.Ng)((function(e){return{availableExplicitLevels:(0,p.n3)(e.user)}}))((({availableExplicitLevels:e})=>s.createElement(N,{title:(0,d.AP)("settingspage_title_displaysettings_web")},e.length>0?pt||(pt=s.createElement(ut,null)):null,mt||(mt=s.createElement(rt,null)))));function gt(e,t=2){if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}var _t,Et,At,bt;class vt extends s.Component{constructor(e){super(e),this._clearAll=()=>{Je.default.clear().then((()=>this.getStorageStats()))},this.props.updateData(),this.state={quota:0,usageCache:0,usageDownloaded:0}}async componentDidMount(){await this.getStorageStats()}async getStorageStats(){const{user:e,ua:t}=await Je.default.estimate();this.setState({usageCache:e.usage.cached,usageDownloaded:e.usage.persisted,quota:t?t.quota:e.quota})}render(){return s.createElement(pe,null,s.createElement($e.T,{spacing:"spacing.xl",alignItems:"flex-start"},this._renderCache(),_t||(_t=s.createElement(ht,null)),this._renderOtherSettings()))}_renderCache(){const e=Math.max(Math.round(this.state.usageCache/this.state.quota*100)||0,0),t=Math.max(Math.round(this.state.usageDownloaded/this.state.quota*100)||0,0);return s.createElement(N,{title:(0,d.AP)("settings_title_diskusage_web")},s.createElement($e.T,{spacing:"spacing.l"},s.createElement("div",{className:"progress progress-bar-origin"},s.createElement("div",{className:"progress-bar progress-bar-cache",role:"progressbar",style:{width:e+"%"},"aria-valuenow":e,"aria-valuemin":"0","aria-valuemax":"100"}),s.createElement("div",{className:"progress-bar progress-bar-downloads",role:"progressbar",style:{width:t+"%"},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})),s.createElement("table",null,s.createElement("tbody",null,s.createElement("tr",null,Et||(Et=s.createElement("td",{className:"setting-legend-cell"},s.createElement("div",{className:"progress-bar-cache progress-bar-legend"}))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-label"},(0,d.AP)("Smart Cache"))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-used setting-input"},gt(Math.max(this.state.usageCache||0,0))))),s.createElement("tr",null,At||(At=s.createElement("td",{className:"setting-legend-cell"},s.createElement("div",{className:"progress-bar-downloads progress-bar-legend"}))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-label"},(0,d.AP)("desktopapp_title_downloads_web"))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-used setting-input"},gt(Math.max(this.state.usageDownloaded||0,0))))),s.createElement("tr",null,bt||(bt=s.createElement("td",{className:"setting-legend-cell"},s.createElement("div",{className:"progress-bar-origin progress-bar-legend"}))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-label"},(0,d.AP)("diskusage_title_available_web"))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-used setting-input"},gt(Math.max(this.state.quota-(this.state.usageCache+this.state.usageDownloaded)||0,0))))))),s.createElement("div",{className:"setting-action"},s.createElement("div",{className:"setting-action-item"},s.createElement(y.$n,{onClick:this._clearAll},(0,d.AP)("diskusage_action_clearall_web"))))))}_renderOtherSettings(){const{isOpenAtLogin:e}=this.props;return s.createElement(N,{title:(0,d.AP)("Autre")},s.createElement(w.MJ,null,s.createElement(He.s,{alignItems:"center"},s.createElement(S.l,null,(0,d.AP)("Lancer Deezer au démarrage")),s.createElement(tt.d,{className:"setting-input-item",isChecked:e,onChange:()=>this.props.setOpenAtLogin(!e)}))))}}vt.defaultProps={cachePath:null,setCachePath:Xe.A},j.A.addReducers({electronSettings:function(e=Ze,t={}){switch(t.type){case Ye:return{...e,isOpenAtLogin:t.isOpenAtLogin};case"UPDATED_IS_OPEN_AS_HIDDEN":return{...e,isOpenAsHidden:t.isOpenAsHidden};default:return e}}});const ft={setOpenAtLogin:e=>t=>{Qe.Ay.setAutoStart(e),t({type:Ye,isOpenAtLogin:e})},updateData:()=>e=>{e({type:Ye,isOpenAtLogin:Qe.Ay.isOpenAtLogin()})}},yt=(0,o.Ng)((({electronSettings:e,cache:t})=>({cached:(0,et.oC)(t),isOpenAtLogin:e.isOpenAtLogin,isOpenAsHidden:e.isOpenAsHidden})),ft)(vt);var wt;const St=()=>wt||(wt=s.createElement(pe,null,s.createElement(ht,null)));var Pt,Ct=a("tU3/");const Dt=()=>Pt||(Pt=s.createElement(pe,null,s.createElement(Ct.A,null)));a("W8Tb");var xt=a("6EMc"),kt=a("70bL");class Tt extends s.Component{constructor(e){super(e),this.state={currentCountry:e.userRecoCountry},this._handleChange=this._handleChange.bind(this)}render(){return s.createElement(pe,null,s.createElement(N,{title:(0,d.AP)("countryselector_title_countryselector_web")},s.createElement(w.MJ,null,s.createElement(S.l,{htmlFor:"recommendation-country"},(0,d.AP)("countryselector_title_chooseyourcountry_web")),this._renderSelectCountry(),s.createElement(at.e,{fontSize:"xs",mt:4},(0,d.AP)("countryselector_text_chgecountryasoftenasyouwant_web")),s.createElement(at.e,{fontSize:"xs",mt:"0"},(0,d.AP)("countryselector_text_fewhourstoapplychanges_web")))))}_renderSelectCountry(){const{data:e}=this.props,t=e.COUNTRIES||null;if(!Array.isArray(t))return null;t.sort((function(e,t){return(0,xt.A)(e.label.toLowerCase(),t.label.toLowerCase())}));const a=t.map((e=>s.createElement("option",{key:e.code,value:e.code},e.label)));return s.createElement(T.l,{id:"recommendation-country",value:this.state.currentCountry,onChange:this._handleChange,isDisabled:!this.props.isOnline,maxW:"300px"},a)}_handleChange(e){this.setState({currentCountry:e.target.value}),this.props.setRecoCountry(e.target.value).catch((()=>{(0,ee.A)({body:(0,d.AP)("Une erreur est survenue, merci de réessayer plus tard.")}),this._resetCurrentCountry()}))}_resetCurrentCountry(){this.setState({currentCountry:this.props.userRecoCountry})}}const Nt=(0,o.Ng)((e=>({isOnline:(0,kt.sc)(e),userRecoCountry:(0,p.kY)(e)})),{setRecoCountry:te.Iy})(Tt);var It=a("6vRd");const Rt=()=>{const e=(0,o.d4)(kt.sc),[a,n]=s.useState(!1),[r,i]=(0,o.d4)((e=>[(0,p.F6)(e.user),(0,p.Mn)(e.user)]));return s.createElement(pe,null,s.createElement(N,{title:(0,d.AP)("libraryimporter_title_transferyourfavorites_web")},s.createElement(He.s,{justifyContent:"space-between",width:"100%"},s.createElement(v.E,{fontSize:"md"},(0,d.AP)("libraryimporter_text_moveplaylistsandfavoritestodzr_web")),s.createElement(y.$n,{onClick:async()=>{n(!0);const e=await(0,It.r)(r,i,true).catch((()=>(0,ee.A)({body:(0,d.AP)("Une erreur est survenue, merci de réessayer plus tard.")})));e&&open(e),n(!1)},isDisabled:a||!e},(0,Be.A)((0,d.AP)("libraryimporter_action_selectaserviceUPP_web"),!0)))))},Lt={apps:"apps",countrySelector:"country_selector",devices:"devices",display:"display",home:"home",notifications:"notifications",settings:"settings",share:"share",libraryTransfer:"transfer"},Mt=[Lt.share,Lt.devices,Lt.apps,Lt.countrySelector,Lt.home];var Ut,Ot,qt,Ft,zt;class Bt extends s.Component{constructor(e){super(e),this._onTabClick=this._onTabClick.bind(this)}render(){return s.createElement("div",{id:"page_account"},s.createElement(h.A,{items:this._getTabList(),active:this.props.tab}),this._renderTabContent())}_renderTabContent(){const{data:e,isFetching:t,tab:a}=this.props;if(t)return Ut||(Ut=s.createElement(m.A,null));switch(a){case Lt.countrySelector:return s.createElement(Nt,{data:e});case Lt.devices:return s.createElement(je,{data:e});case Lt.display:return Ot||(Ot=s.createElement(St,null));case Lt.home:return s.createElement(Ie,{data:e});case Lt.notifications:return s.createElement(Dt,{data:e});case Lt.share:return s.createElement(Me,{data:e});case Lt.settings:return qt||(qt=s.createElement(yt,null));case Lt.libraryTransfer:return Ft||(Ft=s.createElement(Rt,null));default:return zt||(zt=s.createElement(g.A,null))}}_onTabClick(e){if(e.id===Lt.apps)window.open(`https://${u.default.get("host_account")}/apps/`,"_blank");else{const t=e.id===Lt.home?"":"/"+e.id;this.props.history.push("/account"+t)}}_getTabList(){const{userIsKid:e,userOptins:t}=this.props;return[{id:Lt.home,label:(0,d.AP)("Mes informations"),action:this._onTabClick},{id:Lt.notifications,label:(0,d.AP)("optinpreferences_title_notificationpreferences_web"),action:this._onTabClick,disabled:0===t.channel.length||0===t.optin.length},{id:Lt.devices,label:(0,d.AP)("Mes appareils connectés"),action:this._onTabClick},{id:Lt.apps,label:(0,d.AP)("Mes Applications"),action:this._onTabClick,disabled:!0},{id:Lt.display,label:(0,d.AP)("settingspage_title_displaysettings_web"),action:this._onTabClick,disabled:!0},{id:Lt.settings,label:(0,d.AP)("Paramètres de l'application"),action:this._onTabClick,disabled:!1},{id:Lt.share,label:(0,d.AP)("optinpreferences_title_sharingpreferences_web"),action:this._onTabClick},{id:Lt.countrySelector,label:(0,d.AP)("countryselector_title_countryselector_web"),action:this._onTabClick},{id:Lt.libraryTransfer,label:(0,d.AP)("libraryimporter_title_transferyourfavorites_web"),action:this._onTabClick,disabled:e}]}}Bt.defaultProps={data:null};const Vt=(0,c.y)((0,o.Ng)((e=>({userIsKid:(0,p.zI)(e.user),userOptins:e.user.USER.OPTINS})))(Bt));var Gt,Wt;let Kt=(0,l.Ay)({event:"updatepage",pagename:"account_management",pagecategory:"account_management"})(((Wt=class extends s.Component{constructor(e){super(e),this.state={isFetching:!1,data:e.appState||null,error:null,tab:e.match.params.tab||Lt.home}}static getDerivedStateFromProps(e,t){const a=e.match.params.tab||Lt.home;return a!==t.tab?{data:null,tab:a}:null}componentDidMount(){this.state.data||this._fetchData(this.state.tab)}componentDidUpdate(){this.state.data||this.state.isFetching||this._fetchData(this.state.tab)}componentWillUnmount(){i.A.cancel(this._fetchPageApiRef)}render(){const{data:e,error:t,isFetching:a,tab:n}=this.state;if(t)throw t;return s.createElement(Vt,{data:e,tab:n,isFetching:null===e||a})}_fetchData(e){this._isTabAllowed(e)&&(Mt.includes(e)?(this.setState({isFetching:!0}),this._fetchPageApiRef=i.A.call({method:"deezer.pageAccount",data:{tab:e},success:e=>{this.setState({isFetching:!1,data:e})},error:e=>{this.setState({isFetching:!1,error:e})}})):this.setState({data:{}}))}_isTabAllowed(e){return Object.values(Lt).includes(e)}}).displayName="account",Wt.defaultProps={appState:null},Gt=Wt))||Gt},FSqQ:(e,t,a)=>{a.d(t,{A:()=>i});var n,r=a("q1tI"),s=a("juqV");class i extends r.Component{render(){const{className:e}=this.props;let t=(0,s.A)("loader-container",e);return r.createElement("div",{className:t,"data-testid":"loader"},n||(n=r.createElement("div",{className:"loader animate-spin"})))}}},Jpjb:(e,t,a)=>{a.d(t,{A:()=>_}),a("/eM8");var n=a("WLHJ"),r=a("p1TQ"),s=a("PbG0");const i=e=>({method:n.K.GOOGLE,...e});var l=a("WrS5"),o=a("TqF5"),c=a("WKgy"),d=a("rVxF"),u=a("dgkV"),p=a("IZLt");const m=(0,r.e7)("google"),h=()=>{if(!m.google)throw new Error("LegacyAuth - Google not found, have you called init with google as a param?");return m.google},g=async()=>{try{const e=await h().unlinkAccount();(0,r.s5)(e)}catch(t){var e;const a=t;(0,r.kL)(a,i({intent:s.d6.Link})),new p.A({error:null!==(e=a.message)&&void 0!==e?e:a.name,journey_type:"unlink-google",gateway_method:"google.unlinkAccount",server_payload:a}).send()}},_={login:async(e,t)=>{try{const t=await h().signin(e);(0,r.oj)(t,{redirect:(0,r.Ae)(null==e?void 0:e.redirect),method:s.qR.Google})}catch(l){var a,n;if((0,d.O)(l))new u.A({error:null!==(a=l.message)&&void 0!==a?a:null===(n=l.payload)||void 0===n?void 0:n.status,journey_type:"google",error_message:l.message,gateway_method:"google.auth"}).send(),(0,r.kL)(new d.A(l),i({intent:s.d6.Login,redirect:null==e?void 0:e.redirect}));null==t||t(l)}},signup:async(e,t)=>{try{const t=await h().signin(e);(0,r.oj)(t,{redirect:(0,r.Ae)(null==e?void 0:e.redirect),method:s.qR.Google})}catch(l){var a,n;if((0,d.O)(l))new u.A({error:null!==(a=null===(n=l.payload)||void 0===n?void 0:n.status)&&void 0!==a?a:l.name,journey_type:"google",error_message:l.message,gateway_method:"google.auth"}).send(),(0,r.kL)(new d.A(l),i({intent:s.d6.Login,redirect:null==e?void 0:e.redirect}));null==t||t(l)}},linkAccount:async e=>{try{const t=await h().linkAccount(e);(0,r.V7)(t,null==e?void 0:e.profile_migration)}catch(l){var t,a,n;if((0,d.O)(l))(0,r.kL)(new d.A(l),i({intent:s.d6.Link})),new p.A({error:null!==(t=null!==(a=null===(n=l.payload)||void 0===n?void 0:n.status)&&void 0!==a?a:l.message)&&void 0!==t?t:l.name,journey_type:null!=e&&e.profile_migration?"family-convert-independent":"link-google",gateway_method:"google.linkAccount",server_payload:l}).send()}},unlinkAccount:()=>{c.A.dispatch((0,o.qf)({name:l.b.THIRD_PARTY_CONFIRM_UNLINK,size:"small",props:{method:n.K.GOOGLE,confirmCallback:g}}))}}},MTsA:(e,t,a)=>{a.d(t,{A:()=>m});var n,r,s=a("q1tI"),i=a("juqV"),l=a("Wp0Y"),o=a("H/eQ"),c=a("yCtO"),d=a("GPus"),u=a("pVdW");class p extends s.Component{constructor(e){super(e),this._onClickOutsideDropDown=e=>{this._navbarLinks.contains(e.target)||(this.setState({isOpenDropDown:!1}),document.removeEventListener("click",this._onClickOutsideDropDown))},this._onResize=this._onResize.bind(this),this._onToggleDropDown=this._onToggleDropDown.bind(this),this.state={items:e.items,lastVisibleElementIndex:1/0,isOpenDropDown:!1}}componentDidMount(){this._getTabWidth(),o.A.subscribe(o.A.layout.resize,this._onResize),o.A.subscribe(o.A.layout.adsBackground,this._onResize),o.A.trigger(o.A.navigation.tab_displayed,{type:this.props.active})}UNSAFE_componentWillReceiveProps(e){this.setState({lastVisibleElementIndex:1/0,items:e.items},this._getTabWidth)}componentWillUnmount(){o.A.unsubscribe(o.A.layout.resize,this._onResize),o.A.unsubscribe(o.A.layout.adsBackground,this._onResize)}render(){const e=(0,i.A)({navbar:!0,"navbar-center":"center"===this.props.align});return s.createElement("nav",{className:e},s.createElement("div",{style:this.props.style,className:"container"},s.createElement("ul",{className:"navbar-nav",ref:e=>this._navbarLinks=e,role:"tablist"},this._renderList())))}_renderList(){const e=[],{items:t,lastVisibleElementIndex:a}=this.state;for(let n=0,r=t.length;n<r;n++)if(!t[n].disabled){if(!(n<a)){e.push(this._renderViewMore(n));break}e.push(this._renderItem(n))}return e}_renderItem(e,t=!1){const{active:a,textSize:n}=this.props,r=this.state.items[e],l=(0,i.A)({"navbar-item":!t,"dropdown-item":t,active:a===r.id}),o=r.isButton&&a!==r.id,c=(0,i.A)({"navbar-link":!t,"navbar-button":o}),d=a===r.id?void 0:this._onItemClick.bind(this,r);return s.createElement("li",{key:r.id,className:l},s.createElement(u.E,{as:"a",color:o?"text.accent.onDark.default":"text.neutral.secondary.default",fontWeight:a===r.id?"semibold":"normal",_hover:{color:o?"text.accent.onDark.default":"text.neutral.secondary.hovered"},className:c,role:"tab",tabIndex:"0","aria-selected":a===r.id,onClick:d,onKeyDown:d,"data-testid":`${r.id}-tab`,variant:{large:"body.l.default",medium:"body.m.default"}[n]},r.label))}_renderViewMore(e){const{isOpenDropDown:t,items:a,lastVisibleElementIndex:o}=this.state,p=(0,i.A)("navbar-item","navbar-dropdown",{"dropdown-active":t}),m=[];for(let t=e,n=a.length;t<n;t++)a[t].disabled||m.push(this._renderItem(t,!0));return s.createElement("li",{className:p,key:"viewmore_"+o},s.createElement(u.E,{as:"button",color:"text.neutral.secondary.default",_hover:{color:"text.neutral.secondary.hovered"},className:"navbar-link",type:"button","data-testid":"more_button",onClick:this._onToggleDropDown},(0,l.AP)("Plus"),t?n||(n=s.createElement(d.o,{marginStart:"5px",marginTop:"3px"})):r||(r=s.createElement(c.e,{marginStart:"5px",marginTop:"3px"}))),s.createElement("ul",{className:"dropdown-menu is-right"},m))}_onToggleDropDown(e){if(e.stopPropagation(),void 0!==e.keyCode&&13!==e.keyCode)return;const t=!this.state.isOpenDropDown;this.setState({isOpenDropDown:t}),t&&document.addEventListener("click",this._onClickOutsideDropDown,{once:!0,capture:!0})}_onItemClick(e,t){void 0!==t.keyCode&&13!==t.keyCode||(e.action&&e.action(e),this.setState({isOpenDropDown:!1}),o.A.trigger(o.A.navigation.tab_displayed,{type:e.id}))}_onResize(){let e=1/0,t=0,a=0;const n=this._navbarLinks.offsetWidth,r=this._linksWidth.entries();for(const[s,i]of r){if(t+=i,t>n){e=a;break}a=s}this.state.lastVisibleElementIndex!==e&&this.setState({lastVisibleElementIndex:e})}_getTabWidth(){this._linksWidth=[],Array.from(this._navbarLinks.childNodes).forEach(((e,t)=>{this._linksWidth[t]=e.getBoundingClientRect().width})),this._onResize()}}p.defaultProps={align:"left",textSize:"large"};const m=p},y8BT:(e,t,a)=>{a.d(t,{A:()=>u});var n,r=a("q1tI"),s=a("TRpf"),i=a("GkjM"),l=a("Wp0Y"),o=a("WmA5"),c=a("HmE0");class d extends r.Component{constructor(e){super(e),this._onClick=this._onClick.bind(this)}render(){const{userID:e,userLang:t}=this.props,a=(0,l.AP)("Pour profiter du meilleur de Deezer, jetez un œil à nos <a %1$s>Univers</a> ou à <a %2$s>vos Coups de cœur</a>.",{sprintf:[`href="/${t}/channels/explore"`,`href="/${t}/profile/${e}/loved"`]});return r.createElement("div",{className:"naboo-not-found"},n||(n=r.createElement("div",{className:"title"},"404")),r.createElement("div",{className:"unavailable"},(0,l.AP)("Désolé, nous ne trouvons pas la page que vous recherchez")),r.createElement("div",{className:"description",dangerouslySetInnerHTML:{__html:a},onClick:this._onClick}),r.createElement(c.$n,{as:i.A,to:`/${this.props.userLang}/`},(0,l.AP)("Explorer")))}_onClick(e){const t=e.target;"a"===t.tagName.toLowerCase()&&(o.A.replace(t.getAttribute("href")),e.preventDefault())}}const u=(0,s.Ng)((({user:e})=>({userID:e.id,userLang:e.SETTING_LANG})))(d)}}]);